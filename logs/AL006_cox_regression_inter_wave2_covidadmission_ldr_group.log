-------------------------------------------------------------------------------
      name:  <unnamed>
       log:  /workspace/logs/AL006_cox_regression_inter_wave2_covidadmission_ld
> r_group.log
  log type:  text
 opened on:  25 Feb 2021, 20:15:19

. 
. 
. * Categories of various exposures
. local lo_ldr            = 0

. local hi_ldr            = 1

. local lo_ldr_cat        = 0

. local hi_ldr_cat        = 2

. local hi_ldr            = 1

. local lo_ldr_carecat= 0

. local hi_ldr_carecat= 2

. local lo_ds             = 0

. local hi_ds             = 1

. local lo_cp             = 0

. local hi_cp             = 1

. local lo_ldr_group      = 0

. local hi_ldr_group      = 5

. 
. * Open temporary file to post results
. tempfile ldrfile

. tempname ldrresults

. 
. postfile `ldrresults'   wave str15(outcome) str15(exposure) str20(model)     
>    ///
>                                                 expcat agebroad lnhr sehr usi
> ng `ldrfile'

. 
. 
.         * Open dataset (complete case ethnicity)
.         use "analysis/data_ldanalysis_cohort`i'.dta", clear 
(Analysis dataset, wave 2 (1 Sept 20 - latest), for learning disability work)

.         drop if ethnicity_5>=.
(11,245 observations deleted)

. 
.         * Only keep data for adults
.         keep if child==0
(6,499 observations deleted)

. 
.         
.         /*  Declare data to be survival  */
. 
.         stset stime_`out'`i', fail(`out'`i') scale(365.25)

     failure event:  covidadmission2 != 0 & covidadmission2 < .
obs. time interval:  (0, stime_covidadmission2]
 exit on or before:  failure
    t for analysis:  time/365.25

------------------------------------------------------------------------------
     27,126  total observations
      2,767  observations end on or before enter()
------------------------------------------------------------------------------
     24,359  observations remaining, representing
      2,360  failures in single-record/single-failure data
  9,788.172  total analysis time at risk and under observation
                                                at risk from t =         0
                                     earliest observed entry t =         0
                                          last observed exit t =  .4462697

. 
.         
.                 
.         /*  Fit Cox models  */
.         
.         * Confounder only model
.         stcox i.`exp'##i.agebroad age1 age2 age3 male i.ethnicity_5,    ///
>                 strata(stpcode) cluster(household_id) 

         failure _d:  covidadmission2
   analysis time _t:  stime_covidadmission2/365.25

Iteration 0:   log pseudolikelihood = -15518.831
Iteration 1:   log pseudolikelihood = -15500.001
Iteration 2:   log pseudolikelihood = -15499.597
Iteration 3:   log pseudolikelihood = -15499.595
Refining estimates:
Iteration 0:   log pseudolikelihood = -15499.595

Stratified Cox regr. -- Breslow method for ties

No. of subjects      =       24,359             Number of obs    =      24,359
No. of failures      =        2,360
Time at risk         =  9788.172485
                                                Wald chi2(25)    =       40.19
Log pseudolikelihood =   -15499.595             Prob > chi2      =      0.0279

                       (Std. Err. adjusted for 1,195 clusters in household_id)
------------------------------------------------------------------------------
             |               Robust
          _t | Haz. Ratio   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
   ldr_group |
DS but no..  |   1.060114   .0886854     0.70   0.485     .8997961    1.248996
 DS and LDR  |   .8315197   .0902475    -1.70   0.089     .6721852    1.028623
CP but no..  |   .9400769   .0721769    -0.80   0.421     .8087423    1.092739
 CP and LDR  |   1.013133   .0937552     0.14   0.888     .8450772    1.214609
LD with n..  |     1.0437   .0604598     0.74   0.460     .9316802    1.169188
             |
    agebroad |
     65-<75  |   .8383603   .1177218    -1.26   0.209     .6366574    1.103966
        75+  |   1.016543   .2213582     0.08   0.940     .6633938    1.557686
             |
   ldr_group#|
    agebroad |
DS but no.. #|
     65-<75  |   1.106431    .248905     0.45   0.653     .7119283     1.71954
DS but no.. #|
        75+  |     1.0035   .2322595     0.02   0.988     .6375398    1.579529
 DS and LDR #|
     65-<75  |   1.634225   .4372147     1.84   0.066     .9673516    2.760827
 DS and LDR #|
        75+  |   .9295241   .2818798    -0.24   0.810     .5130176    1.684182
CP but no.. #|
     65-<75  |   .9158338   .2049642    -0.39   0.694     .5906323    1.420091
CP but no.. #|
        75+  |   .6990868   .1752542    -1.43   0.153     .4277039    1.142665
 CP and LDR #|
     65-<75  |   .6659207   .2148584    -1.26   0.208      .353821    1.253319
 CP and LDR #|
        75+  |   1.433434    .324745     1.59   0.112     .9194699    2.234692
LD with n.. #|
     65-<75  |    .950253   .1605773    -0.30   0.763     .6823387    1.323361
LD with n.. #|
        75+  |   .8146146   .1457187    -1.15   0.252     .5737052    1.156686
             |
        age1 |   1.001046    .012943     0.08   0.936     .9759967    1.026738
        age2 |   .9978194   .0313538    -0.07   0.945     .9382211    1.061203
        age3 |   1.009765    .083284     0.12   0.906     .8590419    1.186933
        male |   1.076296   .0423262     1.87   0.062     .9964545    1.162535
             |
 ethnicity_5 |
      Mixed  |   1.042831   .0693903     0.63   0.529     .9153241    1.188101
Asian or ..  |   1.044073   .0717241     0.63   0.530     .9125493    1.194553
      Black  |   1.169043   .0774054     2.36   0.018     1.026763    1.331039
      Other  |    .983812    .067085    -0.24   0.811     .8607354    1.124487
------------------------------------------------------------------------------
                                                         Stratified by stpcode

.         forvalues k = `lo_`exp'' (1) `hi_`exp'' {
  2.                 capture qui di _b[`k'.`exp']
  3.                 if _rc==0 {
  4.                         post `ldrresults' (`i') ("`out'") ("`exp'")       
>       ///
>                                 ("Confounders")                              
>                            ///
>                                 (`k') (1) (_b[`k'.`exp']) (_se[`k'.`exp'])
  5.                 }
  6.                 forvalues l = 2 (1) 3 {
  7.                         capture qui di _b[`k'.`exp'#`l'.agebroad]
  8.                         if _rc==0 {
  9.                             lincom `k'.`exp' + `k'.`exp'#`l'.agebroad
 10.                                 post `ldrresults' (`i') ("`out'") ("`exp'"
> )             ///
>                                         ("Confounders")                      
>                                    ///
>                                         (`k') (`l') (r(estimate)) (r(se))
 11.                         }
 12.                 }
 13.         }

 ( 1)  0b.ldr_group + 0b.ldr_group#2o.agebroad = 0

------------------------------------------------------------------------------
          _t |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
         (1) |          0  (omitted)
------------------------------------------------------------------------------

 ( 1)  0b.ldr_group + 0b.ldr_group#3o.agebroad = 0

------------------------------------------------------------------------------
          _t |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
         (1) |          0  (omitted)
------------------------------------------------------------------------------

 ( 1)  1.ldr_group + 1.ldr_group#2.agebroad = 0

------------------------------------------------------------------------------
          _t |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
         (1) |    .159516   .2133969     0.75   0.455    -.2587342    .5777663
------------------------------------------------------------------------------

 ( 1)  1.ldr_group + 1.ldr_group#3.agebroad = 0

------------------------------------------------------------------------------
          _t |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
         (1) |   .0618705   .2109082     0.29   0.769    -.3515021     .475243
------------------------------------------------------------------------------

 ( 1)  2.ldr_group + 2.ldr_group#2.agebroad = 0

------------------------------------------------------------------------------
          _t |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
         (1) |   .3066682   .2408446     1.27   0.203    -.1653784    .7787149
------------------------------------------------------------------------------

 ( 1)  2.ldr_group + 2.ldr_group#3.agebroad = 0

------------------------------------------------------------------------------
          _t |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
         (1) |  -.2575829   .2935169    -0.88   0.380    -.8328655    .3176997
------------------------------------------------------------------------------

 ( 1)  3.ldr_group + 3.ldr_group#2.agebroad = 0

------------------------------------------------------------------------------
          _t |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
         (1) |  -.1497139   .2113979    -0.71   0.479    -.5640463    .2646184
------------------------------------------------------------------------------

 ( 1)  3.ldr_group + 3.ldr_group#3.agebroad = 0

------------------------------------------------------------------------------
          _t |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
         (1) |   -.419774    .237142    -1.77   0.077    -.8845638    .0450158
------------------------------------------------------------------------------

 ( 1)  4.ldr_group + 4.ldr_group#2.agebroad = 0

------------------------------------------------------------------------------
          _t |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
         (1) |  -.3935371   .3050115    -1.29   0.197    -.9913486    .2042743
------------------------------------------------------------------------------

 ( 1)  4.ldr_group + 4.ldr_group#3.agebroad = 0

------------------------------------------------------------------------------
          _t |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
         (1) |   .3731203   .2010383     1.86   0.063    -.0209077    .7671482
------------------------------------------------------------------------------

 ( 1)  5.ldr_group + 5.ldr_group#2.agebroad = 0

------------------------------------------------------------------------------
          _t |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
         (1) |  -.0082552   .1573979    -0.05   0.958    -.3167493     .300239
------------------------------------------------------------------------------

 ( 1)  5.ldr_group + 5.ldr_group#3.agebroad = 0

------------------------------------------------------------------------------
          _t |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
         (1) |  -.1622684   .1691805    -0.96   0.337    -.4938561    .1693194
------------------------------------------------------------------------------

.         
.         * Confounders with deprivation
.         stcox i.`exp'##i.agebroad age1 age2 age3 male i.ethnicity_5 imd, ///
>                 strata(stpcode) cluster(household_id) 

         failure _d:  covidadmission2
   analysis time _t:  stime_covidadmission2/365.25

Iteration 0:   log pseudolikelihood = -15518.831
Iteration 1:   log pseudolikelihood = -15499.995
Iteration 2:   log pseudolikelihood = -15499.591
Iteration 3:   log pseudolikelihood =  -15499.59
Refining estimates:
Iteration 0:   log pseudolikelihood =  -15499.59

Stratified Cox regr. -- Breslow method for ties

No. of subjects      =       24,359             Number of obs    =      24,359
No. of failures      =        2,360
Time at risk         =  9788.172485
                                                Wald chi2(26)    =       40.19
Log pseudolikelihood =    -15499.59             Prob > chi2      =      0.0374

                       (Std. Err. adjusted for 1,195 clusters in household_id)
------------------------------------------------------------------------------
             |               Robust
          _t | Haz. Ratio   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
   ldr_group |
DS but no..  |   1.060122   .0886835     0.70   0.485     .8998067    1.248999
 DS and LDR  |   .8315483   .0902392    -1.70   0.089     .6722264    1.028631
CP but no..  |   .9400065   .0722037    -0.81   0.421     .8086273    1.092731
 CP and LDR  |   1.013144    .093758     0.14   0.888     .8450837    1.214627
LD with n..  |    1.04368   .0604551     0.74   0.460     .9316686    1.169157
             |
    agebroad |
     65-<75  |   .8382981    .117699    -1.26   0.209      .636631    1.103848
        75+  |   1.016696   .2213447     0.08   0.939     .6635535    1.557779
             |
   ldr_group#|
    agebroad |
DS but no.. #|
     65-<75  |   1.106643   .2488824     0.45   0.652     .7121533    1.719656
DS but no.. #|
        75+  |   1.003603   .2322881     0.02   0.988      .637599    1.579705
 DS and LDR #|
     65-<75  |   1.633868   .4373131     1.83   0.067     .9669153    2.760866
 DS and LDR #|
        75+  |   .9295624   .2819467    -0.24   0.810      .512979    1.684448
CP but no.. #|
     65-<75  |    .915894   .2049735    -0.39   0.695     .5906763    1.420172
CP but no.. #|
        75+  |   .6992049   .1753254    -1.43   0.154     .4277263    1.142992
 CP and LDR #|
     65-<75  |   .6659432   .2148627    -1.26   0.208      .353836     1.25335
 CP and LDR #|
        75+  |   1.433157   .3247297     1.59   0.112     .9192333    2.234406
LD with n.. #|
     65-<75  |   .9501887   .1605532    -0.30   0.762     .6823112    1.323236
LD with n.. #|
        75+  |   .8144321   .1456466    -1.15   0.251     .5736312    1.156317
             |
        age1 |   1.001042   .0129424     0.08   0.936     .9759937    1.026733
        age2 |   .9978312   .0313521    -0.07   0.945      .938236    1.061212
        age3 |   1.009731   .0832758     0.12   0.907     .8590219    1.186881
        male |    1.07628    .042317     1.87   0.062     .9964553    1.162499
             |
 ethnicity_5 |
      Mixed  |   1.042844   .0693877     0.63   0.528     .9153407    1.188107
Asian or ..  |   1.044085   .0717274     0.63   0.530     .9125556    1.194572
      Black  |   1.168969   .0773522     2.36   0.018     1.026781    1.330847
      Other  |     .98374   .0670485    -0.24   0.810     .8607266    1.124334
             |
         imd |   .9982231   .0172602    -0.10   0.918     .9649606    1.032632
------------------------------------------------------------------------------
                                                         Stratified by stpcode

.         forvalues k = `lo_`exp'' (1) `hi_`exp'' {
  2.                 capture qui di _b[`k'.`exp']
  3.                 if _rc==0 {
  4.                         post `ldrresults' (`i') ("`out'") ("`exp'")     //
> /
>                                 ("Confounders+IMD")                          
>                    ///
>                                 (`k') (1) (_b[`k'.`exp']) (_se[`k'.`exp'])
  5.                 }       
  6.                 forvalues l = 2 (1) 3 {
  7.                         capture qui di _b[`k'.`exp'#`l'.agebroad]
  8.                         if _rc==0 {
  9.                             lincom `k'.`exp' + `k'.`exp'#`l'.agebroad
 10.                                 post `ldrresults' (`i') ("`out'") ("`exp'"
> )             ///
>                                         ("Confounders+IMD")                  
>                            ///
>                                         (`k') (`l') (r(estimate)) (r(se))
 11.                         }
 12.                 }
 13.         }

 ( 1)  0b.ldr_group + 0b.ldr_group#2o.agebroad = 0

------------------------------------------------------------------------------
          _t |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
         (1) |          0  (omitted)
------------------------------------------------------------------------------

 ( 1)  0b.ldr_group + 0b.ldr_group#3o.agebroad = 0

------------------------------------------------------------------------------
          _t |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
         (1) |          0  (omitted)
------------------------------------------------------------------------------

 ( 1)  1.ldr_group + 1.ldr_group#2.agebroad = 0

------------------------------------------------------------------------------
          _t |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
         (1) |   .1597147   .2133484     0.75   0.454    -.2584406    .5778699
------------------------------------------------------------------------------

 ( 1)  1.ldr_group + 1.ldr_group#3.agebroad = 0

------------------------------------------------------------------------------
          _t |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
         (1) |   .0619798   .2109251     0.29   0.769    -.3514258    .4753854
------------------------------------------------------------------------------

 ( 1)  2.ldr_group + 2.ldr_group#2.agebroad = 0

------------------------------------------------------------------------------
          _t |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
         (1) |   .3064842   .2409832     1.27   0.203    -.1658342    .7788026
------------------------------------------------------------------------------

 ( 1)  2.ldr_group + 2.ldr_group#3.agebroad = 0

------------------------------------------------------------------------------
          _t |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
         (1) |  -.2575072    .293629    -0.88   0.380    -.8330094     .317995
------------------------------------------------------------------------------

 ( 1)  3.ldr_group + 3.ldr_group#2.agebroad = 0

------------------------------------------------------------------------------
          _t |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
         (1) |  -.1497231   .2114038    -0.71   0.479    -.5640669    .2646206
------------------------------------------------------------------------------

 ( 1)  3.ldr_group + 3.ldr_group#3.agebroad = 0

------------------------------------------------------------------------------
          _t |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
         (1) |  -.4196799   .2371667    -1.77   0.077    -.8845181    .0451583
------------------------------------------------------------------------------

 ( 1)  4.ldr_group + 4.ldr_group#2.agebroad = 0

------------------------------------------------------------------------------
          _t |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
         (1) |  -.3934923   .3050213    -1.29   0.197    -.9913231    .2043385
------------------------------------------------------------------------------

 ( 1)  4.ldr_group + 4.ldr_group#3.agebroad = 0

------------------------------------------------------------------------------
          _t |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
         (1) |   .3729386   .2010365     1.86   0.064    -.0210858     .766963
------------------------------------------------------------------------------

 ( 1)  5.ldr_group + 5.ldr_group#2.agebroad = 0

------------------------------------------------------------------------------
          _t |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
         (1) |  -.0083421   .1573754    -0.05   0.958    -.3167922     .300108
------------------------------------------------------------------------------

 ( 1)  5.ldr_group + 5.ldr_group#3.agebroad = 0

------------------------------------------------------------------------------
          _t |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
         (1) |  -.1625116   .1691013    -0.96   0.337     -.493944    .1689209
------------------------------------------------------------------------------

.         
.         * Confounders with residential care
.         stcox i.`exp'##i.agebroad age1 age2 age3 male   ///
>                                 i.ethnicity_5 resid_care_ldr,           ///
>                 strata(stpcode) cluster(household_id) 

         failure _d:  covidadmission2
   analysis time _t:  stime_covidadmission2/365.25

Iteration 0:   log pseudolikelihood = -15518.831
Iteration 1:   log pseudolikelihood = -15499.532
Iteration 2:   log pseudolikelihood = -15499.126
Iteration 3:   log pseudolikelihood = -15499.125
Refining estimates:
Iteration 0:   log pseudolikelihood = -15499.125

Stratified Cox regr. -- Breslow method for ties

No. of subjects      =       24,359             Number of obs    =      24,359
No. of failures      =        2,360
Time at risk         =  9788.172485
                                                Wald chi2(26)    =       41.05
Log pseudolikelihood =   -15499.125             Prob > chi2      =      0.0306

                       (Std. Err. adjusted for 1,195 clusters in household_id)
------------------------------------------------------------------------------
             |               Robust
          _t | Haz. Ratio   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
   ldr_group |
DS but no..  |   1.059261   .0886703     0.69   0.492     .8989781    1.248121
 DS and LDR  |   .8303253    .090155    -1.71   0.087     .6711607    1.027235
CP but no..  |    .940118   .0721687    -0.80   0.421     .8087967    1.092761
 CP and LDR  |   1.012617   .0937051     0.14   0.892     .8446505    1.213985
LD with n..  |   1.041764   .0603752     0.71   0.480     .9299036    1.167079
             |
    agebroad |
     65-<75  |   .8376439   .1175957    -1.26   0.207     .6361513    1.102957
        75+  |   1.012668   .2205316     0.06   0.954     .6608432      1.5518
             |
   ldr_group#|
    agebroad |
DS but no.. #|
     65-<75  |   1.106103   .2488425     0.45   0.654     .7117029    1.719065
DS but no.. #|
        75+  |   1.005125   .2326414     0.02   0.982     .6385647    1.582104
 DS and LDR #|
     65-<75  |   1.632479   .4368337     1.83   0.067     .9662181    2.758163
 DS and LDR #|
        75+  |   .9313532   .2824738    -0.23   0.815     .5139846    1.687636
CP but no.. #|
     65-<75  |   .9159385    .204997    -0.39   0.695     .5906881    1.420282
CP but no.. #|
        75+  |   .6996592   .1753758    -1.42   0.154     .4280804    1.143531
 CP and LDR #|
     65-<75  |   .6643428   .2144075    -1.27   0.205      .352922    1.250564
 CP and LDR #|
        75+  |   1.434564   .3249503     1.59   0.111     .9202585    2.236298
LD with n.. #|
     65-<75  |   .9499099   .1605343    -0.30   0.761     .6820712    1.322925
LD with n.. #|
        75+  |   .8171016   .1461798    -1.13   0.259     .5754344    1.160263
             |
        age1 |    1.00118   .0129477     0.09   0.927      .976122    1.026882
        age2 |   .9974543   .0313508    -0.08   0.935     .9378622    1.060833
        age3 |   1.010827   .0833934     0.13   0.896     .8599088    1.188231
        male |   1.075954   .0423181     1.86   0.063      .996128    1.162176
             |
 ethnicity_5 |
      Mixed  |   1.043028   .0693895     0.63   0.527     .9155208    1.188294
Asian or ..  |   1.044225   .0717384     0.63   0.529      .912676    1.194736
      Black  |   1.169169   .0774126     2.36   0.018     1.026876     1.33118
      Other  |   .9842843   .0671022    -0.23   0.816     .8611744    1.124994
             |
resid_care~r |   1.108243   .1212684     0.94   0.348     .8943206    1.373336
------------------------------------------------------------------------------
                                                         Stratified by stpcode

.         forvalues k = `lo_`exp'' (1) `hi_`exp'' {
  2.                 capture qui di _b[`k'.`exp']
  3.                 if _rc==0 {
  4.                         post `ldrresults' (`i') ("`out'") ("`exp'")     //
> /
>                                 ("Confounders+Resid")                        
>                    ///
>                                 (`k') (1) (_b[`k'.`exp']) (_se[`k'.`exp'])
  5.                 }               
  6.                 forvalues l = 2 (1) 3 {
  7.                         capture qui di _b[`k'.`exp'#`l'.agebroad]
  8.                         if _rc==0 {
  9.                             lincom `k'.`exp' + `k'.`exp'#`l'.agebroad
 10.                                 post `ldrresults' (`i') ("`out'") ("`exp'"
> )             ///
>                                         ("Confounders+Resid")                
>                            ///
>                                         (`k') (`l') (r(estimate)) (r(se))
 11.                         }
 12.                 }
 13.         }

 ( 1)  0b.ldr_group + 0b.ldr_group#2o.agebroad = 0

------------------------------------------------------------------------------
          _t |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
         (1) |          0  (omitted)
------------------------------------------------------------------------------

 ( 1)  0b.ldr_group + 0b.ldr_group#3o.agebroad = 0

------------------------------------------------------------------------------
          _t |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
         (1) |          0  (omitted)
------------------------------------------------------------------------------

 ( 1)  1.ldr_group + 1.ldr_group#2.agebroad = 0

------------------------------------------------------------------------------
          _t |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
         (1) |   .1584141   .2133979     0.74   0.458    -.2598382    .5766663
------------------------------------------------------------------------------

 ( 1)  1.ldr_group + 1.ldr_group#3.agebroad = 0

------------------------------------------------------------------------------
          _t |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
         (1) |   .0626828   .2108794     0.30   0.766    -.3506332    .4759988
------------------------------------------------------------------------------

 ( 1)  2.ldr_group + 2.ldr_group#2.agebroad = 0

------------------------------------------------------------------------------
          _t |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
         (1) |   .3041619   .2409236     1.26   0.207    -.1680397    .7763634
------------------------------------------------------------------------------

 ( 1)  2.ldr_group + 2.ldr_group#3.agebroad = 0

------------------------------------------------------------------------------
          _t |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
         (1) |  -.2570545   .2934984    -0.88   0.381    -.8323008    .3181919
------------------------------------------------------------------------------

 ( 1)  3.ldr_group + 3.ldr_group#2.agebroad = 0

------------------------------------------------------------------------------
          _t |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
         (1) |  -.1495559   .2114107    -0.71   0.479    -.5639133    .2648015
------------------------------------------------------------------------------

 ( 1)  3.ldr_group + 3.ldr_group#3.agebroad = 0

------------------------------------------------------------------------------
          _t |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
         (1) |  -.4189118    .237118    -1.77   0.077    -.8836544    .0458309
------------------------------------------------------------------------------

 ( 1)  4.ldr_group + 4.ldr_group#2.agebroad = 0

------------------------------------------------------------------------------
          _t |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
         (1) |   -.396419   .3051154    -1.30   0.194    -.9944342    .2015961
------------------------------------------------------------------------------

 ( 1)  4.ldr_group + 4.ldr_group#3.agebroad = 0

------------------------------------------------------------------------------
          _t |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
         (1) |   .3733986    .200995     1.86   0.063    -.0205443    .7673415
------------------------------------------------------------------------------

 ( 1)  5.ldr_group + 5.ldr_group#2.agebroad = 0

------------------------------------------------------------------------------
          _t |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
         (1) |  -.0104731   .1574978    -0.07   0.947    -.3191631    .2982168
------------------------------------------------------------------------------

 ( 1)  5.ldr_group + 5.ldr_group#3.agebroad = 0

------------------------------------------------------------------------------
          _t |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
         (1) |  -.1610768   .1691786    -0.95   0.341    -.4926608    .1705072
------------------------------------------------------------------------------

.         
.         * Confounders with physical comorbidities that are indicators for vac
> cination 
.         stcox i.`exp'##i.agebroad age1 age2 age3 male           ///
>                                 i.ethnicity_5                                
>                    ///
>                                 obese40                                      
>                            ///
>                                 respiratory asthma_severe                    
>            ///
>                                 cardiac af dvt_pe i.diabcat                  
>            ///
>                                 liver stroke tia dementia                    
>            ///
>                                 i.kidneyfn                                   
>                            ///
>                                 spleen transplant dialysis                   
>            ///
>                                 immunosuppression cancerHaem                 
>    ///
>                                 autoimmune ibd cancerExhaem1yr,              
>    ///
>                 strata(stpcode) cluster(household_id) 

         failure _d:  covidadmission2
   analysis time _t:  stime_covidadmission2/365.25

Iteration 0:   log pseudolikelihood =  -2445.012
Iteration 1:   log pseudolikelihood = -2423.8695
Iteration 2:   log pseudolikelihood = -2421.6251
Iteration 3:   log pseudolikelihood = -2421.1824
Iteration 4:   log pseudolikelihood = -2421.0284
Iteration 5:   log pseudolikelihood = -2420.9718
Iteration 6:   log pseudolikelihood =  -2420.951
Iteration 7:   log pseudolikelihood = -2420.9433
Iteration 8:   log pseudolikelihood = -2420.9405
Iteration 9:   log pseudolikelihood = -2420.9395
Iteration 10:  log pseudolikelihood = -2420.9391
Iteration 11:  log pseudolikelihood =  -2420.939
Iteration 12:  log pseudolikelihood = -2420.9389
Iteration 13:  log pseudolikelihood = -2420.9389
Iteration 14:  log pseudolikelihood = -2420.9389
Iteration 15:  log pseudolikelihood = -2420.9389
Iteration 16:  log pseudolikelihood = -2420.9389
Iteration 17:  log pseudolikelihood = -2420.9389
Iteration 18:  log pseudolikelihood = -2420.9389
Iteration 19:  log pseudolikelihood = -2420.9389
Iteration 20:  log pseudolikelihood = -2420.9389
Iteration 21:  log pseudolikelihood = -2420.9389
Iteration 22:  log pseudolikelihood = -2420.9389
Iteration 23:  log pseudolikelihood = -2420.9389
Iteration 24:  log pseudolikelihood = -2420.9389
Iteration 25:  log pseudolikelihood = -2420.9389
Iteration 26:  log pseudolikelihood = -2420.9389
Iteration 27:  log pseudolikelihood = -2420.9389
Iteration 28:  log pseudolikelihood = -2420.9389
Iteration 29:  log pseudolikelihood = -2420.9389
Iteration 30:  log pseudolikelihood = -2420.9389
Iteration 31:  log pseudolikelihood = -2420.9389
Iteration 32:  log pseudolikelihood = -2420.9389
Iteration 33:  log pseudolikelihood = -2420.9389
Iteration 34:  log pseudolikelihood = -2420.9389
Iteration 35:  log pseudolikelihood = -2420.9389
Iteration 36:  log pseudolikelihood = -2420.9389
Iteration 37:  log pseudolikelihood = -2420.9389
Refining estimates:
Iteration 0:   log pseudolikelihood = -2420.9389
Iteration 1:   log pseudolikelihood = -2420.9389
Iteration 2:   log pseudolikelihood = -2420.9389
Iteration 3:   log pseudolikelihood = -2420.9389
Iteration 4:   log pseudolikelihood = -2420.9389
Iteration 5:   log pseudolikelihood = -2420.9389
Iteration 6:   log pseudolikelihood = -2420.9389
Iteration 7:   log pseudolikelihood = -2420.9389
Iteration 8:   log pseudolikelihood = -2420.9389
Iteration 9:   log pseudolikelihood = -2420.9389

Stratified Cox regr. -- Breslow method for ties

No. of subjects      =        4,879             Number of obs    =       4,879
No. of failures      =          492
Time at risk         =  1962.721424
                                                Wald chi2(46)    =       42.60
Log pseudolikelihood =   -2420.9389             Prob > chi2      =      0.6155

                         (Std. Err. adjusted for 938 clusters in household_id)
------------------------------------------------------------------------------
             |               Robust
          _t | Haz. Ratio   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
   ldr_group |
DS but no..  |   1.040156   .1811667     0.23   0.821     .7393367    1.463371
 DS and LDR  |   .8524811   .2012868    -0.68   0.499      .536661    1.354158
CP but no..  |   .9015486   .1528821    -0.61   0.541     .6466134    1.256995
 CP and LDR  |   .9866077   .1922338    -0.07   0.945     .6734318    1.445424
LD with n..  |   .9265782   .1208226    -0.58   0.559     .7176098    1.196398
             |
    agebroad |
     65-<75  |   .8682377   .2688728    -0.46   0.648     .4731965    1.593073
        75+  |   .7290992   .3505799    -0.66   0.511     .2841156    1.871019
             |
   ldr_group#|
    agebroad |
DS but no.. #|
     65-<75  |   .5047237   .3280536    -1.05   0.293     .1411891     1.80429
DS but no.. #|
        75+  |   1.953795   .9073729     1.44   0.149     .7862625    4.855011
 DS and LDR #|
     65-<75  |    .822251   .5427606    -0.30   0.767     .2254934      2.9983
 DS and LDR #|
        75+  |   2.404311   1.330779     1.58   0.113     .8125553    7.114235
CP but no.. #|
     65-<75  |   1.156856   .4983517     0.34   0.735     .4972764    2.691292
CP but no.. #|
        75+  |   .5388737   .4116544    -0.81   0.418     .1205702    2.408429
 CP and LDR #|
     65-<75  |   .2942837   .3132311    -1.15   0.250     .0365393     2.37013
 CP and LDR #|
        75+  |   2.562782   1.159874     2.08   0.038     1.055532    6.222314
LD with n.. #|
     65-<75  |   1.019801    .362366     0.06   0.956     .5082276    2.046318
LD with n.. #|
        75+  |   1.549521   .5736606     1.18   0.237     .7500101    3.201309
             |
        age1 |   .9551314   .0263984    -1.66   0.097     .9047678    1.008298
        age2 |   1.110628   .0760756     1.53   0.126      .971098    1.270206
        age3 |   .7851788   .1433141    -1.32   0.185     .5490396     1.12288
        male |    .994072   .0909795    -0.06   0.948     .8308338    1.189382
             |
 ethnicity_5 |
      Mixed  |   1.093654   .1701396     0.58   0.565     .8062297    1.483547
Asian or ..  |    1.19758   .1828283     1.18   0.238     .8878838      1.6153
      Black  |   1.362341   .2020209     2.09   0.037     1.018736     1.82184
      Other  |   1.127997   .1685972     0.81   0.420     .8415542    1.511936
             |
     obese40 |    .978653    .110223    -0.19   0.848     .7848023    1.220386
 respiratory |   1.059354   .1242702     0.49   0.623     .8417606    1.333194
asthma_sev~e |   .8501231   .1311941    -1.05   0.293     .6282339    1.150383
     cardiac |   .9088837    .108247    -0.80   0.422     .7196664    1.147851
          af |   1.065192   .1182693     0.57   0.569     .8568764    1.324151
      dvt_pe |   1.148234    .125929     1.26   0.208     .9261416    1.423585
             |
     diabcat |
Controlle..  |   .9384364   .1262703    -0.47   0.637     .7208955    1.221623
Uncontrol..  |   1.399777   .3148522     1.50   0.135     .9007367    2.175303
Diabetes,..  |   1.80e-19          .        .       .            .           .
             |
       liver |   .9383024   .1127157    -0.53   0.596     .7414644    1.187395
      stroke |   .9408067    .112328    -0.51   0.609     .7445105    1.188858
         tia |   1.099415   .1266154     0.82   0.411     .8772674    1.377816
    dementia |    .955848   .1097095    -0.39   0.694     .7632913    1.196981
             |
    kidneyfn |
Stage 3a/..  |   1.01e-20          .        .       .            .           .
Stage 4/5..  |   .8023525   .1256737    -1.41   0.160     .5902557    1.090662
             |
      spleen |   .9289192   .0886402    -0.77   0.440     .7704665    1.119959
  transplant |   .9806371   .1167807    -0.16   0.870     .7765004     1.23844
    dialysis |   1.102581   .2004971     0.54   0.591     .7720139    1.574693
immunosupp~n |   1.012334   .0934285     0.13   0.894     .8448237    1.213057
  cancerHaem |   .9930603   .0393782    -0.18   0.861     .9188033    1.073319
  autoimmune |   1.105585   .1226296     0.90   0.365     .8895667    1.374061
         ibd |   1.054793   .1208444     0.47   0.641     .8426508    1.320343
cancerExha~r |   .8730161   .6476304    -0.18   0.855     .2039739    3.736543
------------------------------------------------------------------------------
                                                         Stratified by stpcode

.         forvalues k = `lo_`exp'' (1) `hi_`exp'' {
  2.                 capture qui di _b[`k'.`exp']
  3.                 if _rc==0 {
  4.                         post `ldrresults' (`i') ("`out'") ("`exp'") ///
>                         ("Confounders+Comorb")                               
>            ///
>                         (`k') (1) (_b[`k'.`exp']) (_se[`k'.`exp'])
  5.                 }
  6.                                 forvalues l = 2 (1) 3 {
  7.                         capture qui di _b[`k'.`exp'#`l'.agebroad]
  8.                         if _rc==0 {
  9.                             lincom `k'.`exp' + `k'.`exp'#`l'.agebroad
 10.                                 post `ldrresults' (`i') ("`out'") ("`exp'"
> )             ///
>                                         ("Confounders+Comorb")               
>                            ///
>                                         (`k') (`l') (r(estimate)) (r(se))
 11.                         }
 12.                 }
 13.         }

 ( 1)  0b.ldr_group + 0b.ldr_group#2o.agebroad = 0

------------------------------------------------------------------------------
          _t |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
         (1) |          0  (omitted)
------------------------------------------------------------------------------

 ( 1)  0b.ldr_group + 0b.ldr_group#3o.agebroad = 0

------------------------------------------------------------------------------
          _t |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
         (1) |          0  (omitted)
------------------------------------------------------------------------------

 ( 1)  1.ldr_group + 1.ldr_group#2.agebroad = 0

------------------------------------------------------------------------------
          _t |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
         (1) |  -.6443738   .6202983    -1.04   0.299    -1.860136    .5713885
------------------------------------------------------------------------------

 ( 1)  1.ldr_group + 1.ldr_group#3.agebroad = 0

------------------------------------------------------------------------------
          _t |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
         (1) |   .7091437   .4203987     1.69   0.092    -.1148227     1.53311
------------------------------------------------------------------------------

 ( 1)  2.ldr_group + 2.ldr_group#2.agebroad = 0

------------------------------------------------------------------------------
          _t |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
         (1) |  -.3553138   .6175865    -0.58   0.565    -1.565761    .8551335
------------------------------------------------------------------------------

 ( 1)  2.ldr_group + 2.ldr_group#3.agebroad = 0

------------------------------------------------------------------------------
          _t |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
         (1) |   .7176589   .4967099     1.44   0.149    -.2558746    1.691192
------------------------------------------------------------------------------

 ( 1)  3.ldr_group + 3.ldr_group#2.agebroad = 0

------------------------------------------------------------------------------
          _t |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
         (1) |   .0420648   .3927098     0.11   0.915    -.7276323    .8117618
------------------------------------------------------------------------------

 ( 1)  3.ldr_group + 3.ldr_group#3.agebroad = 0

------------------------------------------------------------------------------
          _t |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
         (1) |  -.7219155   .7465999    -0.97   0.334    -2.185224    .7413934
------------------------------------------------------------------------------

 ( 1)  4.ldr_group + 4.ldr_group#2.agebroad = 0

------------------------------------------------------------------------------
          _t |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
         (1) |  -1.236694   1.041504    -1.19   0.235    -3.278003    .8046159
------------------------------------------------------------------------------

 ( 1)  4.ldr_group + 4.ldr_group#3.agebroad = 0

------------------------------------------------------------------------------
          _t |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
         (1) |   .9276104   .4027583     2.30   0.021     .1382187    1.717002
------------------------------------------------------------------------------

 ( 1)  5.ldr_group + 5.ldr_group#2.agebroad = 0

------------------------------------------------------------------------------
          _t |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
         (1) |  -.0566488   .3291183    -0.17   0.863    -.7017089    .5884112
------------------------------------------------------------------------------

 ( 1)  5.ldr_group + 5.ldr_group#3.agebroad = 0

------------------------------------------------------------------------------
          _t |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
         (1) |   .3616888   .3457402     1.05   0.296    -.3159496    1.039327
------------------------------------------------------------------------------

.         
.         * All variables
.         stcox i.`exp'##i.agebroad age1 age2 age3 male           ///
>                                 i.ethnicity_5 imd resid_care_ldr             
>    ///
>                                 obese40                                      
>                            ///
>                                 respiratory asthma_severe                    
>            ///
>                                 cardiac af dvt_pe i.diabcat                  
>            ///
>                                 liver stroke tia dementia                    
>            ///
>                                 i.kidneyfn                                   
>                            ///
>                                 spleen transplant dialysis                   
>            ///
>                                 immunosuppression cancerHaem                 
>    ///
>                                 autoimmune ibd cancerExhaem1yr,              
>    ///
>                                 strata(stpcode) cluster(household_id) 

         failure _d:  covidadmission2
   analysis time _t:  stime_covidadmission2/365.25

Iteration 0:   log pseudolikelihood =  -2445.012
Iteration 1:   log pseudolikelihood = -2423.4728
Iteration 2:   log pseudolikelihood = -2421.2145
Iteration 3:   log pseudolikelihood = -2420.7721
Iteration 4:   log pseudolikelihood = -2420.6184
Iteration 5:   log pseudolikelihood =  -2420.562
Iteration 6:   log pseudolikelihood = -2420.5412
Iteration 7:   log pseudolikelihood = -2420.5335
Iteration 8:   log pseudolikelihood = -2420.5307
Iteration 9:   log pseudolikelihood = -2420.5297
Iteration 10:  log pseudolikelihood = -2420.5293
Iteration 11:  log pseudolikelihood = -2420.5292
Iteration 12:  log pseudolikelihood = -2420.5291
Iteration 13:  log pseudolikelihood = -2420.5291
Iteration 14:  log pseudolikelihood = -2420.5291
Iteration 15:  log pseudolikelihood = -2420.5291
Iteration 16:  log pseudolikelihood = -2420.5291
Iteration 17:  log pseudolikelihood = -2420.5291
Iteration 18:  log pseudolikelihood = -2420.5291
Iteration 19:  log pseudolikelihood = -2420.5291
Iteration 20:  log pseudolikelihood = -2420.5291
Iteration 21:  log pseudolikelihood = -2420.5291
Iteration 22:  log pseudolikelihood = -2420.5291
Iteration 23:  log pseudolikelihood = -2420.5291
Iteration 24:  log pseudolikelihood = -2420.5291
Iteration 25:  log pseudolikelihood = -2420.5291
Iteration 26:  log pseudolikelihood = -2420.5291
Iteration 27:  log pseudolikelihood = -2420.5291
Iteration 28:  log pseudolikelihood = -2420.5291
Iteration 29:  log pseudolikelihood = -2420.5291
Iteration 30:  log pseudolikelihood = -2420.5291
Refining estimates:
Iteration 0:   log pseudolikelihood = -2420.5291
Iteration 1:   log pseudolikelihood = -2420.5291
Iteration 2:   log pseudolikelihood = -2420.5291

Stratified Cox regr. -- Breslow method for ties

No. of subjects      =        4,879             Number of obs    =       4,879
No. of failures      =          492
Time at risk         =  1962.721424
                                                Wald chi2(50)    =    34492.35
Log pseudolikelihood =   -2420.5291             Prob > chi2      =      0.0000

                         (Std. Err. adjusted for 938 clusters in household_id)
------------------------------------------------------------------------------
             |               Robust
          _t | Haz. Ratio   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
   ldr_group |
DS but no..  |    1.03932    .181022     0.22   0.825     .7387417    1.462198
 DS and LDR  |   .8550194   .2018442    -0.66   0.507     .5383107     1.35806
CP but no..  |   .9054037   .1535353    -0.59   0.558     .6493793    1.262368
 CP and LDR  |   .9904587   .1933666    -0.05   0.961      .675549    1.452165
LD with n..  |   .9242579   .1207643    -0.60   0.547     .7154421    1.194021
             |
    agebroad |
     65-<75  |   .8681376   .2688106    -0.46   0.648     .4731753    1.592777
        75+  |   .7233155   .3481736    -0.67   0.501     .2815758    1.858062
             |
   ldr_group#|
    agebroad |
DS but no.. #|
     65-<75  |   .5028943   .3271499    -1.06   0.291     .1405209    1.799751
DS but no.. #|
        75+  |   1.970082   .9167642     1.46   0.145     .7913774    4.904392
 DS and LDR #|
     65-<75  |   .8150465   .5384119    -0.31   0.757      .223299    2.974938
 DS and LDR #|
        75+  |   2.389034   1.322841     1.57   0.116       .80705    7.072034
CP but no.. #|
     65-<75  |   1.154731   .4970667     0.33   0.738     .4966742    2.684664
CP but no.. #|
        75+  |   .5454998   .4171709    -0.79   0.428     .1218536    2.442029
 CP and LDR #|
     65-<75  |    .289848   .3088037    -1.16   0.245     .0359171    2.339049
 CP and LDR #|
        75+  |   2.567298    1.16208     2.08   0.037     1.057261     6.23405
LD with n.. #|
     65-<75  |   1.018884   .3621683     0.05   0.958     .5076454    2.044981
LD with n.. #|
        75+  |   1.545374   .5727061     1.17   0.240     .7474528    3.195094
             |
        age1 |   .9552768   .0264273    -1.65   0.098     .9048595    1.008503
        age2 |    1.10989     .07612     1.52   0.128     .9702897    1.269574
        age3 |   .7869981   .1438788    -1.31   0.190     .5499932    1.126134
        male |   .9928579   .0909281    -0.08   0.938     .8297212     1.18807
             |
 ethnicity_5 |
      Mixed  |   1.090975    .169814     0.56   0.576     .8041227    1.480155
Asian or ..  |   1.195651   .1824131     1.17   0.241     .8866285    1.612378
      Black  |   1.360442   .2014779     2.08   0.038     1.017699    1.818615
      Other  |   1.127647   .1686661     0.80   0.422      .841116    1.511786
             |
         imd |   .9812826    .039747    -0.47   0.641     .9063919    1.062361
resid_care~r |   1.195678   .3251683     0.66   0.511     .7016611    2.037516
     obese40 |   .9818818   .1105255    -0.16   0.871     .7874876    1.224263
 respiratory |   1.060531    .124455     0.50   0.617     .8426234    1.334791
asthma_sev~e |   .8516322   .1315185    -1.04   0.298     .6292164    1.152668
     cardiac |   .9108748   .1087126    -0.78   0.434     .7208885    1.150931
          af |   1.064432   .1180089     0.56   0.573     .8565425    1.322778
      dvt_pe |   1.148389   .1259715     1.26   0.207     .9262265    1.423838
             |
     diabcat |
Controlle..  |   .9380278   .1262294    -0.48   0.634     .7205605    1.221127
Uncontrol..  |   1.395945   .3143213     1.48   0.138     .8978538    2.170357
Diabetes,..  |   1.08e-14   7.01e-15   -49.57   0.000     3.03e-15    3.86e-14
             |
       liver |   .9379952   .1127793    -0.53   0.594     .7410661    1.187256
      stroke |   .9394246   .1119134    -0.52   0.600     .7438041    1.186493
         tia |   1.097159   .1263168     0.81   0.421     .8755275    1.374893
    dementia |   .9571742   .1097959    -0.38   0.703     .7644535     1.19848
             |
    kidneyfn |
Stage 3a/..  |   1.21e-14   2.84e-15  -137.05   0.000     7.68e-15    1.92e-14
Stage 4/5..  |    .804139   .1259782    -1.39   0.164     .5915345    1.093156
             |
      spleen |    .928251   .0886079    -0.78   0.435     .7698612    1.119228
  transplant |   .9824252   .1171262    -0.15   0.882     .7777105    1.241026
    dialysis |   1.099441   .2001093     0.52   0.602     .7695642    1.570722
immunosupp~n |   1.012855   .0935829     0.14   0.890     .8450852    1.213932
  cancerHaem |   .9930367   .0392966    -0.18   0.860     .9189278    1.073122
  autoimmune |   1.108107   .1230135     0.92   0.355     .8914311    1.377449
         ibd |    1.05404   .1207663     0.46   0.646     .8420363     1.31942
cancerExha~r |   .8605293   .6383233    -0.20   0.840     .2010766    3.682729
------------------------------------------------------------------------------
                                                         Stratified by stpcode

.         forvalues k = `lo_`exp'' (1) `hi_`exp'' {
  2.                 capture qui di _b[`k'.`exp']
  3.                 if _rc==0 {
  4.                         post `ldrresults' (`i') ("`out'") ("`exp'")     //
> /
>                         ("All")                                              
>                                    ///
>                         (`k') (1) (_b[`k'.`exp']) (_se[`k'.`exp'])
  5.                 }
  6.                                 forvalues l = 2 (1) 3 {
  7.                         capture qui di _b[`k'.`exp'#`l'.agebroad]
  8.                         if _rc==0 {
  9.                             lincom `k'.`exp' + `k'.`exp'#`l'.agebroad
 10.                                 post `ldrresults' (`i') ("`out'") ("`exp'"
> )     ///
>                                         ("All")                              
>                                    ///
>                                         (`k') (`l') (r(estimate)) (r(se))
 11.                         }
 12.                 }
 13.         }

 ( 1)  0b.ldr_group + 0b.ldr_group#2o.agebroad = 0

------------------------------------------------------------------------------
          _t |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
         (1) |          0  (omitted)
------------------------------------------------------------------------------

 ( 1)  0b.ldr_group + 0b.ldr_group#3o.agebroad = 0

------------------------------------------------------------------------------
          _t |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
         (1) |          0  (omitted)
------------------------------------------------------------------------------

 ( 1)  1.ldr_group + 1.ldr_group#2.agebroad = 0

------------------------------------------------------------------------------
          _t |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
         (1) |  -.6488086   .6208446    -1.05   0.296    -1.865642    .5680245
------------------------------------------------------------------------------

 ( 1)  1.ldr_group + 1.ldr_group#3.agebroad = 0

------------------------------------------------------------------------------
          _t |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
         (1) |   .7166422    .421017     1.70   0.089    -.1085361     1.54182
------------------------------------------------------------------------------

 ( 1)  2.ldr_group + 2.ldr_group#2.agebroad = 0

------------------------------------------------------------------------------
          _t |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
         (1) |  -.3611413   .6181994    -0.58   0.559     -1.57279    .8505072
------------------------------------------------------------------------------

 ( 1)  2.ldr_group + 2.ldr_group#3.agebroad = 0

------------------------------------------------------------------------------
          _t |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
         (1) |   .7142581   .4969873     1.44   0.151    -.2598192    1.688335
------------------------------------------------------------------------------

 ( 1)  3.ldr_group + 3.ldr_group#2.agebroad = 0

------------------------------------------------------------------------------
          _t |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
         (1) |   .0444929   .3925754     0.11   0.910    -.7249407    .8139266
------------------------------------------------------------------------------

 ( 1)  3.ldr_group + 3.ldr_group#3.agebroad = 0

------------------------------------------------------------------------------
          _t |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
         (1) |  -.7054271   .7472729    -0.94   0.345    -2.170055    .7592008
------------------------------------------------------------------------------

 ( 1)  4.ldr_group + 4.ldr_group#2.agebroad = 0

------------------------------------------------------------------------------
          _t |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
         (1) |  -1.247986   1.041946    -1.20   0.231    -3.290162    .7941903
------------------------------------------------------------------------------

 ( 1)  4.ldr_group + 4.ldr_group#3.agebroad = 0

------------------------------------------------------------------------------
          _t |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
         (1) |   .9332669   .4029582     2.32   0.021     .1434832    1.723051
------------------------------------------------------------------------------

 ( 1)  5.ldr_group + 5.ldr_group#2.agebroad = 0

------------------------------------------------------------------------------
          _t |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
         (1) |  -.0600559   .3292156    -0.18   0.855    -.7053066    .5851949
------------------------------------------------------------------------------

 ( 1)  5.ldr_group + 5.ldr_group#3.agebroad = 0

------------------------------------------------------------------------------
          _t |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
         (1) |   .3565021    .346095     1.03   0.303    -.3218315    1.034836
------------------------------------------------------------------------------

. 
. postclose `ldrresults'

. 
. use `ldrfile', clear

. 
. 
. *************************
. *  Tidy output for HRs  *
. *************************
. 
. * Outcome
. rename outcome out

. gen outcome     = 1 if out=="coviddeath"
(90 missing values generated)

. replace outcome = 2 if out=="covidadmission"
(90 real changes made)

. replace outcome = 3 if out=="composite"
(0 real changes made)

. 
. label define outcome    1 "COVID-19 death"              ///
>                                                 2 "COVID-19 admission"  ///
>                                                 3 "Composite"

. label values outcome outcome

. drop out

. 
. * Exposure
. rename exposure exp

. gen     exposure = 1 if exp=="ldr"
(90 missing values generated)

. replace exposure = 2 if exp=="ldr_cat"
(0 real changes made)

. replace exposure = 3 if exp=="ldr_carecat"
(0 real changes made)

. replace exposure = 4 if exp=="ds"
(0 real changes made)

. replace exposure = 5 if exp=="cp"
(0 real changes made)

. replace exposure = 6 if exp=="ldr_group"
(90 real changes made)

. 
. label define exposure   1 "Learning disability register"        ///
>                                                 2 "LDR Severe vs mild"       
>                    ///
>                                                 3 "LDR by residential care"  
>                    ///
>                                                 4 "Down's syndrome"          
>                            ///
>                                                 5 "Cerebral Palsy"           
>                            ///
>                                                 6 "Combined grouping"        
>                    

. label values exposure exposure                                          

. drop exp

. 
. * Age categories
. label define agebroad   1 "16-<65"              ///
>                                                 2 "65-<75"              ///
>                                                 3 "75+"

. label values agebroad agebroad

. 
. 
. * Categories of exposure
. gen category     = "No"                                         if expcat==0
(75 missing values generated)

. replace category = "Yes"                                        if inlist(exp
> osure, 1, 4, 5) & expcat==1
(0 real changes made)

. 
. replace category = "LDR, mild"                          if inlist(exposure, 2
> ) & expcat==1
(0 real changes made)

. replace category = "LDR, profound"                      if inlist(exposure, 2
> ) & expcat==2
(0 real changes made)

. 
. replace category = "LDR, community"             if inlist(exposure, 3) & expc
> at==1
(0 real changes made)

. replace category = "LDR, residential care"      if inlist(exposure, 3) & expc
> at==2
(0 real changes made)

. 
. replace category = "DS but not LDR"             if inlist(exposure, 6) & expc
> at==1
variable category was str2 now str14
(15 real changes made)

. replace category = "DS and LDR"                         if inlist(exposure, 6
> ) & expcat==2
(15 real changes made)

. replace category = "CP but not LDR"             if inlist(exposure, 6) & expc
> at==3
(15 real changes made)

. replace category = "CP and LDR"                         if inlist(exposure, 6
> ) & expcat==4
(15 real changes made)

. replace category = "LDR with no DS or CP"       if inlist(exposure, 6) & expc
> at==5
variable category was str14 now str20
(15 real changes made)

. 
. * Model adjustment
. gen     adjustment = 1 if model=="Confounders"
(72 missing values generated)

. replace adjustment = 2 if model=="Confounders+IMD"
(18 real changes made)

. replace adjustment = 3 if model=="Confounders+Resid"
(18 real changes made)

. replace adjustment = 4 if model=="Confounders+Comorb"
(18 real changes made)

. replace adjustment = 5 if model=="All"
(18 real changes made)

. label define adj        1 "Confounders"                                      
>    ///     
>                                         2 "Confounders with IMD"             
>            ///
>                                         3 "Confounders with care"            
>            ///
>                                         4 "Confounders with comorbidities"   
>    ///
>                                         5 "All"

. label values adjustment adj

. drop model

. 
. * Hazard ratio with 95% confidence interval
. gen cl = exp(lnhr - invnorm(0.975)*sehr)

. gen cu = exp(lnhr + invnorm(0.975)*sehr)

. gen hr = exp(lnhr)

. 
. gen hr_ci =   string(round(hr, 0.01)) + " (" ///
>                         + string(round(cl, 0.01)) + ", " ///
>                         + string(round(cu, 0.01)) + ")"

. replace hr_ci = "" if expcat==0
(15 real changes made)

. drop cl cu hr lnhr sehr

. 
. * Put in wide format
. reshape wide hr_ci, i(wave outcome exposure expcat agebroad) j(adjust)
(note: j = 1 2 3 4 5)

Data                               long   ->   wide
-----------------------------------------------------------------------------
Number of obs.                       90   ->      18
Number of variables                   8   ->      11
j variable (5 values)        adjustment   ->   (dropped)
xij variables:
                                  hr_ci   ->   hr_ci1 hr_ci2 ... hr_ci5
-----------------------------------------------------------------------------

. rename hr_ci1 hr_conf

. rename hr_ci2 hr_conf_imd

. rename hr_ci3 hr_conf_resid

. rename hr_ci4 hr_conf_comorb

. 
. 
. order wave outcome exposure agebroad category hr*

. sort wave outcome exposure agebroad expcat

. 
. * Save data
. outsheet using "output/ldcox_inter_wave`i'_`out'_`exp'", replace
(note: file output/ldcox_inter_wave2_covidadmission_ldr_group.out not found)

. 
. log close
      name:  <unnamed>
       log:  /workspace/logs/AL006_cox_regression_inter_wave2_covidadmission_ld
> r_group.log
  log type:  text
 closed on:  25 Feb 2021, 20:15:37
-------------------------------------------------------------------------------
