-------------------------------------------------------------------------------
      name:  <unnamed>
       log:  /workspace/logs/AL006_cox_regression_inter_wave1_coviddeath_ldr_ca
> recat.log
  log type:  text
 opened on:  25 Feb 2021, 20:19:09

. 
. 
. * Categories of various exposures
. local lo_ldr            = 0

. local hi_ldr            = 1

. local lo_ldr_cat        = 0

. local hi_ldr_cat        = 2

. local hi_ldr            = 1

. local lo_ldr_carecat= 0

. local hi_ldr_carecat= 2

. local lo_ds             = 0

. local hi_ds             = 1

. local lo_cp             = 0

. local hi_cp             = 1

. local lo_ldr_group      = 0

. local hi_ldr_group      = 5

. 
. * Open temporary file to post results
. tempfile ldrfile

. tempname ldrresults

. 
. postfile `ldrresults'   wave str15(outcome) str15(exposure) str20(model)     
>    ///
>                                                 expcat agebroad lnhr sehr usi
> ng `ldrfile'

. 
. 
.         * Open dataset (complete case ethnicity)
.         use "analysis/data_ldanalysis_cohort`i'.dta", clear 
(Analysis dataset, wave 1 (1 Mar - 31 Aug 20), for learning disability work)

.         drop if ethnicity_5>=.
(12,499 observations deleted)

. 
.         * Only keep data for adults
.         keep if child==0
(7,126 observations deleted)

. 
.         
.         /*  Declare data to be survival  */
. 
.         stset stime_`out'`i', fail(`out'`i') scale(365.25)

     failure event:  coviddeath1 != 0 & coviddeath1 < .
obs. time interval:  (0, stime_coviddeath1]
 exit on or before:  failure
    t for analysis:  time/365.25

------------------------------------------------------------------------------
     30,365  total observations
          0  exclusions
------------------------------------------------------------------------------
     30,365  observations remaining, representing
        648  failures in single-record/single-failure data
 14,525.018  total analysis time at risk and under observation
                                                at risk from t =         0
                                     earliest observed entry t =         0
                                          last observed exit t =  .5037645

. 
.         
.                 
.         /*  Fit Cox models  */
.         
.         * Confounder only model
.         stcox i.`exp'##i.agebroad age1 age2 age3 male i.ethnicity_5,    ///
>                 strata(stpcode) cluster(household_id) 

         failure _d:  coviddeath1
   analysis time _t:  stime_coviddeath1/365.25

Iteration 0:   log pseudolikelihood = -4435.1167
Iteration 1:   log pseudolikelihood = -4430.6812
Iteration 2:   log pseudolikelihood = -4428.5131
Iteration 3:   log pseudolikelihood = -4428.2141
Iteration 4:   log pseudolikelihood = -4428.1693
Iteration 5:   log pseudolikelihood = -4428.1542
Iteration 6:   log pseudolikelihood = -4428.1487
Iteration 7:   log pseudolikelihood = -4428.1466
Iteration 8:   log pseudolikelihood = -4428.1459
Iteration 9:   log pseudolikelihood = -4428.1456
Iteration 10:  log pseudolikelihood = -4428.1455
Iteration 11:  log pseudolikelihood = -4428.1454
Iteration 12:  log pseudolikelihood = -4428.1454
Iteration 13:  log pseudolikelihood = -4428.1454
Iteration 14:  log pseudolikelihood = -4428.1454
Iteration 15:  log pseudolikelihood = -4428.1454
Iteration 16:  log pseudolikelihood = -4428.1454
Iteration 17:  log pseudolikelihood = -4428.1454
Iteration 18:  log pseudolikelihood = -4428.1454
Iteration 19:  log pseudolikelihood = -4428.1454
Iteration 20:  log pseudolikelihood = -4428.1454
Iteration 21:  log pseudolikelihood = -4428.1454
Iteration 22:  log pseudolikelihood = -4428.1454
Iteration 23:  log pseudolikelihood = -4428.1454
Iteration 24:  log pseudolikelihood = -4428.1454
Iteration 25:  log pseudolikelihood = -4428.1454
Iteration 26:  log pseudolikelihood = -4428.1454
Iteration 27:  log pseudolikelihood = -4428.1454
Iteration 28:  log pseudolikelihood = -4428.1454
Iteration 29:  log pseudolikelihood = -4428.1454
Iteration 30:  log pseudolikelihood = -4428.1454
Iteration 31:  log pseudolikelihood = -4428.1454
Iteration 32:  log pseudolikelihood = -4428.1454
Iteration 33:  log pseudolikelihood = -4428.1454
Iteration 34:  log pseudolikelihood = -4428.1454
Iteration 35:  log pseudolikelihood = -4428.1454
Refining estimates:
Iteration 0:   log pseudolikelihood = -4428.1454
Iteration 1:   log pseudolikelihood = -4428.1454
Iteration 2:   log pseudolikelihood = -4428.1454
Iteration 3:   log pseudolikelihood = -4428.1454
Iteration 4:   log pseudolikelihood = -4428.1454
Iteration 5:   log pseudolikelihood = -4428.1454

Stratified Cox regr. -- Breslow method for ties

No. of subjects      =       30,365             Number of obs    =      30,365
No. of failures      =          648
Time at risk         =  14525.01848
                                                Wald chi2(16)    =    71931.35
Log pseudolikelihood =   -4428.1454             Prob > chi2      =      0.0000

                       (Std. Err. adjusted for 1,207 clusters in household_id)
------------------------------------------------------------------------------
             |               Robust
          _t | Haz. Ratio   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
 ldr_carecat |
LDR, not ..  |   .4253072   .2483101    -1.46   0.143     .1354378    1.335567
LDR, in r..  |    .933249   .0836513    -0.77   0.441     .7828896    1.112486
             |
    agebroad |
     65-<75  |   .9824547   .2177532    -0.08   0.936     .6362833    1.516961
        75+  |   .7759315   .3112537    -0.63   0.527     .3534893    1.703219
             |
 ldr_carecat#|
    agebroad |
LDR, not .. #|
     65-<75  |   9.23e-18   5.69e-18   -63.58   0.000     2.75e-18    3.09e-17
LDR, not .. #|
        75+  |   8.421996   7.062392     2.54   0.011     1.627898    43.57154
LDR, in r.. #|
     65-<75  |   .8595754   .2302749    -0.56   0.572     .5084548    1.453167
LDR, in r.. #|
        75+  |   1.162869   .3300233     0.53   0.595     .6667435    2.028161
             |
        age1 |   .9992404   .0241389    -0.03   0.975     .9530315     1.04769
        age2 |   1.006114   .0605738     0.10   0.919     .8941285    1.132125
        age3 |   .9853962   .1561964    -0.09   0.926     .7222471    1.344423
        male |   .9368293   .0714742    -0.86   0.392     .8067131    1.087932
             |
 ethnicity_5 |
      Mixed  |   1.190624   .1499483     1.39   0.166     .9301943    1.523968
Asian or ..  |   1.183845   .1475052     1.35   0.176     .9273346    1.511309
      Black  |    1.10549   .1432433     0.77   0.439     .8575525    1.425111
      Other  |   1.124922    .146245     0.91   0.365     .8718916    1.451385
------------------------------------------------------------------------------
                                                         Stratified by stpcode

.         forvalues k = `lo_`exp'' (1) `hi_`exp'' {
  2.                 capture qui di _b[`k'.`exp']
  3.                 if _rc==0 {
  4.                         post `ldrresults' (`i') ("`out'") ("`exp'")       
>       ///
>                                 ("Confounders")                              
>                            ///
>                                 (`k') (1) (_b[`k'.`exp']) (_se[`k'.`exp'])
  5.                 }
  6.                 forvalues l = 2 (1) 3 {
  7.                         capture qui di _b[`k'.`exp'#`l'.agebroad]
  8.                         if _rc==0 {
  9.                             lincom `k'.`exp' + `k'.`exp'#`l'.agebroad
 10.                                 post `ldrresults' (`i') ("`out'") ("`exp'"
> )             ///
>                                         ("Confounders")                      
>                                    ///
>                                         (`k') (`l') (r(estimate)) (r(se))
 11.                         }
 12.                 }
 13.         }

 ( 1)  0b.ldr_carecat + 0b.ldr_carecat#2o.agebroad = 0

------------------------------------------------------------------------------
          _t |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
         (1) |          0  (omitted)
------------------------------------------------------------------------------

 ( 1)  0b.ldr_carecat + 0b.ldr_carecat#3o.agebroad = 0

------------------------------------------------------------------------------
          _t |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
         (1) |          0  (omitted)
------------------------------------------------------------------------------

 ( 1)  1.ldr_carecat + 1.ldr_carecat#2.agebroad = 0

------------------------------------------------------------------------------
          _t |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
         (1) |  -40.07921   .2057059  -194.84   0.000    -40.48239   -39.67604
------------------------------------------------------------------------------

 ( 1)  1.ldr_carecat + 1.ldr_carecat#3.agebroad = 0

------------------------------------------------------------------------------
          _t |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
         (1) |   1.275903   .5955625     2.14   0.032     .1086223    2.443184
------------------------------------------------------------------------------

 ( 1)  2.ldr_carecat + 2.ldr_carecat#2.agebroad = 0

------------------------------------------------------------------------------
          _t |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
         (1) |  -.2203999   .2444149    -0.90   0.367    -.6994444    .2586445
------------------------------------------------------------------------------

 ( 1)  2.ldr_carecat + 2.ldr_carecat#3.agebroad = 0

------------------------------------------------------------------------------
          _t |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
         (1) |   .0818067   .2685676     0.30   0.761    -.4445763    .6081896
------------------------------------------------------------------------------

.         
.         * Confounders with deprivation
.         stcox i.`exp'##i.agebroad age1 age2 age3 male i.ethnicity_5 imd, ///
>                 strata(stpcode) cluster(household_id) 

         failure _d:  coviddeath1
   analysis time _t:  stime_coviddeath1/365.25

Iteration 0:   log pseudolikelihood = -4435.1167
Iteration 1:   log pseudolikelihood = -4429.9944
Iteration 2:   log pseudolikelihood = -4427.8268
Iteration 3:   log pseudolikelihood = -4427.5279
Iteration 4:   log pseudolikelihood = -4427.4831
Iteration 5:   log pseudolikelihood =  -4427.468
Iteration 6:   log pseudolikelihood = -4427.4624
Iteration 7:   log pseudolikelihood = -4427.4604
Iteration 8:   log pseudolikelihood = -4427.4596
Iteration 9:   log pseudolikelihood = -4427.4594
Iteration 10:  log pseudolikelihood = -4427.4593
Iteration 11:  log pseudolikelihood = -4427.4592
Iteration 12:  log pseudolikelihood = -4427.4592
Iteration 13:  log pseudolikelihood = -4427.4592
Iteration 14:  log pseudolikelihood = -4427.4592
Iteration 15:  log pseudolikelihood = -4427.4592
Iteration 16:  log pseudolikelihood = -4427.4592
Iteration 17:  log pseudolikelihood = -4427.4592
Iteration 18:  log pseudolikelihood = -4427.4592
Iteration 19:  log pseudolikelihood = -4427.4592
Iteration 20:  log pseudolikelihood = -4427.4592
Iteration 21:  log pseudolikelihood = -4427.4592
Iteration 22:  log pseudolikelihood = -4427.4592
Iteration 23:  log pseudolikelihood = -4427.4592
Iteration 24:  log pseudolikelihood = -4427.4592
Iteration 25:  log pseudolikelihood = -4427.4592
Iteration 26:  log pseudolikelihood = -4427.4592
Iteration 27:  log pseudolikelihood = -4427.4592
Iteration 28:  log pseudolikelihood = -4427.4592
Iteration 29:  log pseudolikelihood = -4427.4592
Refining estimates:
Iteration 0:   log pseudolikelihood = -4427.4592
Iteration 1:   log pseudolikelihood = -4427.4592
Iteration 2:   log pseudolikelihood = -4427.4592

Stratified Cox regr. -- Breslow method for ties

No. of subjects      =       30,365             Number of obs    =      30,365
No. of failures      =          648
Time at risk         =  14525.01848
                                                Wald chi2(17)    =    43188.15
Log pseudolikelihood =   -4427.4592             Prob > chi2      =      0.0000

                       (Std. Err. adjusted for 1,207 clusters in household_id)
------------------------------------------------------------------------------
             |               Robust
          _t | Haz. Ratio   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
 ldr_carecat |
LDR, not ..  |   .4235831   .2472774    -1.47   0.141      .134905    1.329992
LDR, in r..  |   .9326128   .0835931    -0.78   0.436     .7823578    1.111725
             |
    agebroad |
     65-<75  |   .9807686   .2174679    -0.09   0.930     .6350791    1.514625
        75+  |   .7749048   .3110673    -0.64   0.525     .3528203    1.701936
             |
 ldr_carecat#|
    agebroad |
LDR, not .. #|
     65-<75  |   7.56e-14   4.66e-14   -48.98   0.000     2.26e-14    2.53e-13
LDR, not .. #|
        75+  |   8.413041   7.055642     2.54   0.011     1.625879    43.53292
LDR, in r.. #|
     65-<75  |   .8624417   .2308435    -0.55   0.580     .5103814    1.457353
LDR, in r.. #|
        75+  |   1.164971   .3305806     0.54   0.591     .6679936    2.031694
             |
        age1 |   .9992065   .0241373    -0.03   0.974     .9530007    1.047652
        age2 |   1.006132   .0605787     0.10   0.919     .8941381    1.132154
        age3 |   .9855496   .1562737    -0.09   0.927     .7222835    1.344774
        male |   .9369068    .071482    -0.85   0.393     .8067767    1.088026
             |
 ethnicity_5 |
      Mixed  |   1.190155   .1499218     1.38   0.167     .9297779    1.523449
Asian or ..  |   1.182778   .1474427     1.35   0.178     .9263905    1.510123
      Black  |   1.105051   .1431579     0.77   0.441     .8572552    1.424473
      Other  |   1.125017   .1462769     0.91   0.365     .8719351    1.451556
             |
         imd |   .9679367    .027081    -1.16   0.244      .916288    1.022497
------------------------------------------------------------------------------
                                                         Stratified by stpcode

.         forvalues k = `lo_`exp'' (1) `hi_`exp'' {
  2.                 capture qui di _b[`k'.`exp']
  3.                 if _rc==0 {
  4.                         post `ldrresults' (`i') ("`out'") ("`exp'")     //
> /
>                                 ("Confounders+IMD")                          
>                    ///
>                                 (`k') (1) (_b[`k'.`exp']) (_se[`k'.`exp'])
  5.                 }       
  6.                 forvalues l = 2 (1) 3 {
  7.                         capture qui di _b[`k'.`exp'#`l'.agebroad]
  8.                         if _rc==0 {
  9.                             lincom `k'.`exp' + `k'.`exp'#`l'.agebroad
 10.                                 post `ldrresults' (`i') ("`out'") ("`exp'"
> )             ///
>                                         ("Confounders+IMD")                  
>                            ///
>                                         (`k') (`l') (r(estimate)) (r(se))
 11.                         }
 12.                 }
 13.         }

 ( 1)  0b.ldr_carecat + 0b.ldr_carecat#2o.agebroad = 0

------------------------------------------------------------------------------
          _t |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
         (1) |          0  (omitted)
------------------------------------------------------------------------------

 ( 1)  0b.ldr_carecat + 0b.ldr_carecat#3o.agebroad = 0

------------------------------------------------------------------------------
          _t |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
         (1) |          0  (omitted)
------------------------------------------------------------------------------

 ( 1)  1.ldr_carecat + 1.ldr_carecat#2.agebroad = 0

------------------------------------------------------------------------------
          _t |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
         (1) |  -31.07282   .2058189  -150.97   0.000    -31.47621   -30.66942
------------------------------------------------------------------------------

 ( 1)  1.ldr_carecat + 1.ldr_carecat#3.agebroad = 0

------------------------------------------------------------------------------
          _t |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
         (1) |   1.270777   .5954142     2.13   0.033     .1037869    2.437768
------------------------------------------------------------------------------

 ( 1)  2.ldr_carecat + 2.ldr_carecat#2.agebroad = 0

------------------------------------------------------------------------------
          _t |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
         (1) |  -.2177529   .2442226    -0.89   0.373    -.6964203    .2609146
------------------------------------------------------------------------------

 ( 1)  2.ldr_carecat + 2.ldr_carecat#3.agebroad = 0

------------------------------------------------------------------------------
          _t |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
         (1) |   .0829315   .2685285     0.31   0.757    -.4433746    .6092376
------------------------------------------------------------------------------

.         
.         * Confounders with residential care
.         stcox i.`exp'##i.agebroad age1 age2 age3 male   ///
>                                 i.ethnicity_5 resid_care_ldr,           ///
>                 strata(stpcode) cluster(household_id) 

         failure _d:  coviddeath1
   analysis time _t:  stime_coviddeath1/365.25

Iteration 0:   log pseudolikelihood = -4435.1167
Iteration 1:   log pseudolikelihood = -4430.6467
Iteration 2:   log pseudolikelihood = -4428.4787
Iteration 3:   log pseudolikelihood = -4428.1798
Iteration 4:   log pseudolikelihood =  -4428.135
Iteration 5:   log pseudolikelihood = -4428.1199
Iteration 6:   log pseudolikelihood = -4428.1143
Iteration 7:   log pseudolikelihood = -4428.1123
Iteration 8:   log pseudolikelihood = -4428.1115
Iteration 9:   log pseudolikelihood = -4428.1113
Iteration 10:  log pseudolikelihood = -4428.1112
Iteration 11:  log pseudolikelihood = -4428.1111
Iteration 12:  log pseudolikelihood = -4428.1111
Iteration 13:  log pseudolikelihood = -4428.1111
Iteration 14:  log pseudolikelihood = -4428.1111
Iteration 15:  log pseudolikelihood = -4428.1111
Iteration 16:  log pseudolikelihood = -4428.1111
Iteration 17:  log pseudolikelihood = -4428.1111
Iteration 18:  log pseudolikelihood = -4428.1111
Iteration 19:  log pseudolikelihood = -4428.1111
Iteration 20:  log pseudolikelihood = -4428.1111
Iteration 21:  log pseudolikelihood = -4428.1111
Iteration 22:  log pseudolikelihood = -4428.1111
Iteration 23:  log pseudolikelihood = -4428.1111
Iteration 24:  log pseudolikelihood = -4428.1111
Iteration 25:  log pseudolikelihood = -4428.1111
Iteration 26:  log pseudolikelihood = -4428.1111
Iteration 27:  log pseudolikelihood = -4428.1111
Iteration 28:  log pseudolikelihood = -4428.1111
Iteration 29:  log pseudolikelihood = -4428.1111
Refining estimates:
Iteration 0:   log pseudolikelihood = -4428.1111
Iteration 1:   log pseudolikelihood = -4428.1111
Iteration 2:   log pseudolikelihood = -4428.1111
Iteration 3:   log pseudolikelihood = -4428.1111

Stratified Cox regr. -- Breslow method for ties

No. of subjects      =       30,365             Number of obs    =      30,365
No. of failures      =          648
Time at risk         =  14525.01848
                                                Wald chi2(17)    =    46147.70
Log pseudolikelihood =   -4428.1111             Prob > chi2      =      0.0000

                       (Std. Err. adjusted for 1,207 clusters in household_id)
------------------------------------------------------------------------------
             |               Robust
          _t | Haz. Ratio   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
 ldr_carecat |
LDR, not ..  |   .4007782   .2509518    -1.46   0.144     .1174667    1.367393
LDR, in r..  |   .9358771   .0842833    -0.74   0.462     .7844426    1.116545
             |
    agebroad |
     65-<75  |   .9821059   .2176899    -0.08   0.935     .6360397    1.516465
        75+  |   .7757091   .3111795    -0.63   0.527     .3533746    1.702796
             |
 ldr_carecat#|
    agebroad |
LDR, not .. #|
     65-<75  |   2.75e-14   1.70e-14   -50.61   0.000     8.21e-15    9.22e-14
LDR, not .. #|
        75+  |   8.420945   7.061422     2.54   0.011     1.627728     43.5652
LDR, in r.. #|
     65-<75  |   .8597473   .2303472    -0.56   0.573     .5085261    1.453545
LDR, in r.. #|
        75+  |   1.162706   .3299756     0.53   0.595     .6666523    2.027873
             |
        age1 |   .9992583   .0241401    -0.03   0.975     .9530473     1.04771
        age2 |   1.006052   .0605749     0.10   0.920      .894065    1.132066
        age3 |   .9855848   .1562384    -0.09   0.927     .7223681    1.344713
        male |   .9366767   .0714456    -0.86   0.391     .8066104    1.087716
             |
 ethnicity_5 |
      Mixed  |   1.190441   .1499245     1.38   0.166     .9300522    1.523731
Asian or ..  |   1.183383   .1475183     1.35   0.177     .9268645    1.510896
      Black  |   1.105337   .1432313     0.77   0.440     .8574222    1.424934
      Other  |   1.124698   .1462321     0.90   0.366     .8716931    1.451137
             |
resid_care~r |   .9397075   .2150685    -0.27   0.786     .6000402    1.471652
------------------------------------------------------------------------------
                                                         Stratified by stpcode

.         forvalues k = `lo_`exp'' (1) `hi_`exp'' {
  2.                 capture qui di _b[`k'.`exp']
  3.                 if _rc==0 {
  4.                         post `ldrresults' (`i') ("`out'") ("`exp'")     //
> /
>                                 ("Confounders+Resid")                        
>                    ///
>                                 (`k') (1) (_b[`k'.`exp']) (_se[`k'.`exp'])
  5.                 }               
  6.                 forvalues l = 2 (1) 3 {
  7.                         capture qui di _b[`k'.`exp'#`l'.agebroad]
  8.                         if _rc==0 {
  9.                             lincom `k'.`exp' + `k'.`exp'#`l'.agebroad
 10.                                 post `ldrresults' (`i') ("`out'") ("`exp'"
> )             ///
>                                         ("Confounders+Resid")                
>                            ///
>                                         (`k') (`l') (r(estimate)) (r(se))
 11.                         }
 12.                 }
 13.         }

 ( 1)  0b.ldr_carecat + 0b.ldr_carecat#2o.agebroad = 0

------------------------------------------------------------------------------
          _t |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
         (1) |          0  (omitted)
------------------------------------------------------------------------------

 ( 1)  0b.ldr_carecat + 0b.ldr_carecat#3o.agebroad = 0

------------------------------------------------------------------------------
          _t |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
         (1) |          0  (omitted)
------------------------------------------------------------------------------

 ( 1)  1.ldr_carecat + 1.ldr_carecat#2.agebroad = 0

------------------------------------------------------------------------------
          _t |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
         (1) |  -32.13849   .2992949  -107.38   0.000     -32.7251   -31.55188
------------------------------------------------------------------------------

 ( 1)  1.ldr_carecat + 1.ldr_carecat#3.agebroad = 0

------------------------------------------------------------------------------
          _t |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
         (1) |   1.216375   .6451649     1.89   0.059    -.0481252    2.480875
------------------------------------------------------------------------------

 ( 1)  2.ldr_carecat + 2.ldr_carecat#2.agebroad = 0

------------------------------------------------------------------------------
          _t |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
         (1) |  -.2173879    .245013    -0.89   0.375    -.6976046    .2628288
------------------------------------------------------------------------------

 ( 1)  2.ldr_carecat + 2.ldr_carecat#3.agebroad = 0

------------------------------------------------------------------------------
          _t |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
         (1) |   .0844791   .2686819     0.31   0.753    -.4421276    .6110859
------------------------------------------------------------------------------

.         
.         * Confounders with physical comorbidities that are indicators for vac
> cination 
.         stcox i.`exp'##i.agebroad age1 age2 age3 male           ///
>                                 i.ethnicity_5                                
>                    ///
>                                 obese40                                      
>                            ///
>                                 respiratory asthma_severe                    
>            ///
>                                 cardiac af dvt_pe i.diabcat                  
>            ///
>                                 liver stroke tia dementia                    
>            ///
>                                 i.kidneyfn                                   
>                            ///
>                                 spleen transplant dialysis                   
>            ///
>                                 immunosuppression cancerHaem                 
>    ///
>                                 autoimmune ibd cancerExhaem1yr,              
>    ///
>                 strata(stpcode) cluster(household_id) 

         failure _d:  coviddeath1
   analysis time _t:  stime_coviddeath1/365.25

Iteration 0:   log pseudolikelihood = -687.13142
Iteration 1:   log pseudolikelihood = -675.74599
Iteration 2:   log pseudolikelihood = -671.54225
Iteration 3:   log pseudolikelihood = -671.45495
Iteration 4:   log pseudolikelihood = -671.44105
Iteration 5:   log pseudolikelihood = -671.43598
Iteration 6:   log pseudolikelihood = -671.43411
Iteration 7:   log pseudolikelihood = -671.43343
Iteration 8:   log pseudolikelihood = -671.43317
Iteration 9:   log pseudolikelihood = -671.43308
Iteration 10:  log pseudolikelihood = -671.43305
Iteration 11:  log pseudolikelihood = -671.43304
Iteration 12:  log pseudolikelihood = -671.43303
Iteration 13:  log pseudolikelihood = -671.43303
Iteration 14:  log pseudolikelihood = -671.43303
Iteration 15:  log pseudolikelihood = -671.43303
Iteration 16:  log pseudolikelihood = -671.43303
Iteration 17:  log pseudolikelihood = -671.43303
Iteration 18:  log pseudolikelihood = -671.43303
Iteration 19:  log pseudolikelihood = -671.43303
Iteration 20:  log pseudolikelihood = -671.43303
Iteration 21:  log pseudolikelihood = -671.43303
Iteration 22:  log pseudolikelihood = -671.43303
Iteration 23:  log pseudolikelihood = -671.43303
Iteration 24:  log pseudolikelihood = -671.43303
Iteration 25:  log pseudolikelihood = -671.43303
Iteration 26:  log pseudolikelihood = -671.43303
Iteration 27:  log pseudolikelihood = -671.43303
Iteration 28:  log pseudolikelihood = -671.43303
Iteration 29:  log pseudolikelihood = -671.43303
Iteration 30:  log pseudolikelihood = -671.43303
Refining estimates:
Iteration 0:   log pseudolikelihood = -671.43303
Iteration 1:   log pseudolikelihood = -671.43303
Iteration 2:   log pseudolikelihood = -671.43303
Iteration 3:   log pseudolikelihood = -671.43303

Stratified Cox regr. -- Breslow method for ties

No. of subjects      =        6,087             Number of obs    =       6,087
No. of failures      =          131
Time at risk         =  2916.769336
                                                Wald chi2(39)    =     8644.27
Log pseudolikelihood =   -671.43303             Prob > chi2      =      0.0000

                         (Std. Err. adjusted for 986 clusters in household_id)
------------------------------------------------------------------------------
             |               Robust
          _t | Haz. Ratio   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
 ldr_carecat |
LDR, not ..  |   .5915097    .612496    -0.51   0.612     .0777249    4.501564
LDR, in r..  |   .8888834   .1776191    -0.59   0.556     .6008352    1.315026
             |
    agebroad |
     65-<75  |   .7667624   .4626974    -0.44   0.660     .2349683    2.502145
        75+  |   3.593374   3.111754     1.48   0.140     .6582447    19.61631
             |
 ldr_carecat#|
    agebroad |
LDR, not .. #|
     65-<75  |   2.85e-14   3.33e-14   -26.68   0.000     2.88e-15    2.82e-13
LDR, not .. #|
        75+  |   8.801037   11.99482     1.60   0.111     .6087547    127.2405
LDR, in r.. #|
     65-<75  |    2.02704   1.341983     1.07   0.286     .5537735    7.419804
LDR, in r.. #|
        75+  |   1.008829   .6049215     0.01   0.988      .311468    3.267543
             |
        age1 |   1.001619   .0491291     0.03   0.974     .9098117    1.102691
        age2 |   1.013217   .1212551     0.11   0.913     .8013763    1.281058
        age3 |   .8816191   .2755001    -0.40   0.687     .4778441    1.626581
        male |   1.013819   .1764149     0.08   0.937     .7208463    1.425865
             |
 ethnicity_5 |
      Mixed  |    1.03664   .3204901     0.12   0.907     .5655465    1.900148
Asian or ..  |    1.54271   .4336751     1.54   0.123     .8892031    2.676503
      Black  |   1.363992   .3799785     1.11   0.265     .7901067    2.354714
      Other  |   1.717929   .4954566     1.88   0.061     .9761481    3.023393
             |
     obese40 |   1.239815   .2518261     1.06   0.290     .8326532    1.846075
 respiratory |   1.330931   .2768008     1.37   0.169     .8853733    2.000711
asthma_sev~e |    .847588   .2533977    -0.55   0.580     .4717444     1.52287
     cardiac |   1.194112   .2412553     0.88   0.380     .8036562    1.774269
          af |   .9288243   .2151746    -0.32   0.750     .5898497    1.462601
      dvt_pe |   .8352802   .2100564    -0.72   0.474      .510237     1.36739
             |
     diabcat |
Controlle..  |   1.260052   .2753731     1.06   0.290     .8210433    1.933797
Uncontrol..  |   .6318371   .3726523    -0.78   0.436     .1988719    2.007413
Diabetes,..  |   9.174417   9.768942     2.08   0.037     1.138196    73.95032
             |
       liver |   .8847683   .1982659    -0.55   0.585     .5702766    1.372694
      stroke |   .9674586   .2191722    -0.15   0.884     .6205797    1.508229
         tia |   .9969957   .2295691    -0.01   0.990     .6348847    1.565639
    dementia |   .8694215   .1972222    -0.62   0.537     .5573669    1.356187
             |
    kidneyfn |
Stage 3a/..  |   1.285305   1.331874     0.24   0.809     .1686416    9.795984
Stage 4/5..  |   1.313789    .371574     0.96   0.335     .7547161    2.287008
             |
      spleen |   .9068161   .1648682    -0.54   0.591     .6349833    1.295019
  transplant |   1.056732    .248741     0.23   0.815     .6661976    1.676203
    dialysis |   .7881924   .2585074    -0.73   0.468     .4144378    1.499012
immunosupp~n |   .7465355   .1400279    -1.56   0.119     .5168807    1.078228
  cancerHaem |   .9126649   .0721208    -1.16   0.247     .7817133    1.065553
  autoimmune |   1.037459   .2146034     0.18   0.859     .6916654    1.556131
         ibd |   .8211047   .2076844    -0.78   0.436     .5001517    1.348017
cancerExha~r |   1.422979   1.447457     0.35   0.729     .1938004    10.44822
------------------------------------------------------------------------------
                                                         Stratified by stpcode

.         forvalues k = `lo_`exp'' (1) `hi_`exp'' {
  2.                 capture qui di _b[`k'.`exp']
  3.                 if _rc==0 {
  4.                         post `ldrresults' (`i') ("`out'") ("`exp'") ///
>                         ("Confounders+Comorb")                               
>            ///
>                         (`k') (1) (_b[`k'.`exp']) (_se[`k'.`exp'])
  5.                 }
  6.                                 forvalues l = 2 (1) 3 {
  7.                         capture qui di _b[`k'.`exp'#`l'.agebroad]
  8.                         if _rc==0 {
  9.                             lincom `k'.`exp' + `k'.`exp'#`l'.agebroad
 10.                                 post `ldrresults' (`i') ("`out'") ("`exp'"
> )             ///
>                                         ("Confounders+Comorb")               
>                            ///
>                                         (`k') (`l') (r(estimate)) (r(se))
 11.                         }
 12.                 }
 13.         }

 ( 1)  0b.ldr_carecat + 0b.ldr_carecat#2o.agebroad = 0

------------------------------------------------------------------------------
          _t |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
         (1) |          0  (omitted)
------------------------------------------------------------------------------

 ( 1)  0b.ldr_carecat + 0b.ldr_carecat#3o.agebroad = 0

------------------------------------------------------------------------------
          _t |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
         (1) |          0  (omitted)
------------------------------------------------------------------------------

 ( 1)  1.ldr_carecat + 1.ldr_carecat#2.agebroad = 0

------------------------------------------------------------------------------
          _t |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
         (1) |  -31.71461   .5995732   -52.90   0.000    -32.88975   -30.53947
------------------------------------------------------------------------------

 ( 1)  1.ldr_carecat + 1.ldr_carecat#3.agebroad = 0

------------------------------------------------------------------------------
          _t |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
         (1) |   1.649792   .8901462     1.85   0.064    -.0948622    3.394447
------------------------------------------------------------------------------

 ( 1)  2.ldr_carecat + 2.ldr_carecat#2.agebroad = 0

------------------------------------------------------------------------------
          _t |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
         (1) |   .5887873   .6379147     0.92   0.356    -.6615025    1.839077
------------------------------------------------------------------------------

 ( 1)  2.ldr_carecat + 2.ldr_carecat#3.agebroad = 0

------------------------------------------------------------------------------
          _t |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
         (1) |  -.1089993   .5711945    -0.19   0.849     -1.22852    1.010521
------------------------------------------------------------------------------

.         
.         * All variables
.         stcox i.`exp'##i.agebroad age1 age2 age3 male           ///
>                                 i.ethnicity_5 imd resid_care_ldr             
>    ///
>                                 obese40                                      
>                            ///
>                                 respiratory asthma_severe                    
>            ///
>                                 cardiac af dvt_pe i.diabcat                  
>            ///
>                                 liver stroke tia dementia                    
>            ///
>                                 i.kidneyfn                                   
>                            ///
>                                 spleen transplant dialysis                   
>            ///
>                                 immunosuppression cancerHaem                 
>    ///
>                                 autoimmune ibd cancerExhaem1yr,              
>    ///
>                                 strata(stpcode) cluster(household_id) 

         failure _d:  coviddeath1
   analysis time _t:  stime_coviddeath1/365.25

Iteration 0:   log pseudolikelihood = -687.13142
Iteration 1:   log pseudolikelihood = -675.19982
Iteration 2:   log pseudolikelihood = -670.86091
Iteration 3:   log pseudolikelihood =  -670.7729
Iteration 4:   log pseudolikelihood = -670.75904
Iteration 5:   log pseudolikelihood = -670.75398
Iteration 6:   log pseudolikelihood = -670.75212
Iteration 7:   log pseudolikelihood = -670.75143
Iteration 8:   log pseudolikelihood = -670.75118
Iteration 9:   log pseudolikelihood = -670.75109
Iteration 10:  log pseudolikelihood = -670.75106
Iteration 11:  log pseudolikelihood = -670.75104
Iteration 12:  log pseudolikelihood = -670.75104
Iteration 13:  log pseudolikelihood = -670.75104
Iteration 14:  log pseudolikelihood = -670.75104
Iteration 15:  log pseudolikelihood = -670.75104
Iteration 16:  log pseudolikelihood = -670.75104
Iteration 17:  log pseudolikelihood = -670.75104
Iteration 18:  log pseudolikelihood = -670.75104
Iteration 19:  log pseudolikelihood = -670.75104
Iteration 20:  log pseudolikelihood = -670.75104
Iteration 21:  log pseudolikelihood = -670.75104
Iteration 22:  log pseudolikelihood = -670.75104
Iteration 23:  log pseudolikelihood = -670.75104
Iteration 24:  log pseudolikelihood = -670.75104
Iteration 25:  log pseudolikelihood = -670.75104
Iteration 26:  log pseudolikelihood = -670.75104
Iteration 27:  log pseudolikelihood = -670.75104
Iteration 28:  log pseudolikelihood = -670.75104
Iteration 29:  log pseudolikelihood = -670.75104
Iteration 30:  log pseudolikelihood = -670.75104
Refining estimates:
Iteration 0:   log pseudolikelihood = -670.75104
Iteration 1:   log pseudolikelihood = -670.75104

Stratified Cox regr. -- Breslow method for ties

No. of subjects      =        6,087             Number of obs    =       6,087
No. of failures      =          131
Time at risk         =  2916.769336
                                                Wald chi2(41)    =     7685.20
Log pseudolikelihood =   -670.75104             Prob > chi2      =      0.0000

                         (Std. Err. adjusted for 986 clusters in household_id)
------------------------------------------------------------------------------
             |               Robust
          _t | Haz. Ratio   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
 ldr_carecat |
LDR, not ..  |   .3383598   .3818177    -0.96   0.337     .0370554    3.089626
LDR, in r..  |   .9146797    .186293    -0.44   0.661     .6136273    1.363432
             |
    agebroad |
     65-<75  |   .7764382   .4701249    -0.42   0.676      .236981    2.543901
        75+  |   3.657682   3.179237     1.49   0.136     .6658036    20.09397
             |
 ldr_carecat#|
    agebroad |
LDR, not .. #|
     65-<75  |   2.10e-13   2.46e-13   -24.92   0.000     2.11e-14    2.08e-12
LDR, not .. #|
        75+  |   8.678546   11.85192     1.58   0.114      .597032    126.1526
LDR, in r.. #|
     65-<75  |   2.019132   1.340109     1.06   0.290     .5498162    7.415014
LDR, in r.. #|
        75+  |   1.002851   .6021857     0.00   0.996     .3091092    3.253574
             |
        age1 |   1.002334   .0493679     0.05   0.962     .9100977    1.103917
        age2 |   1.011459   .1215625     0.09   0.924     .7991836    1.280119
        age3 |   .8846083   .2775519    -0.39   0.696     .4782783    1.636143
        male |   1.015595   .1772677     0.09   0.929      .721352    1.429862
             |
 ethnicity_5 |
      Mixed  |   1.033663   .3196744     0.11   0.915     .5638107    1.895067
Asian or ..  |    1.54647    .434292     1.55   0.121     .8918671     2.68153
      Black  |   1.362715   .3797117     1.11   0.267     .7892654    2.352809
      Other  |     1.7282   .4981779     1.90   0.058     .9822522    3.040638
             |
         imd |   .9927428   .0642923    -0.11   0.910     .8744017      1.1271
resid_care~r |   .5555667   .2629515    -1.24   0.214      .219715    1.404794
     obese40 |   1.246163   .2530761     1.08   0.279     .8369688    1.855413
 respiratory |   1.331136   .2769391     1.37   0.169     .8853853    2.001302
asthma_sev~e |   .8529703   .2554379    -0.53   0.595     .4742701    1.534059
     cardiac |    1.19726   .2415674     0.89   0.372      .806203    1.778004
          af |   .9284633   .2153435    -0.32   0.749     .5893061    1.462812
      dvt_pe |   .8322097   .2096468    -0.73   0.466     .5079273    1.363528
             |
     diabcat |
Controlle..  |   1.262054   .2762839     1.06   0.288     .8217433    1.938294
Uncontrol..  |   .6294075   .3717025    -0.78   0.433     .1978094    2.002705
Diabetes,..  |   9.277665   9.909687     2.09   0.037     1.143538    75.27082
             |
       liver |   .8799719   .1965604    -0.57   0.567     .5679824    1.363335
      stroke |   .9740876   .2204667    -0.12   0.908     .6250925     1.51793
         tia |   .9944103   .2287439    -0.02   0.981     .6335253    1.560872
    dementia |   .8586044   .1943396    -0.67   0.501     .5509715    1.338003
             |
    kidneyfn |
Stage 3a/..  |   1.280897    1.32589     0.24   0.811     .1684278    9.741255
Stage 4/5..  |   1.318205   .3734278     0.98   0.329     .7565723     2.29676
             |
      spleen |   .9069428   .1651437    -0.54   0.592     .6347256    1.295907
  transplant |   1.051152   .2473173     0.21   0.832     .6628162     1.66701
    dialysis |   .7866949   .2583596    -0.73   0.465     .4132967    1.497444
immunosupp~n |   .7432889   .1402173    -1.57   0.116     .5135505    1.075801
  cancerHaem |   .9134277   .0723428    -1.14   0.253     .7820952    1.066814
  autoimmune |   1.038607   .2145442     0.18   0.854     .6928184    1.556981
         ibd |   .8243181   .2089176    -0.76   0.446     .5016073    1.354646
cancerExha~r |   1.441285    1.46906     0.36   0.720     .1954992    10.62564
------------------------------------------------------------------------------
                                                         Stratified by stpcode

.         forvalues k = `lo_`exp'' (1) `hi_`exp'' {
  2.                 capture qui di _b[`k'.`exp']
  3.                 if _rc==0 {
  4.                         post `ldrresults' (`i') ("`out'") ("`exp'")     //
> /
>                         ("All")                                              
>                                    ///
>                         (`k') (1) (_b[`k'.`exp']) (_se[`k'.`exp'])
  5.                 }
  6.                                 forvalues l = 2 (1) 3 {
  7.                         capture qui di _b[`k'.`exp'#`l'.agebroad]
  8.                         if _rc==0 {
  9.                             lincom `k'.`exp' + `k'.`exp'#`l'.agebroad
 10.                                 post `ldrresults' (`i') ("`out'") ("`exp'"
> )     ///
>                                         ("All")                              
>                                    ///
>                                         (`k') (`l') (r(estimate)) (r(se))
 11.                         }
 12.                 }
 13.         }

 ( 1)  0b.ldr_carecat + 0b.ldr_carecat#2o.agebroad = 0

------------------------------------------------------------------------------
          _t |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
         (1) |          0  (omitted)
------------------------------------------------------------------------------

 ( 1)  0b.ldr_carecat + 0b.ldr_carecat#3o.agebroad = 0

------------------------------------------------------------------------------
          _t |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
         (1) |          0  (omitted)
------------------------------------------------------------------------------

 ( 1)  1.ldr_carecat + 1.ldr_carecat#2.agebroad = 0

------------------------------------------------------------------------------
          _t |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
         (1) |  -30.27635   .7162201   -42.27   0.000    -31.68012   -28.87259
------------------------------------------------------------------------------

 ( 1)  1.ldr_carecat + 1.ldr_carecat#3.agebroad = 0

------------------------------------------------------------------------------
          _t |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
         (1) |   1.077209   1.018344     1.06   0.290    -.9187097    3.073127
------------------------------------------------------------------------------

 ( 1)  2.ldr_carecat + 2.ldr_carecat#2.agebroad = 0

------------------------------------------------------------------------------
          _t |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
         (1) |   .6134865   .6406392     0.96   0.338    -.6421433    1.869116
------------------------------------------------------------------------------

 ( 1)  2.ldr_carecat + 2.ldr_carecat#3.agebroad = 0

------------------------------------------------------------------------------
          _t |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
         (1) |  -.0863346   .5704978    -0.15   0.880     -1.20449    1.031821
------------------------------------------------------------------------------

. 
. postclose `ldrresults'

. 
. use `ldrfile', clear

. 
. 
. *************************
. *  Tidy output for HRs  *
. *************************
. 
. * Outcome
. rename outcome out

. gen outcome     = 1 if out=="coviddeath"

. replace outcome = 2 if out=="covidadmission"
(0 real changes made)

. replace outcome = 3 if out=="composite"
(0 real changes made)

. 
. label define outcome    1 "COVID-19 death"              ///
>                                                 2 "COVID-19 admission"  ///
>                                                 3 "Composite"

. label values outcome outcome

. drop out

. 
. * Exposure
. rename exposure exp

. gen     exposure = 1 if exp=="ldr"
(45 missing values generated)

. replace exposure = 2 if exp=="ldr_cat"
(0 real changes made)

. replace exposure = 3 if exp=="ldr_carecat"
(45 real changes made)

. replace exposure = 4 if exp=="ds"
(0 real changes made)

. replace exposure = 5 if exp=="cp"
(0 real changes made)

. replace exposure = 6 if exp=="ldr_group"
(0 real changes made)

. 
. label define exposure   1 "Learning disability register"        ///
>                                                 2 "LDR Severe vs mild"       
>                    ///
>                                                 3 "LDR by residential care"  
>                    ///
>                                                 4 "Down's syndrome"          
>                            ///
>                                                 5 "Cerebral Palsy"           
>                            ///
>                                                 6 "Combined grouping"        
>                    

. label values exposure exposure                                          

. drop exp

. 
. * Age categories
. label define agebroad   1 "16-<65"              ///
>                                                 2 "65-<75"              ///
>                                                 3 "75+"

. label values agebroad agebroad

. 
. 
. * Categories of exposure
. gen category     = "No"                                         if expcat==0
(30 missing values generated)

. replace category = "Yes"                                        if inlist(exp
> osure, 1, 4, 5) & expcat==1
(0 real changes made)

. 
. replace category = "LDR, mild"                          if inlist(exposure, 2
> ) & expcat==1
(0 real changes made)

. replace category = "LDR, profound"                      if inlist(exposure, 2
> ) & expcat==2
(0 real changes made)

. 
. replace category = "LDR, community"             if inlist(exposure, 3) & expc
> at==1
variable category was str2 now str14
(15 real changes made)

. replace category = "LDR, residential care"      if inlist(exposure, 3) & expc
> at==2
variable category was str14 now str21
(15 real changes made)

. 
. replace category = "DS but not LDR"             if inlist(exposure, 6) & expc
> at==1
(0 real changes made)

. replace category = "DS and LDR"                         if inlist(exposure, 6
> ) & expcat==2
(0 real changes made)

. replace category = "CP but not LDR"             if inlist(exposure, 6) & expc
> at==3
(0 real changes made)

. replace category = "CP and LDR"                         if inlist(exposure, 6
> ) & expcat==4
(0 real changes made)

. replace category = "LDR with no DS or CP"       if inlist(exposure, 6) & expc
> at==5
(0 real changes made)

. 
. * Model adjustment
. gen     adjustment = 1 if model=="Confounders"
(36 missing values generated)

. replace adjustment = 2 if model=="Confounders+IMD"
(9 real changes made)

. replace adjustment = 3 if model=="Confounders+Resid"
(9 real changes made)

. replace adjustment = 4 if model=="Confounders+Comorb"
(9 real changes made)

. replace adjustment = 5 if model=="All"
(9 real changes made)

. label define adj        1 "Confounders"                                      
>    ///     
>                                         2 "Confounders with IMD"             
>            ///
>                                         3 "Confounders with care"            
>            ///
>                                         4 "Confounders with comorbidities"   
>    ///
>                                         5 "All"

. label values adjustment adj

. drop model

. 
. * Hazard ratio with 95% confidence interval
. gen cl = exp(lnhr - invnorm(0.975)*sehr)

. gen cu = exp(lnhr + invnorm(0.975)*sehr)

. gen hr = exp(lnhr)

. 
. gen hr_ci =   string(round(hr, 0.01)) + " (" ///
>                         + string(round(cl, 0.01)) + ", " ///
>                         + string(round(cu, 0.01)) + ")"

. replace hr_ci = "" if expcat==0
(15 real changes made)

. drop cl cu hr lnhr sehr

. 
. * Put in wide format
. reshape wide hr_ci, i(wave outcome exposure expcat agebroad) j(adjust)
(note: j = 1 2 3 4 5)

Data                               long   ->   wide
-----------------------------------------------------------------------------
Number of obs.                       45   ->       9
Number of variables                   8   ->      11
j variable (5 values)        adjustment   ->   (dropped)
xij variables:
                                  hr_ci   ->   hr_ci1 hr_ci2 ... hr_ci5
-----------------------------------------------------------------------------

. rename hr_ci1 hr_conf

. rename hr_ci2 hr_conf_imd

. rename hr_ci3 hr_conf_resid

. rename hr_ci4 hr_conf_comorb

. 
. 
. order wave outcome exposure agebroad category hr*

. sort wave outcome exposure agebroad expcat

. 
. * Save data
. outsheet using "output/ldcox_inter_wave`i'_`out'_`exp'", replace
(note: file output/ldcox_inter_wave1_coviddeath_ldr_carecat.out not found)

. 
. log close
      name:  <unnamed>
       log:  /workspace/logs/AL006_cox_regression_inter_wave1_coviddeath_ldr_ca
> recat.log
  log type:  text
 closed on:  25 Feb 2021, 20:19:25
-------------------------------------------------------------------------------
