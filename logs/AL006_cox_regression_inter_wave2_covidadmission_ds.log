-------------------------------------------------------------------------------
      name:  <unnamed>
       log:  /workspace/logs/AL006_cox_regression_inter_wave2_covidadmission_ds
> .log
  log type:  text
 opened on:  25 Feb 2021, 20:12:13

. 
. 
. * Categories of various exposures
. local lo_ldr            = 0

. local hi_ldr            = 1

. local lo_ldr_cat        = 0

. local hi_ldr_cat        = 2

. local hi_ldr            = 1

. local lo_ldr_carecat= 0

. local hi_ldr_carecat= 2

. local lo_ds             = 0

. local hi_ds             = 1

. local lo_cp             = 0

. local hi_cp             = 1

. local lo_ldr_group      = 0

. local hi_ldr_group      = 5

. 
. * Open temporary file to post results
. tempfile ldrfile

. tempname ldrresults

. 
. postfile `ldrresults'   wave str15(outcome) str15(exposure) str20(model)     
>    ///
>                                                 expcat agebroad lnhr sehr usi
> ng `ldrfile'

. 
. 
.         * Open dataset (complete case ethnicity)
.         use "analysis/data_ldanalysis_cohort`i'.dta", clear 
(Analysis dataset, wave 2 (1 Sept 20 - latest), for learning disability work)

.         drop if ethnicity_5>=.
(11,245 observations deleted)

. 
.         * Only keep data for adults
.         keep if child==0
(6,499 observations deleted)

. 
.         
.         /*  Declare data to be survival  */
. 
.         stset stime_`out'`i', fail(`out'`i') scale(365.25)

     failure event:  covidadmission2 != 0 & covidadmission2 < .
obs. time interval:  (0, stime_covidadmission2]
 exit on or before:  failure
    t for analysis:  time/365.25

------------------------------------------------------------------------------
     27,126  total observations
      2,767  observations end on or before enter()
------------------------------------------------------------------------------
     24,359  observations remaining, representing
      2,360  failures in single-record/single-failure data
  9,788.172  total analysis time at risk and under observation
                                                at risk from t =         0
                                     earliest observed entry t =         0
                                          last observed exit t =  .4462697

. 
.         
.                 
.         /*  Fit Cox models  */
.         
.         * Confounder only model
.         stcox i.`exp'##i.agebroad age1 age2 age3 male i.ethnicity_5,    ///
>                 strata(stpcode) cluster(household_id) 

         failure _d:  covidadmission2
   analysis time _t:  stime_covidadmission2/365.25

Iteration 0:   log pseudolikelihood = -15518.831
Iteration 1:   log pseudolikelihood = -15509.033
Iteration 2:   log pseudolikelihood = -15509.011
Iteration 3:   log pseudolikelihood = -15509.011
Refining estimates:
Iteration 0:   log pseudolikelihood = -15509.011

Stratified Cox regr. -- Breslow method for ties

No. of subjects      =       24,359             Number of obs    =      24,359
No. of failures      =        2,360
Time at risk         =  9788.172485
                                                Wald chi2(13)    =       21.16
Log pseudolikelihood =   -15509.011             Prob > chi2      =      0.0697

                       (Std. Err. adjusted for 1,195 clusters in household_id)
------------------------------------------------------------------------------
             |               Robust
          _t | Haz. Ratio   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
        1.ds |   .9491402   .0570543    -0.87   0.385     .8436519    1.067819
             |
    agebroad |
     65-<75  |   .7902005    .091961    -2.02   0.043     .6290385    .9926528
        75+  |   .9447525   .1916978    -0.28   0.779     .6347497    1.406156
             |
 ds#agebroad |
   1#65-<75  |   1.273255   .2021924     1.52   0.128     .9327063    1.738144
      1#75+  |   1.053839   .1775077     0.31   0.756     .7575283    1.466054
             |
        age1 |   1.001075   .0129423     0.08   0.934     .9760274    1.026766
        age2 |   .9974582   .0313382    -0.08   0.935     .9378893    1.060811
        age3 |   1.011468   .0834021     0.14   0.890     .8605286    1.188884
        male |   1.077225   .0423669     1.89   0.059     .9973068    1.163546
             |
 ethnicity_5 |
      Mixed  |   1.042985   .0694119     0.63   0.527      .915439    1.188301
Asian or ..  |   1.045531   .0718396     0.65   0.517     .9137977    1.196256
      Black  |   1.164493   .0770247     2.30   0.021     1.022903    1.325681
      Other  |    .983503   .0670954    -0.24   0.807     .8604112    1.124205
------------------------------------------------------------------------------
                                                         Stratified by stpcode

.         forvalues k = `lo_`exp'' (1) `hi_`exp'' {
  2.                 capture qui di _b[`k'.`exp']
  3.                 if _rc==0 {
  4.                         post `ldrresults' (`i') ("`out'") ("`exp'")       
>       ///
>                                 ("Confounders")                              
>                            ///
>                                 (`k') (1) (_b[`k'.`exp']) (_se[`k'.`exp'])
  5.                 }
  6.                 forvalues l = 2 (1) 3 {
  7.                         capture qui di _b[`k'.`exp'#`l'.agebroad]
  8.                         if _rc==0 {
  9.                             lincom `k'.`exp' + `k'.`exp'#`l'.agebroad
 10.                                 post `ldrresults' (`i') ("`out'") ("`exp'"
> )             ///
>                                         ("Confounders")                      
>                                    ///
>                                         (`k') (`l') (r(estimate)) (r(se))
 11.                         }
 12.                 }
 13.         }

 ( 1)  0b.ds + 0b.ds#2o.agebroad = 0

------------------------------------------------------------------------------
          _t |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
         (1) |          0  (omitted)
------------------------------------------------------------------------------

 ( 1)  0b.ds + 0b.ds#3o.agebroad = 0

------------------------------------------------------------------------------
          _t |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
         (1) |          0  (omitted)
------------------------------------------------------------------------------

 ( 1)  1.ds + 1.ds#2.agebroad = 0

------------------------------------------------------------------------------
          _t |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
         (1) |   .1893778   .1476962     1.28   0.200    -.1001015    .4788571
------------------------------------------------------------------------------

 ( 1)  1.ds + 1.ds#3.agebroad = 0

------------------------------------------------------------------------------
          _t |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
         (1) |   .0002412   .1580193     0.00   0.999    -.3094709    .3099533
------------------------------------------------------------------------------

.         
.         * Confounders with deprivation
.         stcox i.`exp'##i.agebroad age1 age2 age3 male i.ethnicity_5 imd, ///
>                 strata(stpcode) cluster(household_id) 

         failure _d:  covidadmission2
   analysis time _t:  stime_covidadmission2/365.25

Iteration 0:   log pseudolikelihood = -15518.831
Iteration 1:   log pseudolikelihood = -15509.026
Iteration 2:   log pseudolikelihood = -15509.004
Iteration 3:   log pseudolikelihood = -15509.004
Refining estimates:
Iteration 0:   log pseudolikelihood = -15509.004

Stratified Cox regr. -- Breslow method for ties

No. of subjects      =       24,359             Number of obs    =      24,359
No. of failures      =        2,360
Time at risk         =  9788.172485
                                                Wald chi2(14)    =       21.17
Log pseudolikelihood =   -15509.004             Prob > chi2      =      0.0975

                       (Std. Err. adjusted for 1,195 clusters in household_id)
------------------------------------------------------------------------------
             |               Robust
          _t | Haz. Ratio   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
        1.ds |    .949187   .0570523    -0.87   0.386      .843702     1.06786
             |
    agebroad |
     65-<75  |   .7901228   .0919271    -2.02   0.043     .6290153    .9924941
        75+  |   .9448656   .1917003    -0.28   0.780     .6348526    1.406265
             |
 ds#agebroad |
   1#65-<75  |   1.273358    .202134     1.52   0.128     .9328894    1.738085
      1#75+  |   1.053933   .1775671     0.31   0.755     .7575345    1.466304
             |
        age1 |    1.00107   .0129417     0.08   0.934     .9760238     1.02676
        age2 |   .9974717   .0313365    -0.08   0.936     .9379058     1.06082
        age3 |   1.011429   .0833931     0.14   0.890     .8605047    1.188824
        male |   1.077207   .0423574     1.89   0.059     .9973061    1.163508
             |
 ethnicity_5 |
      Mixed  |   1.042998   .0694092     0.63   0.527     .9154565    1.188308
Asian or ..  |   1.045539   .0718414     0.65   0.517     .9138024    1.196268
      Black  |   1.164406    .076969     2.30   0.021     1.022914    1.325471
      Other  |   .9834236   .0670615    -0.25   0.806     .8603905     1.12405
             |
         imd |   .9979541   .0172733    -0.12   0.906     .9646668     1.03239
------------------------------------------------------------------------------
                                                         Stratified by stpcode

.         forvalues k = `lo_`exp'' (1) `hi_`exp'' {
  2.                 capture qui di _b[`k'.`exp']
  3.                 if _rc==0 {
  4.                         post `ldrresults' (`i') ("`out'") ("`exp'")     //
> /
>                                 ("Confounders+IMD")                          
>                    ///
>                                 (`k') (1) (_b[`k'.`exp']) (_se[`k'.`exp'])
  5.                 }       
  6.                 forvalues l = 2 (1) 3 {
  7.                         capture qui di _b[`k'.`exp'#`l'.agebroad]
  8.                         if _rc==0 {
  9.                             lincom `k'.`exp' + `k'.`exp'#`l'.agebroad
 10.                                 post `ldrresults' (`i') ("`out'") ("`exp'"
> )             ///
>                                         ("Confounders+IMD")                  
>                            ///
>                                         (`k') (`l') (r(estimate)) (r(se))
 11.                         }
 12.                 }
 13.         }

 ( 1)  0b.ds + 0b.ds#2o.agebroad = 0

------------------------------------------------------------------------------
          _t |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
         (1) |          0  (omitted)
------------------------------------------------------------------------------

 ( 1)  0b.ds + 0b.ds#3o.agebroad = 0

------------------------------------------------------------------------------
          _t |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
         (1) |          0  (omitted)
------------------------------------------------------------------------------

 ( 1)  1.ds + 1.ds#2.agebroad = 0

------------------------------------------------------------------------------
          _t |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
         (1) |   .1895083   .1475942     1.28   0.199     -.099771    .4787875
------------------------------------------------------------------------------

 ( 1)  1.ds + 1.ds#3.agebroad = 0

------------------------------------------------------------------------------
          _t |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
         (1) |   .0003799   .1580826     0.00   0.998    -.3094564    .3102162
------------------------------------------------------------------------------

.         
.         * Confounders with residential care
.         stcox i.`exp'##i.agebroad age1 age2 age3 male   ///
>                                 i.ethnicity_5 resid_care_ldr,           ///
>                 strata(stpcode) cluster(household_id) 

         failure _d:  covidadmission2
   analysis time _t:  stime_covidadmission2/365.25

Iteration 0:   log pseudolikelihood = -15518.831
Iteration 1:   log pseudolikelihood = -15508.532
Iteration 2:   log pseudolikelihood = -15508.509
Iteration 3:   log pseudolikelihood = -15508.509
Refining estimates:
Iteration 0:   log pseudolikelihood = -15508.509

Stratified Cox regr. -- Breslow method for ties

No. of subjects      =       24,359             Number of obs    =      24,359
No. of failures      =        2,360
Time at risk         =  9788.172485
                                                Wald chi2(14)    =       21.99
Log pseudolikelihood =   -15508.509             Prob > chi2      =      0.0788

                       (Std. Err. adjusted for 1,195 clusters in household_id)
------------------------------------------------------------------------------
             |               Robust
          _t | Haz. Ratio   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
        1.ds |   .9489645   .0570518    -0.87   0.384     .8434817    1.067639
             |
    agebroad |
     65-<75  |   .7893425   .0918697    -2.03   0.042     .6283422     .991596
        75+  |   .9421998   .1911762    -0.29   0.769     .6330394    1.402346
             |
 ds#agebroad |
   1#65-<75  |   1.272533   .2020883     1.52   0.129     .9321624    1.737187
      1#75+  |    1.05444   .1775892     0.31   0.753     .7579873    1.466836
             |
        age1 |    1.00121   .0129472     0.09   0.925     .9761532    1.026911
        age2 |   .9970936   .0313361    -0.09   0.926     .9375292    1.060442
        age3 |   1.012527   .0835148     0.15   0.880     .8613864    1.190186
        male |   1.076857   .0423588     1.88   0.060     .9969549    1.163163
             |
 ethnicity_5 |
      Mixed  |   1.043138   .0694086     0.63   0.526     .9155963    1.188445
Asian or ..  |   1.045608   .0718481     0.65   0.516     .9138595    1.196351
      Black  |   1.164618    .077031     2.30   0.021     1.023017    1.325819
      Other  |   .9839858   .0671172    -0.24   0.813     .8608526    1.124732
             |
resid_care~r |   1.111861   .1215441     0.97   0.332     .8974303    1.377528
------------------------------------------------------------------------------
                                                         Stratified by stpcode

.         forvalues k = `lo_`exp'' (1) `hi_`exp'' {
  2.                 capture qui di _b[`k'.`exp']
  3.                 if _rc==0 {
  4.                         post `ldrresults' (`i') ("`out'") ("`exp'")     //
> /
>                                 ("Confounders+Resid")                        
>                    ///
>                                 (`k') (1) (_b[`k'.`exp']) (_se[`k'.`exp'])
  5.                 }               
  6.                 forvalues l = 2 (1) 3 {
  7.                         capture qui di _b[`k'.`exp'#`l'.agebroad]
  8.                         if _rc==0 {
  9.                             lincom `k'.`exp' + `k'.`exp'#`l'.agebroad
 10.                                 post `ldrresults' (`i') ("`out'") ("`exp'"
> )             ///
>                                         ("Confounders+Resid")                
>                            ///
>                                         (`k') (`l') (r(estimate)) (r(se))
 11.                         }
 12.                 }
 13.         }

 ( 1)  0b.ds + 0b.ds#2o.agebroad = 0

------------------------------------------------------------------------------
          _t |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
         (1) |          0  (omitted)
------------------------------------------------------------------------------

 ( 1)  0b.ds + 0b.ds#3o.agebroad = 0

------------------------------------------------------------------------------
          _t |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
         (1) |          0  (omitted)
------------------------------------------------------------------------------

 ( 1)  1.ds + 1.ds#2.agebroad = 0

------------------------------------------------------------------------------
          _t |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
         (1) |   .1886256    .147706     1.28   0.202    -.1008728     .478124
------------------------------------------------------------------------------

 ( 1)  1.ds + 1.ds#3.agebroad = 0

------------------------------------------------------------------------------
          _t |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
         (1) |   .0006256   .1579873     0.00   0.997    -.3090238    .3102749
------------------------------------------------------------------------------

.         
.         * Confounders with physical comorbidities that are indicators for vac
> cination 
.         stcox i.`exp'##i.agebroad age1 age2 age3 male           ///
>                                 i.ethnicity_5                                
>                    ///
>                                 obese40                                      
>                            ///
>                                 respiratory asthma_severe                    
>            ///
>                                 cardiac af dvt_pe i.diabcat                  
>            ///
>                                 liver stroke tia dementia                    
>            ///
>                                 i.kidneyfn                                   
>                            ///
>                                 spleen transplant dialysis                   
>            ///
>                                 immunosuppression cancerHaem                 
>    ///
>                                 autoimmune ibd cancerExhaem1yr,              
>    ///
>                 strata(stpcode) cluster(household_id) 

         failure _d:  covidadmission2
   analysis time _t:  stime_covidadmission2/365.25

Iteration 0:   log pseudolikelihood =  -2445.012
Iteration 1:   log pseudolikelihood = -2428.3021
Iteration 2:   log pseudolikelihood = -2427.0468
Iteration 3:   log pseudolikelihood = -2426.6425
Iteration 4:   log pseudolikelihood = -2426.4943
Iteration 5:   log pseudolikelihood = -2426.4398
Iteration 6:   log pseudolikelihood = -2426.4197
Iteration 7:   log pseudolikelihood = -2426.4124
Iteration 8:   log pseudolikelihood = -2426.4097
Iteration 9:   log pseudolikelihood = -2426.4087
Iteration 10:  log pseudolikelihood = -2426.4083
Iteration 11:  log pseudolikelihood = -2426.4082
Iteration 12:  log pseudolikelihood = -2426.4081
Iteration 13:  log pseudolikelihood = -2426.4081
Iteration 14:  log pseudolikelihood = -2426.4081
Iteration 15:  log pseudolikelihood = -2426.4081
Iteration 16:  log pseudolikelihood = -2426.4081
Iteration 17:  log pseudolikelihood = -2426.4081
Iteration 18:  log pseudolikelihood = -2426.4081
Iteration 19:  log pseudolikelihood = -2426.4081
Iteration 20:  log pseudolikelihood = -2426.4081
Iteration 21:  log pseudolikelihood = -2426.4081
Iteration 22:  log pseudolikelihood = -2426.4081
Iteration 23:  log pseudolikelihood = -2426.4081
Iteration 24:  log pseudolikelihood = -2426.4081
Iteration 25:  log pseudolikelihood = -2426.4081
Iteration 26:  log pseudolikelihood = -2426.4081
Iteration 27:  log pseudolikelihood = -2426.4081
Iteration 28:  log pseudolikelihood = -2426.4081
Iteration 29:  log pseudolikelihood = -2426.4081
Iteration 30:  log pseudolikelihood = -2426.4081
Iteration 31:  log pseudolikelihood = -2426.4081
Iteration 32:  log pseudolikelihood = -2426.4081
Iteration 33:  log pseudolikelihood = -2426.4081
Iteration 34:  log pseudolikelihood = -2426.4081
Iteration 35:  log pseudolikelihood = -2426.4081
Iteration 36:  log pseudolikelihood = -2426.4081
Refining estimates:
Iteration 0:   log pseudolikelihood = -2426.4081
Iteration 1:   log pseudolikelihood = -2426.4081
Iteration 2:   log pseudolikelihood = -2426.4081

Stratified Cox regr. -- Breslow method for ties

No. of subjects      =        4,879             Number of obs    =       4,879
No. of failures      =          492
Time at risk         =  1962.721424
                                                Wald chi2(36)    =    52155.33
Log pseudolikelihood =   -2426.4081             Prob > chi2      =      0.0000

                         (Std. Err. adjusted for 938 clusters in household_id)
------------------------------------------------------------------------------
             |               Robust
          _t | Haz. Ratio   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
        1.ds |   .9780694   .1248342    -0.17   0.862      .761602    1.256063
             |
    agebroad |
     65-<75  |   .8596843   .2322947    -0.56   0.576     .5062165    1.459962
        75+  |    .902145   .4130479    -0.22   0.822     .3677502    2.213094
             |
 ds#agebroad |
   1#65-<75  |   .5806251   .2493035    -1.27   0.205     .2502734    1.347029
      1#75+  |   1.434953   .4866316     1.06   0.287     .7381971    2.789352
             |
        age1 |   .9562582   .0264463    -1.62   0.106     .9058042    1.009522
        age2 |   1.106297   .0757838     1.47   0.140     .9673033    1.265264
        age3 |   .7952614   .1451983    -1.25   0.210     .5560298    1.137422
        male |   .9913856   .0907375    -0.09   0.925     .8285821    1.186177
             |
 ethnicity_5 |
      Mixed  |   1.098749   .1706894     0.61   0.544     .8103359    1.489812
Asian or ..  |   1.208837   .1844787     1.24   0.214     .8963285    1.630303
      Black  |   1.376106   .2024584     2.17   0.030     1.031382    1.836048
      Other  |    1.12443   .1677581     0.79   0.432     .8393409    1.506352
             |
     obese40 |    .980548   .1095067    -0.18   0.860     .7877846    1.220479
 respiratory |   1.062894   .1248742     0.52   0.604     .8442797    1.338115
asthma_sev~e |   .8442793   .1295331    -1.10   0.270     .6250159    1.140463
     cardiac |   .9080218   .1082084    -0.81   0.418     .7188844    1.146921
          af |   1.060276   .1172947     0.53   0.597     .8535981    1.316996
      dvt_pe |   1.148303   .1256787     1.26   0.206     .9266054    1.423044
             |
     diabcat |
Controlle..  |    .934247   .1255666    -0.51   0.613     .7178882    1.215813
Uncontrol..  |   1.408204   .3146977     1.53   0.126     .9087488    2.182164
Diabetes,..  |   2.74e-17   1.63e-17   -64.17   0.000     8.56e-18    8.79e-17
             |
       liver |   .9462577   .1132269    -0.46   0.644     .7484396    1.196361
      stroke |    .942072    .112692    -0.50   0.618     .7451816    1.190984
         tia |   1.098283   .1260684     0.82   0.414     .8770158    1.375374
    dementia |    .956019   .1090345    -0.39   0.693     .7645159    1.195492
             |
    kidneyfn |
Stage 3a/..  |   2.82e-17   6.00e-18  -179.31   0.000     1.86e-17    4.28e-17
Stage 4/5..  |   .8013231   .1252597    -1.42   0.156     .5898631    1.088589
             |
      spleen |   .9253246    .087381    -0.82   0.411     .7689759    1.113462
  transplant |   .9736964   .1150549    -0.23   0.822     .7724014    1.227451
    dialysis |   1.103847   .2010888     0.54   0.588     .7724045    1.577513
immunosupp~n |   1.017901    .094509     0.19   0.848      .848543     1.22106
  cancerHaem |   .9918555   .0392041    -0.21   0.836     .9179179    1.071749
  autoimmune |   1.105726   .1218271     0.91   0.362      .890971    1.372245
         ibd |    1.05599   .1198879     0.48   0.631     .8453211    1.319161
cancerExha~r |   .9296901   .6816387    -0.10   0.921     .2209258     3.91228
------------------------------------------------------------------------------
                                                         Stratified by stpcode

.         forvalues k = `lo_`exp'' (1) `hi_`exp'' {
  2.                 capture qui di _b[`k'.`exp']
  3.                 if _rc==0 {
  4.                         post `ldrresults' (`i') ("`out'") ("`exp'") ///
>                         ("Confounders+Comorb")                               
>            ///
>                         (`k') (1) (_b[`k'.`exp']) (_se[`k'.`exp'])
  5.                 }
  6.                                 forvalues l = 2 (1) 3 {
  7.                         capture qui di _b[`k'.`exp'#`l'.agebroad]
  8.                         if _rc==0 {
  9.                             lincom `k'.`exp' + `k'.`exp'#`l'.agebroad
 10.                                 post `ldrresults' (`i') ("`out'") ("`exp'"
> )             ///
>                                         ("Confounders+Comorb")               
>                            ///
>                                         (`k') (`l') (r(estimate)) (r(se))
 11.                         }
 12.                 }
 13.         }

 ( 1)  0b.ds + 0b.ds#2o.agebroad = 0

------------------------------------------------------------------------------
          _t |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
         (1) |          0  (omitted)
------------------------------------------------------------------------------

 ( 1)  0b.ds + 0b.ds#3o.agebroad = 0

------------------------------------------------------------------------------
          _t |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
         (1) |          0  (omitted)
------------------------------------------------------------------------------

 ( 1)  1.ds + 1.ds#2.agebroad = 0

------------------------------------------------------------------------------
          _t |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
         (1) |  -.5658246   .4129126    -1.37   0.171    -1.375119    .2434693
------------------------------------------------------------------------------

 ( 1)  1.ds + 1.ds#3.agebroad = 0

------------------------------------------------------------------------------
          _t |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
         (1) |   .3389578   .3127985     1.08   0.279     -.274116    .9520316
------------------------------------------------------------------------------

.         
.         * All variables
.         stcox i.`exp'##i.agebroad age1 age2 age3 male           ///
>                                 i.ethnicity_5 imd resid_care_ldr             
>    ///
>                                 obese40                                      
>                            ///
>                                 respiratory asthma_severe                    
>            ///
>                                 cardiac af dvt_pe i.diabcat                  
>            ///
>                                 liver stroke tia dementia                    
>            ///
>                                 i.kidneyfn                                   
>                            ///
>                                 spleen transplant dialysis                   
>            ///
>                                 immunosuppression cancerHaem                 
>    ///
>                                 autoimmune ibd cancerExhaem1yr,              
>    ///
>                                 strata(stpcode) cluster(household_id) 

         failure _d:  covidadmission2
   analysis time _t:  stime_covidadmission2/365.25

Iteration 0:   log pseudolikelihood =  -2445.012
Iteration 1:   log pseudolikelihood = -2427.8714
Iteration 2:   log pseudolikelihood = -2426.6157
Iteration 3:   log pseudolikelihood = -2426.2119
Iteration 4:   log pseudolikelihood = -2426.0638
Iteration 5:   log pseudolikelihood = -2426.0094
Iteration 6:   log pseudolikelihood = -2425.9893
Iteration 7:   log pseudolikelihood =  -2425.982
Iteration 8:   log pseudolikelihood = -2425.9793
Iteration 9:   log pseudolikelihood = -2425.9783
Iteration 10:  log pseudolikelihood = -2425.9779
Iteration 11:  log pseudolikelihood = -2425.9778
Iteration 12:  log pseudolikelihood = -2425.9777
Iteration 13:  log pseudolikelihood = -2425.9777
Iteration 14:  log pseudolikelihood = -2425.9777
Iteration 15:  log pseudolikelihood = -2425.9777
Iteration 16:  log pseudolikelihood = -2425.9777
Iteration 17:  log pseudolikelihood = -2425.9777
Iteration 18:  log pseudolikelihood = -2425.9777
Iteration 19:  log pseudolikelihood = -2425.9777
Iteration 20:  log pseudolikelihood = -2425.9777
Iteration 21:  log pseudolikelihood = -2425.9777
Iteration 22:  log pseudolikelihood = -2425.9777
Iteration 23:  log pseudolikelihood = -2425.9777
Iteration 24:  log pseudolikelihood = -2425.9777
Iteration 25:  log pseudolikelihood = -2425.9777
Iteration 26:  log pseudolikelihood = -2425.9777
Iteration 27:  log pseudolikelihood = -2425.9777
Iteration 28:  log pseudolikelihood = -2425.9777
Iteration 29:  log pseudolikelihood = -2425.9777
Iteration 30:  log pseudolikelihood = -2425.9777
Iteration 31:  log pseudolikelihood = -2425.9777
Refining estimates:
Iteration 0:   log pseudolikelihood = -2425.9777
Iteration 1:   log pseudolikelihood = -2425.9777
Iteration 2:   log pseudolikelihood = -2425.9777
Iteration 3:   log pseudolikelihood = -2425.9777
Iteration 4:   log pseudolikelihood = -2425.9777
Iteration 5:   log pseudolikelihood = -2425.9777
Iteration 6:   log pseudolikelihood = -2425.9777
Iteration 7:   log pseudolikelihood = -2425.9777

Stratified Cox regr. -- Breslow method for ties

No. of subjects      =        4,879             Number of obs    =       4,879
No. of failures      =          492
Time at risk         =  1962.721424
                                                Wald chi2(38)    =    51956.88
Log pseudolikelihood =   -2425.9777             Prob > chi2      =      0.0000

                         (Std. Err. adjusted for 938 clusters in household_id)
------------------------------------------------------------------------------
             |               Robust
          _t | Haz. Ratio   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
        1.ds |   .9797473   .1250084    -0.16   0.873     .7629694    1.258117
             |
    agebroad |
     65-<75  |   .8572339   .2315023    -0.57   0.568      .504924    1.455367
        75+  |   .8929314   .4099314    -0.25   0.805     .3631151    2.195796
             |
 ds#agebroad |
   1#65-<75  |   .5796727   .2487061    -1.27   0.204     .2500222    1.343963
      1#75+  |   1.443271   .4898824     1.08   0.280     .7420425    2.807159
             |
        age1 |   .9564456   .0264794    -1.61   0.108     .9059299    1.009778
        age2 |   1.105402   .0758326     1.46   0.144     .9663315    1.264486
        age3 |   .7975293   .1458956    -1.24   0.216     .5572275     1.14146
        male |   .9897836   .0906424    -0.11   0.911     .8271588    1.184382
             |
 ethnicity_5 |
      Mixed  |   1.095881   .1703338     0.59   0.556     .8080909    1.486163
Asian or ..  |   1.206228   .1839361     1.23   0.219     .8946044    1.626403
      Black  |   1.374689   .2019754     2.17   0.030     1.030724     1.83344
      Other  |   1.123987   .1677558     0.78   0.434     .8389166    1.505926
             |
         imd |   .9826045   .0396022    -0.44   0.663     .9079722    1.063371
resid_care~r |   1.208938   .3285435     0.70   0.485     .7097084    2.059342
     obese40 |   .9832609   .1097189    -0.15   0.880     .7901071    1.223634
 respiratory |   1.064059    .125051     0.53   0.597     .8451427     1.33968
asthma_sev~e |   .8459294   .1298142    -1.09   0.276     .6261968    1.142766
     cardiac |   .9099917   .1086868    -0.79   0.430     .7200661    1.150012
          af |   1.059447   .1169776     0.52   0.601     .8532867    1.315418
      dvt_pe |   1.149162   .1258408     1.27   0.204     .9271913    1.424274
             |
     diabcat |
Controlle..  |   .9337598   .1255614    -0.51   0.610     .7174229    1.215333
Uncontrol..  |   1.404159   .3140683     1.52   0.129     .9057909     2.17673
Diabetes,..  |   2.75e-17   1.63e-17   -64.42   0.000     8.61e-18    8.76e-17
             |
       liver |   .9457623   .1132926    -0.47   0.642     .7478541    1.196044
      stroke |   .9404009   .1123003    -0.51   0.607     .7441572    1.188397
         tia |   1.096504   .1257889     0.80   0.422     .8757131    1.372962
    dementia |   .9561709    .109069    -0.39   0.694     .7646104    1.195724
             |
    kidneyfn |
Stage 3a/..  |   2.82e-17   6.00e-18  -179.04   0.000     1.86e-17    4.28e-17
Stage 4/5..  |   .8035137   .1256031    -1.40   0.162     .5914741    1.091568
             |
      spleen |   .9243115   .0873018    -0.83   0.405     .7681072    1.112282
  transplant |    .975337   .1153977    -0.21   0.833     .7734713    1.229887
    dialysis |   1.100519   .2005654     0.53   0.599     .7699621     1.57299
immunosupp~n |   1.018362   .0946295     0.20   0.845     .8488004    1.221795
  cancerHaem |   .9919425    .039113    -0.21   0.837     .9181697    1.071643
  autoimmune |   1.107714   .1221073     0.93   0.353     .8924761     1.37486
         ibd |    1.05495   .1197041     0.47   0.637     .8445916    1.317701
cancerExha~r |   .9159543   .6715105    -0.12   0.905     .2176884    3.854006
------------------------------------------------------------------------------
                                                         Stratified by stpcode

.         forvalues k = `lo_`exp'' (1) `hi_`exp'' {
  2.                 capture qui di _b[`k'.`exp']
  3.                 if _rc==0 {
  4.                         post `ldrresults' (`i') ("`out'") ("`exp'")     //
> /
>                         ("All")                                              
>                                    ///
>                         (`k') (1) (_b[`k'.`exp']) (_se[`k'.`exp'])
  5.                 }
  6.                                 forvalues l = 2 (1) 3 {
  7.                         capture qui di _b[`k'.`exp'#`l'.agebroad]
  8.                         if _rc==0 {
  9.                             lincom `k'.`exp' + `k'.`exp'#`l'.agebroad
 10.                                 post `ldrresults' (`i') ("`out'") ("`exp'"
> )     ///
>                                         ("All")                              
>                                    ///
>                                         (`k') (`l') (r(estimate)) (r(se))
 11.                         }
 12.                 }
 13.         }

 ( 1)  0b.ds + 0b.ds#2o.agebroad = 0

------------------------------------------------------------------------------
          _t |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
         (1) |          0  (omitted)
------------------------------------------------------------------------------

 ( 1)  0b.ds + 0b.ds#3o.agebroad = 0

------------------------------------------------------------------------------
          _t |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
         (1) |          0  (omitted)
------------------------------------------------------------------------------

 ( 1)  1.ds + 1.ds#2.agebroad = 0

------------------------------------------------------------------------------
          _t |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
         (1) |  -.5657523   .4126175    -1.37   0.170    -1.374468    .2429631
------------------------------------------------------------------------------

 ( 1)  1.ds + 1.ds#3.agebroad = 0

------------------------------------------------------------------------------
          _t |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
         (1) |   .3464515    .312997     1.11   0.268    -.2670113    .9599143
------------------------------------------------------------------------------

. 
. postclose `ldrresults'

. 
. use `ldrfile', clear

. 
. 
. *************************
. *  Tidy output for HRs  *
. *************************
. 
. * Outcome
. rename outcome out

. gen outcome     = 1 if out=="coviddeath"
(30 missing values generated)

. replace outcome = 2 if out=="covidadmission"
(30 real changes made)

. replace outcome = 3 if out=="composite"
(0 real changes made)

. 
. label define outcome    1 "COVID-19 death"              ///
>                                                 2 "COVID-19 admission"  ///
>                                                 3 "Composite"

. label values outcome outcome

. drop out

. 
. * Exposure
. rename exposure exp

. gen     exposure = 1 if exp=="ldr"
(30 missing values generated)

. replace exposure = 2 if exp=="ldr_cat"
(0 real changes made)

. replace exposure = 3 if exp=="ldr_carecat"
(0 real changes made)

. replace exposure = 4 if exp=="ds"
(30 real changes made)

. replace exposure = 5 if exp=="cp"
(0 real changes made)

. replace exposure = 6 if exp=="ldr_group"
(0 real changes made)

. 
. label define exposure   1 "Learning disability register"        ///
>                                                 2 "LDR Severe vs mild"       
>                    ///
>                                                 3 "LDR by residential care"  
>                    ///
>                                                 4 "Down's syndrome"          
>                            ///
>                                                 5 "Cerebral Palsy"           
>                            ///
>                                                 6 "Combined grouping"        
>                    

. label values exposure exposure                                          

. drop exp

. 
. * Age categories
. label define agebroad   1 "16-<65"              ///
>                                                 2 "65-<75"              ///
>                                                 3 "75+"

. label values agebroad agebroad

. 
. 
. * Categories of exposure
. gen category     = "No"                                         if expcat==0
(15 missing values generated)

. replace category = "Yes"                                        if inlist(exp
> osure, 1, 4, 5) & expcat==1
variable category was str2 now str3
(15 real changes made)

. 
. replace category = "LDR, mild"                          if inlist(exposure, 2
> ) & expcat==1
(0 real changes made)

. replace category = "LDR, profound"                      if inlist(exposure, 2
> ) & expcat==2
(0 real changes made)

. 
. replace category = "LDR, community"             if inlist(exposure, 3) & expc
> at==1
(0 real changes made)

. replace category = "LDR, residential care"      if inlist(exposure, 3) & expc
> at==2
(0 real changes made)

. 
. replace category = "DS but not LDR"             if inlist(exposure, 6) & expc
> at==1
(0 real changes made)

. replace category = "DS and LDR"                         if inlist(exposure, 6
> ) & expcat==2
(0 real changes made)

. replace category = "CP but not LDR"             if inlist(exposure, 6) & expc
> at==3
(0 real changes made)

. replace category = "CP and LDR"                         if inlist(exposure, 6
> ) & expcat==4
(0 real changes made)

. replace category = "LDR with no DS or CP"       if inlist(exposure, 6) & expc
> at==5
(0 real changes made)

. 
. * Model adjustment
. gen     adjustment = 1 if model=="Confounders"
(24 missing values generated)

. replace adjustment = 2 if model=="Confounders+IMD"
(6 real changes made)

. replace adjustment = 3 if model=="Confounders+Resid"
(6 real changes made)

. replace adjustment = 4 if model=="Confounders+Comorb"
(6 real changes made)

. replace adjustment = 5 if model=="All"
(6 real changes made)

. label define adj        1 "Confounders"                                      
>    ///     
>                                         2 "Confounders with IMD"             
>            ///
>                                         3 "Confounders with care"            
>            ///
>                                         4 "Confounders with comorbidities"   
>    ///
>                                         5 "All"

. label values adjustment adj

. drop model

. 
. * Hazard ratio with 95% confidence interval
. gen cl = exp(lnhr - invnorm(0.975)*sehr)

. gen cu = exp(lnhr + invnorm(0.975)*sehr)

. gen hr = exp(lnhr)

. 
. gen hr_ci =   string(round(hr, 0.01)) + " (" ///
>                         + string(round(cl, 0.01)) + ", " ///
>                         + string(round(cu, 0.01)) + ")"

. replace hr_ci = "" if expcat==0
(15 real changes made)

. drop cl cu hr lnhr sehr

. 
. * Put in wide format
. reshape wide hr_ci, i(wave outcome exposure expcat agebroad) j(adjust)
(note: j = 1 2 3 4 5)

Data                               long   ->   wide
-----------------------------------------------------------------------------
Number of obs.                       30   ->       6
Number of variables                   8   ->      11
j variable (5 values)        adjustment   ->   (dropped)
xij variables:
                                  hr_ci   ->   hr_ci1 hr_ci2 ... hr_ci5
-----------------------------------------------------------------------------

. rename hr_ci1 hr_conf

. rename hr_ci2 hr_conf_imd

. rename hr_ci3 hr_conf_resid

. rename hr_ci4 hr_conf_comorb

. 
. 
. order wave outcome exposure agebroad category hr*

. sort wave outcome exposure agebroad expcat

. 
. * Save data
. outsheet using "output/ldcox_inter_wave`i'_`out'_`exp'", replace
(note: file output/ldcox_inter_wave2_covidadmission_ds.out not found)

. 
. log close
      name:  <unnamed>
       log:  /workspace/logs/AL006_cox_regression_inter_wave2_covidadmission_ds
> .log
  log type:  text
 closed on:  25 Feb 2021, 20:12:22
-------------------------------------------------------------------------------
