-------------------------------------------------------------------------------
      name:  <unnamed>
       log:  /workspace/logs/AL006_cox_regression_inter_wave2_covidadmission_ld
> r_cat.log
  log type:  text
 opened on:  25 Feb 2021, 20:09:31

. 
. 
. * Categories of various exposures
. local lo_ldr            = 0

. local hi_ldr            = 1

. local lo_ldr_cat        = 0

. local hi_ldr_cat        = 2

. local hi_ldr            = 1

. local lo_ldr_carecat= 0

. local hi_ldr_carecat= 2

. local lo_ds             = 0

. local hi_ds             = 1

. local lo_cp             = 0

. local hi_cp             = 1

. local lo_ldr_group      = 0

. local hi_ldr_group      = 5

. 
. * Open temporary file to post results
. tempfile ldrfile

. tempname ldrresults

. 
. postfile `ldrresults'   wave str15(outcome) str15(exposure) str20(model)     
>    ///
>                                                 expcat agebroad lnhr sehr usi
> ng `ldrfile'

. 
. 
.         * Open dataset (complete case ethnicity)
.         use "analysis/data_ldanalysis_cohort`i'.dta", clear 
(Analysis dataset, wave 2 (1 Sept 20 - latest), for learning disability work)

.         drop if ethnicity_5>=.
(11,245 observations deleted)

. 
.         * Only keep data for adults
.         keep if child==0
(6,499 observations deleted)

. 
.         
.         /*  Declare data to be survival  */
. 
.         stset stime_`out'`i', fail(`out'`i') scale(365.25)

     failure event:  covidadmission2 != 0 & covidadmission2 < .
obs. time interval:  (0, stime_covidadmission2]
 exit on or before:  failure
    t for analysis:  time/365.25

------------------------------------------------------------------------------
     27,126  total observations
      2,767  observations end on or before enter()
------------------------------------------------------------------------------
     24,359  observations remaining, representing
      2,360  failures in single-record/single-failure data
  9,788.172  total analysis time at risk and under observation
                                                at risk from t =         0
                                     earliest observed entry t =         0
                                          last observed exit t =  .4462697

. 
.         
.                 
.         /*  Fit Cox models  */
.         
.         * Confounder only model
.         stcox i.`exp'##i.agebroad age1 age2 age3 male i.ethnicity_5,    ///
>                 strata(stpcode) cluster(household_id) 

         failure _d:  covidadmission2
   analysis time _t:  stime_covidadmission2/365.25

Iteration 0:   log pseudolikelihood = -15518.831
Iteration 1:   log pseudolikelihood =  -15509.06
Iteration 2:   log pseudolikelihood = -15508.999
Iteration 3:   log pseudolikelihood = -15508.999
Refining estimates:
Iteration 0:   log pseudolikelihood = -15508.999

Stratified Cox regr. -- Breslow method for ties

No. of subjects      =       24,359             Number of obs    =      24,359
No. of failures      =        2,360
Time at risk         =  9788.172485
                                                Wald chi2(16)    =       20.09
Log pseudolikelihood =   -15508.999             Prob > chi2      =      0.2162

                       (Std. Err. adjusted for 1,195 clusters in household_id)
------------------------------------------------------------------------------
             |               Robust
          _t | Haz. Ratio   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
     ldr_cat |
  LDR, mild  |   1.009439   .0488565     0.19   0.846     .9180834    1.109885
LDR, prof..  |   .9952805     .08926    -0.05   0.958     .8348472    1.186544
             |
    agebroad |
     65-<75  |    .831663   .1052237    -1.46   0.145     .6490103     1.06572
        75+  |   .9415645   .1955412    -0.29   0.772     .6267223    1.414572
             |
     ldr_cat#|
    agebroad |
  LDR, mild #|
     65-<75  |    .961685   .1438028    -0.26   0.794     .7173826    1.289184
  LDR, mild #|
        75+  |   .9368737   .1419039    -0.43   0.667     .6962313    1.260691
LDR, prof.. #|
     65-<75  |   1.094064   .2883019     0.34   0.733     .6527378    1.833778
LDR, prof.. #|
        75+  |   1.326084    .300345     1.25   0.213     .8507115    2.067092
             |
        age1 |   1.001295   .0129683     0.10   0.920     .9761971    1.027037
        age2 |   .9967135   .0313866    -0.10   0.917     .9370569    1.060168
        age3 |    1.01405   .0838798     0.17   0.866     .8622832    1.192528
        male |   1.076676   .0423606     1.88   0.060     .9967712    1.162986
             |
 ethnicity_5 |
      Mixed  |   1.040642   .0693297     0.60   0.550     .9132559    1.185796
Asian or ..  |   1.043651   .0717005     0.62   0.534     .9121713    1.194082
      Black  |   1.162585   .0769423     2.28   0.023     1.021152    1.323607
      Other  |   .9821811   .0670852    -0.26   0.792     .8591176    1.122873
------------------------------------------------------------------------------
                                                         Stratified by stpcode

.         forvalues k = `lo_`exp'' (1) `hi_`exp'' {
  2.                 capture qui di _b[`k'.`exp']
  3.                 if _rc==0 {
  4.                         post `ldrresults' (`i') ("`out'") ("`exp'")       
>       ///
>                                 ("Confounders")                              
>                            ///
>                                 (`k') (1) (_b[`k'.`exp']) (_se[`k'.`exp'])
  5.                 }
  6.                 forvalues l = 2 (1) 3 {
  7.                         capture qui di _b[`k'.`exp'#`l'.agebroad]
  8.                         if _rc==0 {
  9.                             lincom `k'.`exp' + `k'.`exp'#`l'.agebroad
 10.                                 post `ldrresults' (`i') ("`out'") ("`exp'"
> )             ///
>                                         ("Confounders")                      
>                                    ///
>                                         (`k') (`l') (r(estimate)) (r(se))
 11.                         }
 12.                 }
 13.         }

 ( 1)  0b.ldr_cat + 0b.ldr_cat#2o.agebroad = 0

------------------------------------------------------------------------------
          _t |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
         (1) |          0  (omitted)
------------------------------------------------------------------------------

 ( 1)  0b.ldr_cat + 0b.ldr_cat#3o.agebroad = 0

------------------------------------------------------------------------------
          _t |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
         (1) |          0  (omitted)
------------------------------------------------------------------------------

 ( 1)  1.ldr_cat + 1.ldr_cat#2.agebroad = 0

------------------------------------------------------------------------------
          _t |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
         (1) |  -.0296738   .1378993    -0.22   0.830    -.2999514    .2406039
------------------------------------------------------------------------------

 ( 1)  1.ldr_cat + 1.ldr_cat#3.agebroad = 0

------------------------------------------------------------------------------
          _t |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
         (1) |  -.0558122   .1424294    -0.39   0.695    -.3349688    .2233443
------------------------------------------------------------------------------

 ( 1)  2.ldr_cat + 2.ldr_cat#2.agebroad = 0

------------------------------------------------------------------------------
          _t |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
         (1) |   .0851686   .2438906     0.35   0.727    -.3928482    .5631854
------------------------------------------------------------------------------

 ( 1)  2.ldr_cat + 2.ldr_cat#3.agebroad = 0

------------------------------------------------------------------------------
          _t |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
         (1) |   .2774996   .2094697     1.32   0.185    -.1330535    .6880527
------------------------------------------------------------------------------

.         
.         * Confounders with deprivation
.         stcox i.`exp'##i.agebroad age1 age2 age3 male i.ethnicity_5 imd, ///
>                 strata(stpcode) cluster(household_id) 

         failure _d:  covidadmission2
   analysis time _t:  stime_covidadmission2/365.25

Iteration 0:   log pseudolikelihood = -15518.831
Iteration 1:   log pseudolikelihood = -15509.051
Iteration 2:   log pseudolikelihood =  -15508.99
Iteration 3:   log pseudolikelihood =  -15508.99
Refining estimates:
Iteration 0:   log pseudolikelihood =  -15508.99

Stratified Cox regr. -- Breslow method for ties

No. of subjects      =       24,359             Number of obs    =      24,359
No. of failures      =        2,360
Time at risk         =  9788.172485
                                                Wald chi2(17)    =       20.11
Log pseudolikelihood =    -15508.99             Prob > chi2      =      0.2687

                       (Std. Err. adjusted for 1,195 clusters in household_id)
------------------------------------------------------------------------------
             |               Robust
          _t | Haz. Ratio   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
     ldr_cat |
  LDR, mild  |   1.009427   .0488536     0.19   0.846     .9180767    1.109867
LDR, prof..  |    .995387   .0893004    -0.05   0.959     .8348857    1.186744
             |
    agebroad |
     65-<75  |   .8316196   .1052138    -1.46   0.145     .6489833    1.065653
        75+  |   .9417794   .1955381    -0.29   0.773     .6269276    1.414754
             |
     ldr_cat#|
    agebroad |
  LDR, mild #|
     65-<75  |   .9616094   .1437917    -0.26   0.793      .717326    1.289083
  LDR, mild #|
        75+  |   .9365297    .141755    -0.43   0.665     .6961166    1.259973
LDR, prof.. #|
     65-<75  |    1.09356   .2881308     0.34   0.734     .6524814    1.832808
LDR, prof.. #|
        75+  |   1.326113   .3003803     1.25   0.213     .8506942    2.067225
             |
        age1 |    1.00129   .0129675     0.10   0.921     .9761944    1.027032
        age2 |    .996725   .0313846    -0.10   0.917     .9370719    1.060176
        age3 |   1.014018   .0838714     0.17   0.866     .8622653    1.192477
        male |   1.076656   .0423506     1.88   0.060     .9967689    1.162945
             |
 ethnicity_5 |
      Mixed  |   1.040652   .0693266     0.60   0.550     .9132713    1.185799
Asian or ..  |   1.043655   .0717007     0.62   0.534     .9121753    1.194087
      Black  |   1.162484   .0768853     2.28   0.023      1.02115     1.32338
      Other  |   .9820884   .0670513    -0.26   0.791     .8590836    1.122705
             |
         imd |   .9977142   .0172618    -0.13   0.895     .9644489    1.032127
------------------------------------------------------------------------------
                                                         Stratified by stpcode

.         forvalues k = `lo_`exp'' (1) `hi_`exp'' {
  2.                 capture qui di _b[`k'.`exp']
  3.                 if _rc==0 {
  4.                         post `ldrresults' (`i') ("`out'") ("`exp'")     //
> /
>                                 ("Confounders+IMD")                          
>                    ///
>                                 (`k') (1) (_b[`k'.`exp']) (_se[`k'.`exp'])
  5.                 }       
  6.                 forvalues l = 2 (1) 3 {
  7.                         capture qui di _b[`k'.`exp'#`l'.agebroad]
  8.                         if _rc==0 {
  9.                             lincom `k'.`exp' + `k'.`exp'#`l'.agebroad
 10.                                 post `ldrresults' (`i') ("`out'") ("`exp'"
> )             ///
>                                         ("Confounders+IMD")                  
>                            ///
>                                         (`k') (`l') (r(estimate)) (r(se))
 11.                         }
 12.                 }
 13.         }

 ( 1)  0b.ldr_cat + 0b.ldr_cat#2o.agebroad = 0

------------------------------------------------------------------------------
          _t |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
         (1) |          0  (omitted)
------------------------------------------------------------------------------

 ( 1)  0b.ldr_cat + 0b.ldr_cat#3o.agebroad = 0

------------------------------------------------------------------------------
          _t |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
         (1) |          0  (omitted)
------------------------------------------------------------------------------

 ( 1)  1.ldr_cat + 1.ldr_cat#2.agebroad = 0

------------------------------------------------------------------------------
          _t |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
         (1) |  -.0297642   .1378989    -0.22   0.829    -.3000411    .2405128
------------------------------------------------------------------------------

 ( 1)  1.ldr_cat + 1.ldr_cat#3.agebroad = 0

------------------------------------------------------------------------------
          _t |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
         (1) |  -.0561913   .1422942    -0.39   0.693    -.3350827    .2227002
------------------------------------------------------------------------------

 ( 1)  2.ldr_cat + 2.ldr_cat#2.agebroad = 0

------------------------------------------------------------------------------
          _t |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
         (1) |   .0848146   .2438314     0.35   0.728    -.3930862    .5627153
------------------------------------------------------------------------------

 ( 1)  2.ldr_cat + 2.ldr_cat#3.agebroad = 0

------------------------------------------------------------------------------
          _t |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
         (1) |   .2776287   .2095705     1.32   0.185    -.1331218    .6883792
------------------------------------------------------------------------------

.         
.         * Confounders with residential care
.         stcox i.`exp'##i.agebroad age1 age2 age3 male   ///
>                                 i.ethnicity_5 resid_care_ldr,           ///
>                 strata(stpcode) cluster(household_id) 

         failure _d:  covidadmission2
   analysis time _t:  stime_covidadmission2/365.25

Iteration 0:   log pseudolikelihood = -15518.831
Iteration 1:   log pseudolikelihood = -15508.547
Iteration 2:   log pseudolikelihood = -15508.486
Iteration 3:   log pseudolikelihood = -15508.486
Refining estimates:
Iteration 0:   log pseudolikelihood = -15508.486

Stratified Cox regr. -- Breslow method for ties

No. of subjects      =       24,359             Number of obs    =      24,359
No. of failures      =        2,360
Time at risk         =  9788.172485
                                                Wald chi2(17)    =       20.95
Log pseudolikelihood =   -15508.486             Prob > chi2      =      0.2287

                       (Std. Err. adjusted for 1,195 clusters in household_id)
------------------------------------------------------------------------------
             |               Robust
          _t | Haz. Ratio   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
     ldr_cat |
  LDR, mild  |   1.007934   .0487964     0.16   0.870     .9166926    1.108258
LDR, prof..  |   .9939453   .0891464    -0.07   0.946      .833717    1.184967
             |
    agebroad |
     65-<75  |   .8309376    .105125    -1.46   0.143     .6484549    1.064773
        75+  |   .9383349   .1948654    -0.31   0.759     .6245793    1.409705
             |
     ldr_cat#|
    agebroad |
  LDR, mild #|
     65-<75  |   .9603986   .1436698    -0.27   0.787     .7163362    1.287615
  LDR, mild #|
        75+  |   .9386819   .1421734    -0.42   0.676     .6975814    1.263112
LDR, prof.. #|
     65-<75  |   1.095425   .2887126     0.35   0.729     .6534892    1.836231
LDR, prof.. #|
        75+  |   1.329768   .3010765     1.26   0.208     .8532038     2.07252
             |
        age1 |   1.001433   .0129732     0.11   0.912     .9763257    1.027185
        age2 |   .9963429   .0313843    -0.12   0.907     .9366912    1.059793
        age3 |   1.015127   .0839951     0.18   0.856     .8631552    1.193855
        male |    1.07629   .0423522     1.87   0.062     .9964018    1.162584
             |
 ethnicity_5 |
      Mixed  |   1.040825   .0693271     0.60   0.548     .9134419    1.185972
Asian or ..  |   1.043752   .0717104     0.62   0.533     .9122541    1.194204
      Black  |   1.162696   .0769489     2.28   0.023     1.021251    1.323732
      Other  |   .9826711    .067106    -0.26   0.798     .8595679    1.123405
             |
resid_care~r |   1.113248   .1216922     0.98   0.326     .8985551    1.379238
------------------------------------------------------------------------------
                                                         Stratified by stpcode

.         forvalues k = `lo_`exp'' (1) `hi_`exp'' {
  2.                 capture qui di _b[`k'.`exp']
  3.                 if _rc==0 {
  4.                         post `ldrresults' (`i') ("`out'") ("`exp'")     //
> /
>                                 ("Confounders+Resid")                        
>                    ///
>                                 (`k') (1) (_b[`k'.`exp']) (_se[`k'.`exp'])
  5.                 }               
  6.                 forvalues l = 2 (1) 3 {
  7.                         capture qui di _b[`k'.`exp'#`l'.agebroad]
  8.                         if _rc==0 {
  9.                             lincom `k'.`exp' + `k'.`exp'#`l'.agebroad
 10.                                 post `ldrresults' (`i') ("`out'") ("`exp'"
> )             ///
>                                         ("Confounders+Resid")                
>                            ///
>                                         (`k') (`l') (r(estimate)) (r(se))
 11.                         }
 12.                 }
 13.         }

 ( 1)  0b.ldr_cat + 0b.ldr_cat#2o.agebroad = 0

------------------------------------------------------------------------------
          _t |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
         (1) |          0  (omitted)
------------------------------------------------------------------------------

 ( 1)  0b.ldr_cat + 0b.ldr_cat#3o.agebroad = 0

------------------------------------------------------------------------------
          _t |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
         (1) |          0  (omitted)
------------------------------------------------------------------------------

 ( 1)  1.ldr_cat + 1.ldr_cat#2.agebroad = 0

------------------------------------------------------------------------------
          _t |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
         (1) |  -.0325038   .1380493    -0.24   0.814    -.3030754    .2380678
------------------------------------------------------------------------------

 ( 1)  1.ldr_cat + 1.ldr_cat#3.agebroad = 0

------------------------------------------------------------------------------
          _t |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
         (1) |  -.0553755   .1424114    -0.39   0.697    -.3344967    .2237457
------------------------------------------------------------------------------

 ( 1)  2.ldr_cat + 2.ldr_cat#2.agebroad = 0

------------------------------------------------------------------------------
          _t |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
         (1) |   .0850697   .2439628     0.35   0.727    -.3930886     .563228
------------------------------------------------------------------------------

 ( 1)  2.ldr_cat + 2.ldr_cat#3.agebroad = 0

------------------------------------------------------------------------------
          _t |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
         (1) |   .2789311   .2094055     1.33   0.183    -.1314962    .6893584
------------------------------------------------------------------------------

.         
.         * Confounders with physical comorbidities that are indicators for vac
> cination 
.         stcox i.`exp'##i.agebroad age1 age2 age3 male           ///
>                                 i.ethnicity_5                                
>                    ///
>                                 obese40                                      
>                            ///
>                                 respiratory asthma_severe                    
>            ///
>                                 cardiac af dvt_pe i.diabcat                  
>            ///
>                                 liver stroke tia dementia                    
>            ///
>                                 i.kidneyfn                                   
>                            ///
>                                 spleen transplant dialysis                   
>            ///
>                                 immunosuppression cancerHaem                 
>    ///
>                                 autoimmune ibd cancerExhaem1yr,              
>    ///
>                 strata(stpcode) cluster(household_id) 

         failure _d:  covidadmission2
   analysis time _t:  stime_covidadmission2/365.25

Iteration 0:   log pseudolikelihood =  -2445.012
Iteration 1:   log pseudolikelihood = -2426.4546
Iteration 2:   log pseudolikelihood =  -2424.545
Iteration 3:   log pseudolikelihood = -2424.1073
Iteration 4:   log pseudolikelihood = -2423.9534
Iteration 5:   log pseudolikelihood = -2423.8968
Iteration 6:   log pseudolikelihood =  -2423.876
Iteration 7:   log pseudolikelihood = -2423.8684
Iteration 8:   log pseudolikelihood = -2423.8656
Iteration 9:   log pseudolikelihood = -2423.8645
Iteration 10:  log pseudolikelihood = -2423.8642
Iteration 11:  log pseudolikelihood =  -2423.864
Iteration 12:  log pseudolikelihood =  -2423.864
Iteration 13:  log pseudolikelihood =  -2423.864
Iteration 14:  log pseudolikelihood = -2423.8639
Iteration 15:  log pseudolikelihood = -2423.8639
Iteration 16:  log pseudolikelihood = -2423.8639
Iteration 17:  log pseudolikelihood = -2423.8639
Iteration 18:  log pseudolikelihood = -2423.8639
Iteration 19:  log pseudolikelihood = -2423.8639
Iteration 20:  log pseudolikelihood = -2423.8639
Iteration 21:  log pseudolikelihood = -2423.8639
Iteration 22:  log pseudolikelihood = -2423.8639
Iteration 23:  log pseudolikelihood = -2423.8639
Iteration 24:  log pseudolikelihood = -2423.8639
Iteration 25:  log pseudolikelihood = -2423.8639
Iteration 26:  log pseudolikelihood = -2423.8639
Iteration 27:  log pseudolikelihood = -2423.8639
Iteration 28:  log pseudolikelihood = -2423.8639
Iteration 29:  log pseudolikelihood = -2423.8639
Iteration 30:  log pseudolikelihood = -2423.8639
Iteration 31:  log pseudolikelihood = -2423.8639
Refining estimates:
Iteration 0:   log pseudolikelihood = -2423.8639
Iteration 1:   log pseudolikelihood = -2423.8639

Stratified Cox regr. -- Breslow method for ties

No. of subjects      =        4,879             Number of obs    =       4,879
No. of failures      =          492
Time at risk         =  1962.721424
                                                Wald chi2(39)    =    36227.49
Log pseudolikelihood =   -2423.8639             Prob > chi2      =      0.0000

                         (Std. Err. adjusted for 938 clusters in household_id)
------------------------------------------------------------------------------
             |               Robust
          _t | Haz. Ratio   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
     ldr_cat |
  LDR, mild  |    .989903    .109474    -0.09   0.927      .796999    1.229497
LDR, prof..  |   .7268558   .1603805    -1.45   0.148      .471662    1.120123
             |
    agebroad |
     65-<75  |   .8143801   .2360504    -0.71   0.479      .461428     1.43731
        75+  |   .7714082   .3666098    -0.55   0.585     .3039155    1.958013
             |
     ldr_cat#|
    agebroad |
  LDR, mild #|
     65-<75  |   .7788679   .2613156    -0.74   0.456     .4035336    1.503308
  LDR, mild #|
        75+  |   1.466877   .4580639     1.23   0.220     .7954042    2.705202
LDR, prof.. #|
     65-<75  |    1.75954   .9166696     1.08   0.278     .6337937    4.884843
LDR, prof.. #|
        75+  |   3.485616   1.540355     2.83   0.005     1.465948    8.287824
             |
        age1 |    .956473   .0265016    -1.61   0.108     .9059161    1.009851
        age2 |   1.105919   .0760909     1.46   0.143     .9664025    1.265578
        age3 |   .7952657    .146221    -1.25   0.213     .5546342    1.140297
        male |    .993937   .0911039    -0.07   0.947      .830497    1.189542
             |
 ethnicity_5 |
      Mixed  |   1.093647   .1701452     0.58   0.565     .8062144    1.483555
Asian or ..  |   1.197034   .1826687     1.18   0.239     .8875891    1.614361
      Black  |   1.363074   .2011512     2.10   0.036     1.020719    1.820257
      Other  |   1.124423   .1676186     0.79   0.431     .8395384    1.505979
             |
     obese40 |   .9654537    .108195    -0.31   0.754     .7750689    1.202604
 respiratory |   1.064398   .1252093     0.53   0.596     .8452278    1.340399
asthma_sev~e |   .8516098   .1310689    -1.04   0.297     .6298463    1.151454
     cardiac |   .9060016   .1080549    -0.83   0.408     .7171498    1.144585
          af |   1.053749   .1170394     0.47   0.637     .8476074    1.310026
      dvt_pe |   1.145824   .1251688     1.25   0.213     .9249827    1.419393
             |
     diabcat |
Controlle..  |   .9362672   .1256828    -0.49   0.624     .7196745    1.218046
Uncontrol..  |   1.426595   .3192023     1.59   0.112     .9201175    2.211862
Diabetes,..  |   1.19e-14   7.02e-15   -54.42   0.000     3.75e-15    3.78e-14
             |
       liver |   .9537604    .114882    -0.39   0.694     .7532006    1.207725
      stroke |   .9409959   .1123859    -0.51   0.611     .7446055    1.189184
         tia |   1.096704   .1251717     0.81   0.419     .8768754    1.371642
    dementia |   .9524278    .108802    -0.43   0.670     .7613666    1.191435
             |
    kidneyfn |
Stage 3a/..  |   1.23e-14   2.62e-15  -149.52   0.000     8.05e-15    1.86e-14
Stage 4/5..  |   .8047194   .1263659    -1.38   0.166     .5915336    1.094736
             |
      spleen |   .9226217   .0873582    -0.85   0.395     .7663513    1.110758
  transplant |   .9705951   .1146718    -0.25   0.801     .7699671      1.2235
    dialysis |   1.101065   .2008309     0.53   0.598     .7701164    1.574235
immunosupp~n |    1.00946   .0935226     0.10   0.919     .8418382    1.210458
  cancerHaem |   .9923567   .0391257    -0.19   0.846     .9185597    1.072083
  autoimmune |   1.107531   .1218652     0.93   0.353     .8926791    1.374093
         ibd |   1.056996   .1205855     0.49   0.627     .8452116    1.321847
cancerExha~r |   .9648969   .6955278    -0.05   0.960     .2349136    3.963269
------------------------------------------------------------------------------
                                                         Stratified by stpcode

.         forvalues k = `lo_`exp'' (1) `hi_`exp'' {
  2.                 capture qui di _b[`k'.`exp']
  3.                 if _rc==0 {
  4.                         post `ldrresults' (`i') ("`out'") ("`exp'") ///
>                         ("Confounders+Comorb")                               
>            ///
>                         (`k') (1) (_b[`k'.`exp']) (_se[`k'.`exp'])
  5.                 }
  6.                                 forvalues l = 2 (1) 3 {
  7.                         capture qui di _b[`k'.`exp'#`l'.agebroad]
  8.                         if _rc==0 {
  9.                             lincom `k'.`exp' + `k'.`exp'#`l'.agebroad
 10.                                 post `ldrresults' (`i') ("`out'") ("`exp'"
> )             ///
>                                         ("Confounders+Comorb")               
>                            ///
>                                         (`k') (`l') (r(estimate)) (r(se))
 11.                         }
 12.                 }
 13.         }

 ( 1)  0b.ldr_cat + 0b.ldr_cat#2o.agebroad = 0

------------------------------------------------------------------------------
          _t |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
         (1) |          0  (omitted)
------------------------------------------------------------------------------

 ( 1)  0b.ldr_cat + 0b.ldr_cat#3o.agebroad = 0

------------------------------------------------------------------------------
          _t |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
         (1) |          0  (omitted)
------------------------------------------------------------------------------

 ( 1)  1.ldr_cat + 1.ldr_cat#2.agebroad = 0

------------------------------------------------------------------------------
          _t |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
         (1) |  -.2600622   .3166277    -0.82   0.411    -.8806411    .3605167
------------------------------------------------------------------------------

 ( 1)  1.ldr_cat + 1.ldr_cat#3.agebroad = 0

------------------------------------------------------------------------------
          _t |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
         (1) |   .3729876   .2866012     1.30   0.193    -.1887404    .9347156
------------------------------------------------------------------------------

 ( 1)  2.ldr_cat + 2.ldr_cat#2.agebroad = 0

------------------------------------------------------------------------------
          _t |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
         (1) |   .2460256   .4767559     0.52   0.606    -.6883988     1.18045
------------------------------------------------------------------------------

 ( 1)  2.ldr_cat + 2.ldr_cat#3.agebroad = 0

------------------------------------------------------------------------------
          _t |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
         (1) |   .9296177   .3983366     2.33   0.020     .1488923    1.710343
------------------------------------------------------------------------------

.         
.         * All variables
.         stcox i.`exp'##i.agebroad age1 age2 age3 male           ///
>                                 i.ethnicity_5 imd resid_care_ldr             
>    ///
>                                 obese40                                      
>                            ///
>                                 respiratory asthma_severe                    
>            ///
>                                 cardiac af dvt_pe i.diabcat                  
>            ///
>                                 liver stroke tia dementia                    
>            ///
>                                 i.kidneyfn                                   
>                            ///
>                                 spleen transplant dialysis                   
>            ///
>                                 immunosuppression cancerHaem                 
>    ///
>                                 autoimmune ibd cancerExhaem1yr,              
>    ///
>                                 strata(stpcode) cluster(household_id) 

         failure _d:  covidadmission2
   analysis time _t:  stime_covidadmission2/365.25

Iteration 0:   log pseudolikelihood =  -2445.012
Iteration 1:   log pseudolikelihood = -2426.0342
Iteration 2:   log pseudolikelihood = -2424.1237
Iteration 3:   log pseudolikelihood =  -2423.686
Iteration 4:   log pseudolikelihood = -2423.5321
Iteration 5:   log pseudolikelihood = -2423.4756
Iteration 6:   log pseudolikelihood = -2423.4547
Iteration 7:   log pseudolikelihood = -2423.4471
Iteration 8:   log pseudolikelihood = -2423.4443
Iteration 9:   log pseudolikelihood = -2423.4432
Iteration 10:  log pseudolikelihood = -2423.4429
Iteration 11:  log pseudolikelihood = -2423.4427
Iteration 12:  log pseudolikelihood = -2423.4427
Iteration 13:  log pseudolikelihood = -2423.4427
Iteration 14:  log pseudolikelihood = -2423.4426
Iteration 15:  log pseudolikelihood = -2423.4426
Iteration 16:  log pseudolikelihood = -2423.4426
Iteration 17:  log pseudolikelihood = -2423.4426
Iteration 18:  log pseudolikelihood = -2423.4426
Iteration 19:  log pseudolikelihood = -2423.4426
Iteration 20:  log pseudolikelihood = -2423.4426
Iteration 21:  log pseudolikelihood = -2423.4426
Iteration 22:  log pseudolikelihood = -2423.4426
Iteration 23:  log pseudolikelihood = -2423.4426
Iteration 24:  log pseudolikelihood = -2423.4426
Iteration 25:  log pseudolikelihood = -2423.4426
Iteration 26:  log pseudolikelihood = -2423.4426
Iteration 27:  log pseudolikelihood = -2423.4426
Iteration 28:  log pseudolikelihood = -2423.4426
Iteration 29:  log pseudolikelihood = -2423.4426
Iteration 30:  log pseudolikelihood = -2423.4426
Iteration 31:  log pseudolikelihood = -2423.4426
Iteration 32:  log pseudolikelihood = -2423.4426
Refining estimates:
Iteration 0:   log pseudolikelihood = -2423.4426
Iteration 1:   log pseudolikelihood = -2423.4426
Iteration 2:   log pseudolikelihood = -2423.4426

Stratified Cox regr. -- Breslow method for ties

No. of subjects      =        4,879             Number of obs    =       4,879
No. of failures      =          492
Time at risk         =  1962.721424
                                                Wald chi2(41)    =    40678.22
Log pseudolikelihood =   -2423.4426             Prob > chi2      =      0.0000

                         (Std. Err. adjusted for 938 clusters in household_id)
------------------------------------------------------------------------------
             |               Robust
          _t | Haz. Ratio   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
     ldr_cat |
  LDR, mild  |   .9886792   .1093524    -0.10   0.918     .7959919    1.228011
LDR, prof..  |   .7267487   .1604043    -1.45   0.148     .4715322    1.120101
             |
    agebroad |
     65-<75  |   .8136858   .2358457    -0.71   0.477     .4610384    1.436072
        75+  |   .7679844   .3651557    -0.56   0.579      .302433    1.950184
             |
     ldr_cat#|
    agebroad |
  LDR, mild #|
     65-<75  |    .774298     .25976    -0.76   0.446     .4011887    1.494402
  LDR, mild #|
        75+  |   1.456848   .4552659     1.20   0.229     .7896113    2.687913
LDR, prof.. #|
     65-<75  |   1.769963   .9194895     1.10   0.272     .6393936    4.899597
LDR, prof.. #|
        75+  |    3.49273   1.544486     2.83   0.005     1.468127    8.309338
             |
        age1 |   .9565935     .02653    -1.60   0.110     .9059837     1.01003
        age2 |   1.105295   .0761515     1.45   0.146     .9656796    1.265096
        age3 |   .7968535   .1467937    -1.23   0.218     .5553579    1.143363
        male |    .992346   .0909906    -0.08   0.933     .8291142    1.187714
             |
 ethnicity_5 |
      Mixed  |   1.091822    .169987     0.56   0.573     .8046879    1.481414
Asian or ..  |   1.195145   .1822739     1.17   0.242     .8863436    1.611532
      Black  |   1.361869   .2007899     2.09   0.036     1.020086    1.818168
      Other  |   1.124026   .1676444     0.78   0.433     .8391172     1.50567
             |
         imd |   .9809623   .0394463    -0.48   0.633     .9066173    1.061404
resid_care~r |    1.19863   .3249404     0.67   0.504     .7045799    2.039107
     obese40 |   .9680045   .1083775    -0.29   0.771     .7772792    1.205529
 respiratory |   1.065224   .1253681     0.54   0.591      .845788    1.341592
asthma_sev~e |   .8529422   .1313162    -1.03   0.302     .6307705    1.153368
     cardiac |   .9082495   .1086121    -0.80   0.421     .7184808    1.148141
          af |   1.052665   .1166595     0.46   0.643     .8471441    1.308045
      dvt_pe |   1.146395   .1252666     1.25   0.211     .9253868    1.420185
             |
     diabcat |
Controlle..  |   .9358393   .1257112    -0.49   0.622     .7192162    1.217708
Uncontrol..  |   1.424079   .3187993     1.58   0.114     .9182926    2.208447
Diabetes,..  |   1.62e-15   9.51e-16   -58.07   0.000     5.14e-16    5.12e-15
             |
       liver |   .9537001   .1150014    -0.39   0.694      .752957    1.207963
      stroke |   .9396336   .1120345    -0.52   0.602     .7438202    1.186996
         tia |   1.094966   .1249091     0.80   0.426     .8755872    1.369311
    dementia |   .9528147   .1088228    -0.42   0.672     .7617126    1.191862
             |
    kidneyfn |
Stage 3a/..  |   1.65e-15   3.56e-16  -158.15   0.000     1.09e-15    2.52e-15
Stage 4/5..  |    .807358   .1268669    -1.36   0.173     .5933484    1.098557
             |
      spleen |   .9217473   .0873047    -0.86   0.390     .7655774    1.109774
  transplant |   .9716045   .1148947    -0.24   0.808     .7706067    1.225029
    dialysis |   1.096903   .2002947     0.51   0.612     .7668998    1.568909
immunosupp~n |   1.009687   .0936715     0.10   0.917     .8418183    1.211031
  cancerHaem |   .9923927   .0390306    -0.19   0.846     .9187682    1.071917
  autoimmune |    1.10963   .1221668     0.94   0.345     .8942599     1.37687
         ibd |   1.056491   .1205313     0.48   0.630     .8448027    1.321224
cancerExha~r |   .9502985     .68497    -0.07   0.944     .2313761    3.903027
------------------------------------------------------------------------------
                                                         Stratified by stpcode

.         forvalues k = `lo_`exp'' (1) `hi_`exp'' {
  2.                 capture qui di _b[`k'.`exp']
  3.                 if _rc==0 {
  4.                         post `ldrresults' (`i') ("`out'") ("`exp'")     //
> /
>                         ("All")                                              
>                                    ///
>                         (`k') (1) (_b[`k'.`exp']) (_se[`k'.`exp'])
  5.                 }
  6.                                 forvalues l = 2 (1) 3 {
  7.                         capture qui di _b[`k'.`exp'#`l'.agebroad]
  8.                         if _rc==0 {
  9.                             lincom `k'.`exp' + `k'.`exp'#`l'.agebroad
 10.                                 post `ldrresults' (`i') ("`out'") ("`exp'"
> )     ///
>                                         ("All")                              
>                                    ///
>                                         (`k') (`l') (r(estimate)) (r(se))
 11.                         }
 12.                 }
 13.         }

 ( 1)  0b.ldr_cat + 0b.ldr_cat#2o.agebroad = 0

------------------------------------------------------------------------------
          _t |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
         (1) |          0  (omitted)
------------------------------------------------------------------------------

 ( 1)  0b.ldr_cat + 0b.ldr_cat#3o.agebroad = 0

------------------------------------------------------------------------------
          _t |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
         (1) |          0  (omitted)
------------------------------------------------------------------------------

 ( 1)  1.ldr_cat + 1.ldr_cat#2.agebroad = 0

------------------------------------------------------------------------------
          _t |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
         (1) |  -.2671839   .3166742    -0.84   0.399    -.8878538    .3534861
------------------------------------------------------------------------------

 ( 1)  1.ldr_cat + 1.ldr_cat#3.agebroad = 0

------------------------------------------------------------------------------
          _t |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
         (1) |     .36489   .2869726     1.27   0.204    -.1975661     .927346
------------------------------------------------------------------------------

 ( 1)  2.ldr_cat + 2.ldr_cat#2.agebroad = 0

------------------------------------------------------------------------------
          _t |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
         (1) |   .2517844   .4752086     0.53   0.596    -.6796073    1.183176
------------------------------------------------------------------------------

 ( 1)  2.ldr_cat + 2.ldr_cat#3.agebroad = 0

------------------------------------------------------------------------------
          _t |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
         (1) |   .9315091   .3991141     2.33   0.020     .1492599    1.713758
------------------------------------------------------------------------------

. 
. postclose `ldrresults'

. 
. use `ldrfile', clear

. 
. 
. *************************
. *  Tidy output for HRs  *
. *************************
. 
. * Outcome
. rename outcome out

. gen outcome     = 1 if out=="coviddeath"
(45 missing values generated)

. replace outcome = 2 if out=="covidadmission"
(45 real changes made)

. replace outcome = 3 if out=="composite"
(0 real changes made)

. 
. label define outcome    1 "COVID-19 death"              ///
>                                                 2 "COVID-19 admission"  ///
>                                                 3 "Composite"

. label values outcome outcome

. drop out

. 
. * Exposure
. rename exposure exp

. gen     exposure = 1 if exp=="ldr"
(45 missing values generated)

. replace exposure = 2 if exp=="ldr_cat"
(45 real changes made)

. replace exposure = 3 if exp=="ldr_carecat"
(0 real changes made)

. replace exposure = 4 if exp=="ds"
(0 real changes made)

. replace exposure = 5 if exp=="cp"
(0 real changes made)

. replace exposure = 6 if exp=="ldr_group"
(0 real changes made)

. 
. label define exposure   1 "Learning disability register"        ///
>                                                 2 "LDR Severe vs mild"       
>                    ///
>                                                 3 "LDR by residential care"  
>                    ///
>                                                 4 "Down's syndrome"          
>                            ///
>                                                 5 "Cerebral Palsy"           
>                            ///
>                                                 6 "Combined grouping"        
>                    

. label values exposure exposure                                          

. drop exp

. 
. * Age categories
. label define agebroad   1 "16-<65"              ///
>                                                 2 "65-<75"              ///
>                                                 3 "75+"

. label values agebroad agebroad

. 
. 
. * Categories of exposure
. gen category     = "No"                                         if expcat==0
(30 missing values generated)

. replace category = "Yes"                                        if inlist(exp
> osure, 1, 4, 5) & expcat==1
(0 real changes made)

. 
. replace category = "LDR, mild"                          if inlist(exposure, 2
> ) & expcat==1
variable category was str2 now str9
(15 real changes made)

. replace category = "LDR, profound"                      if inlist(exposure, 2
> ) & expcat==2
variable category was str9 now str13
(15 real changes made)

. 
. replace category = "LDR, community"             if inlist(exposure, 3) & expc
> at==1
(0 real changes made)

. replace category = "LDR, residential care"      if inlist(exposure, 3) & expc
> at==2
(0 real changes made)

. 
. replace category = "DS but not LDR"             if inlist(exposure, 6) & expc
> at==1
(0 real changes made)

. replace category = "DS and LDR"                         if inlist(exposure, 6
> ) & expcat==2
(0 real changes made)

. replace category = "CP but not LDR"             if inlist(exposure, 6) & expc
> at==3
(0 real changes made)

. replace category = "CP and LDR"                         if inlist(exposure, 6
> ) & expcat==4
(0 real changes made)

. replace category = "LDR with no DS or CP"       if inlist(exposure, 6) & expc
> at==5
(0 real changes made)

. 
. * Model adjustment
. gen     adjustment = 1 if model=="Confounders"
(36 missing values generated)

. replace adjustment = 2 if model=="Confounders+IMD"
(9 real changes made)

. replace adjustment = 3 if model=="Confounders+Resid"
(9 real changes made)

. replace adjustment = 4 if model=="Confounders+Comorb"
(9 real changes made)

. replace adjustment = 5 if model=="All"
(9 real changes made)

. label define adj        1 "Confounders"                                      
>    ///     
>                                         2 "Confounders with IMD"             
>            ///
>                                         3 "Confounders with care"            
>            ///
>                                         4 "Confounders with comorbidities"   
>    ///
>                                         5 "All"

. label values adjustment adj

. drop model

. 
. * Hazard ratio with 95% confidence interval
. gen cl = exp(lnhr - invnorm(0.975)*sehr)

. gen cu = exp(lnhr + invnorm(0.975)*sehr)

. gen hr = exp(lnhr)

. 
. gen hr_ci =   string(round(hr, 0.01)) + " (" ///
>                         + string(round(cl, 0.01)) + ", " ///
>                         + string(round(cu, 0.01)) + ")"

. replace hr_ci = "" if expcat==0
(15 real changes made)

. drop cl cu hr lnhr sehr

. 
. * Put in wide format
. reshape wide hr_ci, i(wave outcome exposure expcat agebroad) j(adjust)
(note: j = 1 2 3 4 5)

Data                               long   ->   wide
-----------------------------------------------------------------------------
Number of obs.                       45   ->       9
Number of variables                   8   ->      11
j variable (5 values)        adjustment   ->   (dropped)
xij variables:
                                  hr_ci   ->   hr_ci1 hr_ci2 ... hr_ci5
-----------------------------------------------------------------------------

. rename hr_ci1 hr_conf

. rename hr_ci2 hr_conf_imd

. rename hr_ci3 hr_conf_resid

. rename hr_ci4 hr_conf_comorb

. 
. 
. order wave outcome exposure agebroad category hr*

. sort wave outcome exposure agebroad expcat

. 
. * Save data
. outsheet using "output/ldcox_inter_wave`i'_`out'_`exp'", replace
(note: file output/ldcox_inter_wave2_covidadmission_ldr_cat.out not found)

. 
. log close
      name:  <unnamed>
       log:  /workspace/logs/AL006_cox_regression_inter_wave2_covidadmission_ld
> r_cat.log
  log type:  text
 closed on:  25 Feb 2021, 20:09:42
-------------------------------------------------------------------------------
