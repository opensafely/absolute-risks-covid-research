-------------------------------------------------------------------------------
      name:  <unnamed>
       log:  /workspace/logs/AL005_cox_regression_child.log
  log type:  text
 opened on:  17 Feb 2021, 13:24:00

. 
. 
. * Categories of various exposures
. local lo_ldr            = 0

. local hi_ldr            = 1

. local lo_ldr_cat        = 0

. local hi_ldr_cat        = 2

. local hi_ldr            = 1

. local lo_ldr_carecat= 0

. local hi_ldr_carecat= 2

. local lo_ds             = 0

. local hi_ds             = 1

. local lo_cp             = 0

. local hi_cp             = 1

. local lo_ldr_group      = 0

. local hi_ldr_group      = 5

. 
. * Open temporary file to post results
. tempfile ldrfile

. tempname ldrresults

. 
. postfile `ldrresults'   wave str15(outcome) str15(exposure) str20(model)     
>    ///
>                                                 expcat lnhr sehr using `ldrfi
> le'

. 
. * Cycle over the two waves
. *    Wave 1: i=1  (1 Mar 20 - 31 Aug 20) 
. *    Wave 2: i=2  (1 Sept 20 - latest)
. forvalues i = 1 (1) 2 {
  2. 
.         * Open dataset (complete case ethnicity)
.         use "analysis/data_ldanalysis_cohort`i'.dta", clear 
  3.         drop if ethnicity_5>=.
  4. 
.         * Only keep data for children (under 16)
.         keep if child==1
  5. 
.         * Cycle over outcomes: mortality, hospitalisation, composite 
.         foreach out in coviddeath covidadmission composite {
  6. 
. 
.                 /*  Declare data to be survival  */
. 
.                 stset stime_`out'`i', fail(`out'`i') scale(365.25)
  7. 
. 
.                 * Cycle over exposures: learning disability register, by seve
> rity, 
.                 *    Down's syndrome, Cerebral Palsy, and the combined groupi
> ng
.                 foreach exp in ldr ldr_cat ldr_carecat ds cp ldr_group {
  8. 
.                 
.                         /*  Obtain rates  */
.                         
.                         strate `exp',                                        
>                                            ///
>                                 output(analysis/data_temp`out'_`exp'_`i', rep
> lace)      ///
>                                 per(10000)
  9.                 
.                 
.                         /*  Fit Cox models  */
.                         
.                         * Confounder only model
.                         capture stcox i.`exp' age1 age2 age3 male i.ethnicity
> _5,        ///
>                                 strata(stpcode) cluster(household_id) 
 10.                         forvalues k = `lo_`exp'' (1) `hi_`exp'' {
 11.                             capture qui di _b[`k'.`exp']
 12.                                 if _rc==0 {
 13.                                     post `ldrresults' (`i') ("`out'") ("`e
> xp'")         ///
>                                                 ("Confounders")              
>                                            ///
>                                                 (`k') (_b[`k'.`exp']) (_se[`k
> '.`exp'])
 14.                                 }
 15.                         }
 16.                         
.                         * Confounders with deprivation
.                         capture stcox i.`exp' age1 age2 age3 male i.ethnicity
> _5 imd, ///
>                                 strata(stpcode) cluster(household_id) 
 17.                         forvalues k = `lo_`exp'' (1) `hi_`exp'' {
 18.                             capture qui di _b[`k'.`exp']
 19.                                 if _rc==0 {
 20.                                     post `ldrresults' (`i') ("`out'") ("`e
> xp'")         ///
>                                                 ("Confounders+IMD")          
>                                    ///
>                                                 (`k') (_b[`k'.`exp']) (_se[`k
> '.`exp'])
 21.                                 }               
 22.                         }
 23.                         
.                         * Confounders with residential care
.                         capture stcox i.`exp' age1 age2 age3 male i.ethnicity
> _5 resid_care_ldr, ///
>                                 strata(stpcode) cluster(household_id) 
 24.                         forvalues k = `lo_`exp'' (1) `hi_`exp'' {
 25.                             capture qui di _b[`k'.`exp']
 26.                                 if _rc==0 {
 27.                                     post `ldrresults' (`i') ("`out'") ("`e
> xp'")         ///
>                                                 ("Confounders+Resid")        
>                                    ///
>                                                 (`k') (_b[`k'.`exp']) (_se[`k
> '.`exp'])
 28.                                 }               
 29.                         }
 30.                         
.                         * Confounders with physical comorbidities that are in
> dicators for vaccination 
.                         capture stcox i.`exp' age1 age2 age3 male i.ethnicity
> _5         ///
>                                                 cardiac af dvt_pe i.diabcat  
>                            ///
>                                                 liver stroke tia dementia    
>                            ///
>                                                 i.kidneyfn                   
>                                            ///
>                                                 spleen transplant dialysis   
>                            ///
>                                                 immunosuppression cancerHaem 
>                    ///
>                                                 autoimmune ibd cancerExhaem1y
> r,                 ///
>                                 strata(stpcode) cluster(household_id) 
 31.                         forvalues k = `lo_`exp'' (1) `hi_`exp'' {
 32.                             capture qui di _b[`k'.`exp']
 33.                                 if _rc==0 {
 34.                                     post `ldrresults' (`i') ("`out'") ("`e
> xp'")         ///
>                                         ("Confounders_Comorb")               
>                            ///
>                                         (`k') (_b[`k'.`exp']) (_se[`k'.`exp']
> )
 35.                                 }
 36.                         }
 37.                 }
 38.         }
 39. }
(Analysis dataset, wave 1 (1 Mar - 31 Aug 20), for learning disability work)
(12,499 observations deleted)
(30,313 observations deleted)

     failure event:  coviddeath1 != 0 & coviddeath1 < .
obs. time interval:  (0, stime_coviddeath1]
 exit on or before:  failure
    t for analysis:  time/365.25

------------------------------------------------------------------------------
      7,180  total observations
          0  exclusions
------------------------------------------------------------------------------
      7,180  observations remaining, representing
        157  failures in single-record/single-failure data
  3,429.796  total analysis time at risk and under observation
                                                at risk from t =         0
                                     earliest observed entry t =         0
                                          last observed exit t =  .5037645

         failure _d:  coviddeath1
   analysis time _t:  stime_coviddeath1/365.25

Estimated rates (per 10000) and lower/upper bounds of 95% confidence intervals
(7180 records included in the analysis)

  +----------------------------------------------+
  | ldr    D        Y     Rate    Lower    Upper |
  |----------------------------------------------|
  |   0   94   0.2093   449.12   366.92   549.75 |
  |   1   63   0.1337   471.26   368.15   603.26 |
  +----------------------------------------------+


         failure _d:  coviddeath1
   analysis time _t:  stime_coviddeath1/365.25

Estimated rates (per 10000) and lower/upper bounds of 95% confidence intervals
(7180 records included in the analysis)

  +--------------------------------------------------------+
  |       ldr_cat    D        Y     Rate    Lower    Upper |
  |--------------------------------------------------------|
  |    Not on LDR   94   0.2093   449.12   366.92   549.75 |
  |     LDR, mild   57   0.1088   523.71   403.97   678.95 |
  | LDR, profound    6   0.0248   241.49   108.49   537.53 |
  +--------------------------------------------------------+


         failure _d:  coviddeath1
   analysis time _t:  stime_coviddeath1/365.25

Estimated rates (per 10000) and lower/upper bounds of 95% confidence intervals
(7180 records included in the analysis)

  +------------------------------------------------------------------------+
  |                  ldr_carecat    D        Y     Rate    Lower     Upper |
  |------------------------------------------------------------------------|
  |                   Not on LDR   94   0.2093   449.12   366.92    549.75 |
  | LDR, not in residential care    2   0.0044   451.65   112.96   1805.90 |
  |     LDR, in residential care   61   0.1293   471.93   367.19    606.55 |
  +------------------------------------------------------------------------+


         failure _d:  coviddeath1
   analysis time _t:  stime_coviddeath1/365.25

Estimated rates (per 10000) and lower/upper bounds of 95% confidence intervals
(7180 records included in the analysis)

  +----------------------------------------------+
  | ds     D        Y     Rate    Lower    Upper |
  |----------------------------------------------|
  |  0   120   0.2737   438.43   366.61   524.33 |
  |  1    37   0.0693   534.08   386.96   737.13 |
  +----------------------------------------------+


         failure _d:  coviddeath1
   analysis time _t:  stime_coviddeath1/365.25

Estimated rates (per 10000) and lower/upper bounds of 95% confidence intervals
(7180 records included in the analysis)

  +----------------------------------------------+
  | cp     D        Y     Rate    Lower    Upper |
  |----------------------------------------------|
  |  0   119   0.2760   431.09   360.20   515.94 |
  |  1    38   0.0669   567.70   413.08   780.19 |
  +----------------------------------------------+


         failure _d:  coviddeath1
   analysis time _t:  stime_coviddeath1/365.25

Estimated rates (per 10000) and lower/upper bounds of 95% confidence intervals
(7180 records included in the analysis)

  +----------------------------------------------------------------+
  |            ldr_group    D        Y     Rate    Lower     Upper |
  |----------------------------------------------------------------|
  | No DS, no CP, no LDR   56   0.1332   420.54   323.64    546.46 |
  |       DS but not LDR   16   0.0341   469.80   287.82    766.86 |
  |           DS and LDR   12   0.0225   533.02   302.71    938.56 |
  |       CP but not LDR   22   0.0421   522.85   344.27    794.06 |
  |           CP and LDR   16   0.0249   643.61   394.30   1050.57 |
  |----------------------------------------------------------------|
  |  LD with no DS or CP   35   0.0863   405.51   291.16    564.79 |
  +----------------------------------------------------------------+


     failure event:  covidadmission1 != 0 & covidadmission1 < .
obs. time interval:  (0, stime_covidadmission1]
 exit on or before:  failure
    t for analysis:  time/365.25

------------------------------------------------------------------------------
      7,180  total observations
          0  exclusions
------------------------------------------------------------------------------
      7,180  observations remaining, representing
        717  failures in single-record/single-failure data
  3,256.517  total analysis time at risk and under observation
                                                at risk from t =         0
                                     earliest observed entry t =         0
                                          last observed exit t =  .5037645

         failure _d:  covidadmission1
   analysis time _t:  stime_covidadmission1/365.25

Estimated rates (per 10000) and lower/upper bounds of 95% confidence intervals
(7180 records included in the analysis)

  +-----------------------------------------------+
  | ldr     D        Y     Rate    Lower    Upper |
  |-----------------------------------------------|
  |   0   443   0.1985   2232.3   2033.8   2450.1 |
  |   1   274   0.1272   2154.1   1913.6   2424.9 |
  +-----------------------------------------------+


         failure _d:  covidadmission1
   analysis time _t:  stime_covidadmission1/365.25

Estimated rates (per 10000) and lower/upper bounds of 95% confidence intervals
(7180 records included in the analysis)

  +---------------------------------------------------------+
  |       ldr_cat     D        Y     Rate    Lower    Upper |
  |---------------------------------------------------------|
  |    Not on LDR   443   0.1985   2232.3   2033.8   2450.1 |
  |     LDR, mild   216   0.1039   2079.2   1819.6   2375.8 |
  | LDR, profound    58   0.0233   2488.2   1923.6   3218.5 |
  +---------------------------------------------------------+


         failure _d:  covidadmission1
   analysis time _t:  stime_covidadmission1/365.25

Estimated rates (per 10000) and lower/upper bounds of 95% confidence intervals
(7180 records included in the analysis)

  +------------------------------------------------------------------------+
  |                  ldr_carecat     D        Y     Rate    Lower    Upper |
  |------------------------------------------------------------------------|
  |                   Not on LDR   443   0.1985   2232.3   2033.8   2450.1 |
  | LDR, not in residential care    11   0.0042   2601.2   1440.5   4696.9 |
  |     LDR, in residential care   263   0.1230   2138.7   1895.3   2413.5 |
  +------------------------------------------------------------------------+


         failure _d:  covidadmission1
   analysis time _t:  stime_covidadmission1/365.25

Estimated rates (per 10000) and lower/upper bounds of 95% confidence intervals
(7180 records included in the analysis)

  +----------------------------------------------+
  | ds     D        Y     Rate    Lower    Upper |
  |----------------------------------------------|
  |  0   561   0.2602   2155.6   1984.4   2341.6 |
  |  1   156   0.0654   2385.1   2038.7   2790.4 |
  +----------------------------------------------+


         failure _d:  covidadmission1
   analysis time _t:  stime_covidadmission1/365.25

Estimated rates (per 10000) and lower/upper bounds of 95% confidence intervals
(7180 records included in the analysis)

  +----------------------------------------------+
  | cp     D        Y     Rate    Lower    Upper |
  |----------------------------------------------|
  |  0   578   0.2623   2203.5   2031.0   2390.7 |
  |  1   139   0.0633   2194.4   1858.3   2591.3 |
  +----------------------------------------------+


         failure _d:  covidadmission1
   analysis time _t:  stime_covidadmission1/365.25

Estimated rates (per 10000) and lower/upper bounds of 95% confidence intervals
(7180 records included in the analysis)

  +----------------------------------------------------------------+
  |            ldr_group     D        Y     Rate    Lower    Upper |
  |----------------------------------------------------------------|
  | No DS, no CP, no LDR   284   0.1265   2245.7   1999.2   2522.7 |
  |       DS but not LDR    72   0.0322   2239.4   1777.6   2821.3 |
  |           DS and LDR    58   0.0213   2719.5   2102.4   3517.7 |
  |       CP but not LDR    87   0.0398   2183.7   1769.9   2694.4 |
  |           CP and LDR    52   0.0235   2212.5   1685.9   2903.5 |
  |----------------------------------------------------------------|
  |  LD with no DS or CP   164   0.0824   1991.1   1708.5   2320.4 |
  +----------------------------------------------------------------+


     failure event:  composite1 != 0 & composite1 < .
obs. time interval:  (0, stime_composite1]
 exit on or before:  failure
    t for analysis:  time/365.25

------------------------------------------------------------------------------
      7,180  total observations
          0  exclusions
------------------------------------------------------------------------------
      7,180  observations remaining, representing
        895  failures in single-record/single-failure data
  3,256.517  total analysis time at risk and under observation
                                                at risk from t =         0
                                     earliest observed entry t =         0
                                          last observed exit t =  .5037645

         failure _d:  composite1
   analysis time _t:  stime_composite1/365.25

Estimated rates (per 10000) and lower/upper bounds of 95% confidence intervals
(7180 records included in the analysis)

  +-----------------------------------------------+
  | ldr     D        Y     Rate    Lower    Upper |
  |-----------------------------------------------|
  |   0   550   0.1985   2771.4   2549.2   3013.0 |
  |   1   345   0.1272   2712.3   2440.7   3014.2 |
  +-----------------------------------------------+


         failure _d:  composite1
   analysis time _t:  stime_composite1/365.25

Estimated rates (per 10000) and lower/upper bounds of 95% confidence intervals
(7180 records included in the analysis)

  +---------------------------------------------------------+
  |       ldr_cat     D        Y     Rate    Lower    Upper |
  |---------------------------------------------------------|
  |    Not on LDR   550   0.1985   2771.4   2549.2   3013.0 |
  |     LDR, mild   278   0.1039   2676.0   2379.2   3009.8 |
  | LDR, profound    67   0.0233   2874.3   2262.2   3651.9 |
  +---------------------------------------------------------+


         failure _d:  composite1
   analysis time _t:  stime_composite1/365.25

Estimated rates (per 10000) and lower/upper bounds of 95% confidence intervals
(7180 records included in the analysis)

  +------------------------------------------------------------------------+
  |                  ldr_carecat     D        Y     Rate    Lower    Upper |
  |------------------------------------------------------------------------|
  |                   Not on LDR   550   0.1985   2771.4   2549.2   3013.0 |
  | LDR, not in residential care    13   0.0042   3074.1   1785.0   5294.2 |
  |     LDR, in residential care   332   0.1230   2699.9   2424.5   3006.5 |
  +------------------------------------------------------------------------+


         failure _d:  composite1
   analysis time _t:  stime_composite1/365.25

Estimated rates (per 10000) and lower/upper bounds of 95% confidence intervals
(7180 records included in the analysis)

  +----------------------------------------------+
  | ds     D        Y     Rate    Lower    Upper |
  |----------------------------------------------|
  |  0   696   0.2602   2674.4   2482.9   2880.6 |
  |  1   199   0.0654   3042.6   2647.9   3496.1 |
  +----------------------------------------------+


         failure _d:  composite1
   analysis time _t:  stime_composite1/365.25

Estimated rates (per 10000) and lower/upper bounds of 95% confidence intervals
(7180 records included in the analysis)

  +----------------------------------------------+
  | cp     D        Y     Rate    Lower    Upper |
  |----------------------------------------------|
  |  0   715   0.2623   2725.8   2533.1   2933.1 |
  |  1   180   0.0633   2841.7   2455.4   3288.6 |
  +----------------------------------------------+


         failure _d:  composite1
   analysis time _t:  stime_composite1/365.25

Estimated rates (per 10000) and lower/upper bounds of 95% confidence intervals
(7180 records included in the analysis)

  +----------------------------------------------------------------+
  |            ldr_group     D        Y     Rate    Lower    Upper |
  |----------------------------------------------------------------|
  | No DS, no CP, no LDR   345   0.1265   2728.1   2454.9   3031.7 |
  |       DS but not LDR    94   0.0322   2923.7   2388.6   3578.7 |
  |           DS and LDR    71   0.0213   3329.0   2638.1   4200.8 |
  |       CP but not LDR   111   0.0398   2786.1   2313.2   3355.8 |
  |           CP and LDR    69   0.0235   2935.8   2318.8   3717.1 |
  |----------------------------------------------------------------|
  |  LD with no DS or CP   205   0.0824   2488.8   2170.4   2854.0 |
  +----------------------------------------------------------------+

(Analysis dataset, wave 2 (1 Sept 20 - latest), for learning disability work)
(11,202 observations deleted)
(27,050 observations deleted)

     failure event:  coviddeath2 != 0 & coviddeath2 < .
obs. time interval:  (0, stime_coviddeath2]
 exit on or before:  failure
    t for analysis:  time/365.25

------------------------------------------------------------------------------
      6,485  total observations
          0  exclusions
------------------------------------------------------------------------------
      6,485  observations remaining, representing
        148  failures in single-record/single-failure data
  2,744.282  total analysis time at risk and under observation
                                                at risk from t =         0
                                     earliest observed entry t =         0
                                          last observed exit t =  .4462697

         failure _d:  coviddeath2
   analysis time _t:  stime_coviddeath2/365.25

Estimated rates (per 10000) and lower/upper bounds of 95% confidence intervals
(6485 records included in the analysis)

  +----------------------------------------------+
  | ldr    D        Y     Rate    Lower    Upper |
  |----------------------------------------------|
  |   0   93   0.1649   564.13   460.38   691.27 |
  |   1   55   0.1096   501.95   385.37   653.78 |
  +----------------------------------------------+


         failure _d:  coviddeath2
   analysis time _t:  stime_coviddeath2/365.25

Estimated rates (per 10000) and lower/upper bounds of 95% confidence intervals
(6485 records included in the analysis)

  +--------------------------------------------------------+
  |       ldr_cat    D        Y     Rate    Lower    Upper |
  |--------------------------------------------------------|
  |    Not on LDR   93   0.1649   564.13   460.38   691.27 |
  |     LDR, mild   43   0.0875   491.49   364.51   662.71 |
  | LDR, profound   12   0.0221   543.36   308.58   956.77 |
  +--------------------------------------------------------+


         failure _d:  coviddeath2
   analysis time _t:  stime_coviddeath2/365.25

Estimated rates (per 10000) and lower/upper bounds of 95% confidence intervals
(6485 records included in the analysis)

  +-----------------------------------------------------------------------+
  |                  ldr_carecat    D        Y     Rate    Lower    Upper |
  |-----------------------------------------------------------------------|
  |                   Not on LDR   93   0.1649   564.13   460.38   691.27 |
  | LDR, not in residential care    0   0.0034     0.00        .        . |
  |     LDR, in residential care   55   0.1061   518.14   397.81   674.88 |
  +-----------------------------------------------------------------------+


         failure _d:  coviddeath2
   analysis time _t:  stime_coviddeath2/365.25

Estimated rates (per 10000) and lower/upper bounds of 95% confidence intervals
(6485 records included in the analysis)

  +----------------------------------------------+
  | ds     D        Y     Rate    Lower    Upper |
  |----------------------------------------------|
  |  0   117   0.2193   533.42   445.02   639.39 |
  |  1    31   0.0551   562.71   395.74   800.14 |
  +----------------------------------------------+


         failure _d:  coviddeath2
   analysis time _t:  stime_coviddeath2/365.25

Estimated rates (per 10000) and lower/upper bounds of 95% confidence intervals
(6485 records included in the analysis)

  +----------------------------------------------+
  | cp     D        Y     Rate    Lower    Upper |
  |----------------------------------------------|
  |  0   120   0.2224   539.47   451.09   645.16 |
  |  1    28   0.0520   538.60   371.88   780.06 |
  +----------------------------------------------+


         failure _d:  coviddeath2
   analysis time _t:  stime_coviddeath2/365.25

Estimated rates (per 10000) and lower/upper bounds of 95% confidence intervals
(6485 records included in the analysis)

  +----------------------------------------------------------------+
  |            ldr_group    D        Y     Rate    Lower     Upper |
  |----------------------------------------------------------------|
  | No DS, no CP, no LDR   63   0.1086   579.92   453.03    742.35 |
  |       DS but not LDR   12   0.0257   467.08   265.26    822.46 |
  |           DS and LDR   14   0.0187   747.15   442.50   1261.54 |
  |       CP but not LDR   18   0.0305   589.64   371.50    935.88 |
  |           CP and LDR   10   0.0215   465.99   250.73    866.06 |
  |----------------------------------------------------------------|
  |  LD with no DS or CP   31   0.0694   446.84   314.25    635.38 |
  +----------------------------------------------------------------+


     failure event:  covidadmission2 != 0 & covidadmission2 < .
obs. time interval:  (0, stime_covidadmission2]
 exit on or before:  failure
    t for analysis:  time/365.25

------------------------------------------------------------------------------
      6,485  total observations
        652  observations end on or before enter()
------------------------------------------------------------------------------
      5,833  observations remaining, representing
        589  failures in single-record/single-failure data
  2,341.068  total analysis time at risk and under observation
                                                at risk from t =         0
                                     earliest observed entry t =         0
                                          last observed exit t =  .4462697

         failure _d:  covidadmission2
   analysis time _t:  stime_covidadmission2/365.25

Estimated rates (per 10000) and lower/upper bounds of 95% confidence intervals
(5833 records included in the analysis)

  +-----------------------------------------------+
  | ldr     D        Y     Rate    Lower    Upper |
  |-----------------------------------------------|
  |   0   348   0.1405   2477.4   2230.3   2751.9 |
  |   1   241   0.0936   2573.7   2268.5   2920.1 |
  +-----------------------------------------------+


         failure _d:  covidadmission2
   analysis time _t:  stime_covidadmission2/365.25

Estimated rates (per 10000) and lower/upper bounds of 95% confidence intervals
(5833 records included in the analysis)

  +---------------------------------------------------------+
  |       ldr_cat     D        Y     Rate    Lower    Upper |
  |---------------------------------------------------------|
  |    Not on LDR   348   0.1405   2477.4   2230.3   2751.9 |
  |     LDR, mild   189   0.0748   2525.3   2189.8   2912.3 |
  | LDR, profound    52   0.0188   2766.4   2108.0   3630.4 |
  +---------------------------------------------------------+


         failure _d:  covidadmission2
   analysis time _t:  stime_covidadmission2/365.25

Estimated rates (per 10000) and lower/upper bounds of 95% confidence intervals
(5833 records included in the analysis)

  +------------------------------------------------------------------------+
  |                  ldr_carecat     D        Y     Rate    Lower    Upper |
  |------------------------------------------------------------------------|
  |                   Not on LDR   348   0.1405   2477.4   2230.3   2751.9 |
  | LDR, not in residential care    12   0.0029   4077.2   2315.5   7179.3 |
  |     LDR, in residential care   229   0.0907   2524.9   2218.2   2874.1 |
  +------------------------------------------------------------------------+


         failure _d:  covidadmission2
   analysis time _t:  stime_covidadmission2/365.25

Estimated rates (per 10000) and lower/upper bounds of 95% confidence intervals
(5833 records included in the analysis)

  +----------------------------------------------+
  | ds     D        Y     Rate    Lower    Upper |
  |----------------------------------------------|
  |  0   470   0.1864   2521.1   2303.2   2759.6 |
  |  1   119   0.0477   2495.8   2085.3   2987.0 |
  +----------------------------------------------+


         failure _d:  covidadmission2
   analysis time _t:  stime_covidadmission2/365.25

Estimated rates (per 10000) and lower/upper bounds of 95% confidence intervals
(5833 records included in the analysis)

  +----------------------------------------------+
  | cp     D        Y     Rate    Lower    Upper |
  |----------------------------------------------|
  |  0   477   0.1894   2518.7   2302.5   2755.2 |
  |  1   112   0.0447   2504.3   2080.9   3013.8 |
  +----------------------------------------------+


         failure _d:  covidadmission2
   analysis time _t:  stime_covidadmission2/365.25

Estimated rates (per 10000) and lower/upper bounds of 95% confidence intervals
(5833 records included in the analysis)

  +----------------------------------------------------------------+
  |            ldr_group     D        Y     Rate    Lower    Upper |
  |----------------------------------------------------------------|
  | No DS, no CP, no LDR   228   0.0918   2483.3   2181.0   2827.4 |
  |       DS but not LDR    57   0.0223   2557.6   1972.8   3315.7 |
  |           DS and LDR    35   0.0162   2161.6   1552.0   3010.7 |
  |       CP but not LDR    63   0.0264   2389.4   1866.6   3058.7 |
  |           CP and LDR    49   0.0184   2669.2   2017.3   3531.7 |
  |----------------------------------------------------------------|
  |  LD with no DS or CP   157   0.0591   2657.0   2272.2   3106.8 |
  +----------------------------------------------------------------+


     failure event:  composite2 != 0 & composite2 < .
obs. time interval:  (0, stime_composite2]
 exit on or before:  failure
    t for analysis:  time/365.25

------------------------------------------------------------------------------
      6,485  total observations
        652  observations end on or before enter()
------------------------------------------------------------------------------
      5,833  observations remaining, representing
        730  failures in single-record/single-failure data
  2,341.068  total analysis time at risk and under observation
                                                at risk from t =         0
                                     earliest observed entry t =         0
                                          last observed exit t =  .4462697

         failure _d:  composite2
   analysis time _t:  stime_composite2/365.25

Estimated rates (per 10000) and lower/upper bounds of 95% confidence intervals
(5833 records included in the analysis)

  +-----------------------------------------------+
  | ldr     D        Y     Rate    Lower    Upper |
  |-----------------------------------------------|
  |   0   435   0.1405   3096.8   2819.0   3401.9 |
  |   1   295   0.0936   3150.4   2810.7   3531.2 |
  +-----------------------------------------------+


         failure _d:  composite2
   analysis time _t:  stime_composite2/365.25

Estimated rates (per 10000) and lower/upper bounds of 95% confidence intervals
(5833 records included in the analysis)

  +---------------------------------------------------------+
  |       ldr_cat     D        Y     Rate    Lower    Upper |
  |---------------------------------------------------------|
  |    Not on LDR   435   0.1405   3096.8   2819.0   3401.9 |
  |     LDR, mild   232   0.0748   3099.9   2725.6   3525.6 |
  | LDR, profound    63   0.0188   3351.6   2618.2   4290.3 |
  +---------------------------------------------------------+


         failure _d:  composite2
   analysis time _t:  stime_composite2/365.25

Estimated rates (per 10000) and lower/upper bounds of 95% confidence intervals
(5833 records included in the analysis)

  +------------------------------------------------------------------------+
  |                  ldr_carecat     D        Y     Rate    Lower    Upper |
  |------------------------------------------------------------------------|
  |                   Not on LDR   435   0.1405   3096.8   2819.0   3401.9 |
  | LDR, not in residential care    12   0.0029   4077.2   2315.5   7179.3 |
  |     LDR, in residential care   283   0.0907   3120.3   2777.2   3505.9 |
  +------------------------------------------------------------------------+


         failure _d:  composite2
   analysis time _t:  stime_composite2/365.25

Estimated rates (per 10000) and lower/upper bounds of 95% confidence intervals
(5833 records included in the analysis)

  +----------------------------------------------+
  | ds     D        Y     Rate    Lower    Upper |
  |----------------------------------------------|
  |  0   581   0.1864   3116.5   2873.1   3380.5 |
  |  1   149   0.0477   3125.0   2661.4   3669.3 |
  +----------------------------------------------+


         failure _d:  composite2
   analysis time _t:  stime_composite2/365.25

Estimated rates (per 10000) and lower/upper bounds of 95% confidence intervals
(5833 records included in the analysis)

  +----------------------------------------------+
  | cp     D        Y     Rate    Lower    Upper |
  |----------------------------------------------|
  |  0   591   0.1894   3120.7   2878.9   3382.7 |
  |  1   139   0.0447   3108.0   2632.0   3670.1 |
  +----------------------------------------------+


         failure _d:  composite2
   analysis time _t:  stime_composite2/365.25

Estimated rates (per 10000) and lower/upper bounds of 95% confidence intervals
(5833 records included in the analysis)

  +----------------------------------------------------------------+
  |            ldr_group     D        Y     Rate    Lower    Upper |
  |----------------------------------------------------------------|
  | No DS, no CP, no LDR   284   0.0918   3093.2   2753.6   3474.7 |
  |       DS but not LDR    71   0.0223   3185.7   2524.6   4020.0 |
  |           DS and LDR    47   0.0162   2902.8   2181.0   3863.4 |
  |       CP but not LDR    80   0.0264   3034.2   2437.1   3777.6 |
  |           CP and LDR    59   0.0184   3213.9   2490.1   4148.1 |
  |----------------------------------------------------------------|
  |  LD with no DS or CP   189   0.0591   3198.5   2773.5   3688.6 |
  +----------------------------------------------------------------+


. postclose `ldrresults'

. 
. use `ldrfile', clear

. 
. *************************
. *  Tidy output for HRs  *
. *************************
. 
. * Outcome
. rename outcome out

. gen outcome     = 1 if out=="coviddeath"
(288 missing values generated)

. replace outcome = 2 if out=="covidadmission"
(144 real changes made)

. replace outcome = 3 if out=="composite"
(144 real changes made)

. 
. label define outcome    1 "COVID-19 death"              ///
>                                                 2 "COVID-19 admission"  ///
>                                                 3 "Composite"

. label values outcome outcome

. drop out

. 
. * Exposure
. rename exposure exp

. gen     exposure = 1 if exp=="ldr"
(384 missing values generated)

. replace exposure = 2 if exp=="ldr_cat"
(72 real changes made)

. replace exposure = 3 if exp=="ldr_carecat"
(72 real changes made)

. replace exposure = 4 if exp=="ds"
(48 real changes made)

. replace exposure = 5 if exp=="cp"
(48 real changes made)

. replace exposure = 6 if exp=="ldr_group"
(144 real changes made)

. 
. label define exposure   1 "Learning disability register"        ///
>                                                 2 "LDR Severe vs mild"       
>                    ///
>                                                 3 "LDR by residential care"  
>                    ///
>                                                 4 "Down's syndrome"          
>                            ///
>                                                 5 "Cerebral Palsy"           
>                            ///
>                                                 6 "Combined grouping"        
>                    

. label values exposure exposure                                          

. drop exp

. 
. * Categories of exposure
. gen category     = "No"                                         if expcat==0
(288 missing values generated)

. replace category = "Yes"                                        if inlist(exp
> osure, 1, 4, 5) & expcat==1
variable category was str2 now str3
(72 real changes made)

. 
. replace category = "LDR, mild"                          if inlist(exposure, 2
> ) & expcat==1
variable category was str3 now str9
(24 real changes made)

. replace category = "LDR, profound"                      if inlist(exposure, 2
> ) & expcat==2
variable category was str9 now str13
(24 real changes made)

. 
. replace category = "LDR, community"             if inlist(exposure, 3) & expc
> at==1
variable category was str13 now str14
(24 real changes made)

. replace category = "LDR, residential care"      if inlist(exposure, 3) & expc
> at==2
variable category was str14 now str21
(24 real changes made)

. 
. replace category = "DS but not LDR"             if inlist(exposure, 6) & expc
> at==1
(24 real changes made)

. replace category = "DS and LDR"                         if inlist(exposure, 6
> ) & expcat==2
(24 real changes made)

. replace category = "CP but not LDR"             if inlist(exposure, 6) & expc
> at==3
(24 real changes made)

. replace category = "CP and LDR"                         if inlist(exposure, 6
> ) & expcat==4
(24 real changes made)

. replace category = "LDR with no DS or CP"       if inlist(exposure, 6) & expc
> at==5
(24 real changes made)

. 
. * Model adjustment
. gen     adjustment = 1 if model=="Confounders"
(324 missing values generated)

. replace adjustment = 2 if model=="Confounders+IMD"
(108 real changes made)

. replace adjustment = 3 if model=="Confounders+Resid"
(108 real changes made)

. replace adjustment = 4 if model=="Confounders_Comorb"
(108 real changes made)

. label define adj        1 "Confounders"                         ///     
>                                         2 "Confounders with IMD"        ///
>                                         3 "Confounders with care"       ///
>                                         4 "Confounders with comorbidities"   
>    

. label values adjustment adj

. drop model

. 
. * Hazard ratio with 95% confidence interval
. gen cl = exp(lnhr - invnorm(0.975)*sehr)

. gen cu = exp(lnhr + invnorm(0.975)*sehr)

. gen hr = exp(lnhr)

. 
. gen hr_ci =   string(round(hr, 0.01)) + " (" ///
>                         + string(round(cl, 0.01)) + ", " ///
>                         + string(round(cu, 0.01)) + ")"

. replace hr_ci = "" if expcat==0
(144 real changes made)

. drop cl cu hr lnhr sehr

. 
. * Put in wide format
. reshape wide hr_ci, i(wave outcome exposure expcat) j(adjust)
(note: j = 1 2 3 4)

Data                               long   ->   wide
-----------------------------------------------------------------------------
Number of obs.                      432   ->     108
Number of variables                   7   ->       9
j variable (4 values)        adjustment   ->   (dropped)
xij variables:
                                  hr_ci   ->   hr_ci1 hr_ci2 ... hr_ci4
-----------------------------------------------------------------------------

. rename hr_ci1 hr_conf

. rename hr_ci2 hr_conf_imd

. rename hr_ci3 hr_conf_resid

. rename hr_ci4 hr_conf_comorb

. 
. 
. order wave outcome exposure category hr*

. sort wave outcome exposure expcat

. 
. * Save data
. outsheet using "output/output_hrs_main_child", replace
(note: file output/output_hrs_main_child.out not found)

. 
. 
. 
. ***************************
. *  Tidy output for rates  *
. ***************************
. 
. forvalues i = 1 (1) 2 {
  2.         foreach out in coviddeath covidadmission composite  {
  3.                 local expnow = "ldr"
  4.                 use "analysis/data_temp`out'_`expnow'_`i'", clear
  5.                 gen exp = "`expnow'"
  6.                 foreach exp in ldr_cat ldr_carecat ds cp ldr_group {
  7.                         rename `expnow' `exp'
  8.                         append using "analysis/data_temp`out'_`exp'_`i'"
  9.                         erase "analysis/data_temp`out'_`expnow'_`i'.dta"
 10.                         replace exp = "`exp'" if exp==""
 11.                         local expnow = "`exp'"
 12.                 }
 13.                 erase "analysis/data_temp`out'_`expnow'_`i'.dta"
 14.                 gen out = "`out'"
 15.                 save "analysis/data_temp`out'_`i'", replace
 16.         }
 17.         use "analysis/data_tempcoviddeath_`i'"
 18.         append using "analysis/data_tempcovidadmission_`i'"
 19.         append using "analysis/data_tempcomposite_`i'"
 20. 
.         * Delete unneeded datasets
.         erase "analysis/data_tempcoviddeath_`i'.dta"
 21.         erase "analysis/data_tempcovidadmission_`i'.dta"
 22.         erase "analysis/data_tempcomposite_`i'.dta"
 23. 
.         gen wave = `i'
 24.         save "analysis/data_temp_`i'.dta"
 25. }
(Analysis dataset, wave 1 (1 Mar - 31 Aug 20), for learning disability work)
variable exp was str3 now str7
(3 real changes made)
variable exp was str7 now str11
(3 real changes made)
(note: variable _D was byte, now int to accommodate using data's values)
(2 real changes made)
(2 real changes made)
(6 real changes made)
(note: file analysis/data_tempcoviddeath_1.dta not found)
file analysis/data_tempcoviddeath_1.dta saved
(Analysis dataset, wave 1 (1 Mar - 31 Aug 20), for learning disability work)
variable exp was str3 now str7
(3 real changes made)
variable exp was str7 now str11
(3 real changes made)
(2 real changes made)
(2 real changes made)
(6 real changes made)
(note: file analysis/data_tempcovidadmission_1.dta not found)
file analysis/data_tempcovidadmission_1.dta saved
(Analysis dataset, wave 1 (1 Mar - 31 Aug 20), for learning disability work)
variable exp was str3 now str7
(3 real changes made)
variable exp was str7 now str11
(3 real changes made)
(2 real changes made)
(2 real changes made)
(6 real changes made)
(note: file analysis/data_tempcomposite_1.dta not found)
file analysis/data_tempcomposite_1.dta saved
(Analysis dataset, wave 1 (1 Mar - 31 Aug 20), for learning disability work)
(note: variable out was str10, now str14 to accommodate using data's values)
file analysis/data_temp_1.dta saved
(Analysis dataset, wave 2 (1 Sept 20 - latest), for learning disability work)
variable exp was str3 now str7
(3 real changes made)
variable exp was str7 now str11
(3 real changes made)
(note: variable _D was byte, now int to accommodate using data's values)
(2 real changes made)
(2 real changes made)
(6 real changes made)
(note: file analysis/data_tempcoviddeath_2.dta not found)
file analysis/data_tempcoviddeath_2.dta saved
(Analysis dataset, wave 2 (1 Sept 20 - latest), for learning disability work)
variable exp was str3 now str7
(3 real changes made)
variable exp was str7 now str11
(3 real changes made)
(2 real changes made)
(2 real changes made)
(6 real changes made)
(note: file analysis/data_tempcovidadmission_2.dta not found)
file analysis/data_tempcovidadmission_2.dta saved
(Analysis dataset, wave 2 (1 Sept 20 - latest), for learning disability work)
variable exp was str3 now str7
(3 real changes made)
variable exp was str7 now str11
(3 real changes made)
(2 real changes made)
(2 real changes made)
(6 real changes made)
(note: file analysis/data_tempcomposite_2.dta not found)
file analysis/data_tempcomposite_2.dta saved
(Analysis dataset, wave 2 (1 Sept 20 - latest), for learning disability work)
(note: variable out was str10, now str14 to accommodate using data's values)
file analysis/data_temp_2.dta saved

. use "analysis/data_temp_1.dta"
(Analysis dataset, wave 1 (1 Mar - 31 Aug 20), for learning disability work)

. append using "analysis/data_temp_2.dta"

. 
. erase "analysis/data_temp_1.dta"

. erase "analysis/data_temp_2.dta"

. 
. 
. 
. * Outcome
. gen outcome     = 1 if out=="coviddeath"
(72 missing values generated)

. replace outcome = 2 if out=="covidadmission"
(36 real changes made)

. replace outcome = 3 if out=="composite"
(36 real changes made)

. 
. label define outcome    1 "COVID-19 death"              ///
>                                                 2 "COVID-19 admission"  ///
>                                                 3 "Composite"

. label values outcome outcome

. drop out

. 
. * Exposure
. gen     exposure = 1 if exp=="ldr"
(96 missing values generated)

. replace exposure = 2 if exp=="ldr_cat"
(18 real changes made)

. replace exposure = 3 if exp=="ldr_carecat"
(18 real changes made)

. replace exposure = 4 if exp=="ds"
(12 real changes made)

. replace exposure = 5 if exp=="cp"
(12 real changes made)

. replace exposure = 6 if exp=="ldr_group"
(36 real changes made)

. 
. label define exposure   1 "Learning disability register"        ///
>                                                 2 "LDR Severe vs mild"       
>                    ///
>                                                 3 "LDR by residential care"  
>                    ///
>                                                 4 "Down's syndrome"          
>                            ///
>                                                 5 "Cerebral Palsy"           
>                            ///
>                                                 6 "Combined grouping"        
>                    

. label values exposure exposure                                          

. drop exp

. 
. * Categories of exposure
. rename ldr_group expcat

. gen category     = "No"                                         if expcat==0
(72 missing values generated)

. replace category = "Yes"                                        if inlist(exp
> osure, 1, 4, 5) & expcat==1
variable category was str2 now str3
(18 real changes made)

. 
. replace category = "LDR, mild"                          if inlist(exposure, 2
> ) & expcat==1
variable category was str3 now str9
(6 real changes made)

. replace category = "LDR, profound"                      if inlist(exposure, 2
> ) & expcat==2
variable category was str9 now str13
(6 real changes made)

. 
. replace category = "LDR, community"             if inlist(exposure, 3) & expc
> at==1
variable category was str13 now str14
(6 real changes made)

. replace category = "LDR, residential care"      if inlist(exposure, 3) & expc
> at==2
variable category was str14 now str21
(6 real changes made)

. 
. replace category = "DS but not LDR"             if inlist(exposure, 6) & expc
> at==1
(6 real changes made)

. replace category = "DS and LDR"                         if inlist(exposure, 6
> ) & expcat==2
(6 real changes made)

. replace category = "CP but not LDR"             if inlist(exposure, 6) & expc
> at==3
(6 real changes made)

. replace category = "CP and LDR"                         if inlist(exposure, 6
> ) & expcat==4
(6 real changes made)

. replace category = "LDR with no DS or CP"       if inlist(exposure, 6) & expc
> at==5
(6 real changes made)

. 
. * Rename remaining variables
. rename _D events

. rename _Y pyr_10000

. rename _Rate rate_per_10000

. rename _Lower rate_cl

. rename _Upper rate_cu

. 
. order wave outcome exposure category events pyr rate*

. sort wave outcome exposure expcat

. 
. 
. * Save data
. outsheet using "output/output_rates_child", replace
(note: file output/output_rates_child.out not found)

. 
. 
. 
. log close
      name:  <unnamed>
       log:  /workspace/logs/AL005_cox_regression_child.log
  log type:  text
 closed on:  17 Feb 2021, 13:26:11
-------------------------------------------------------------------------------
