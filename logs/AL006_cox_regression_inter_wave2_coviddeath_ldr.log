-------------------------------------------------------------------------------
      name:  <unnamed>
       log:  /workspace/logs/AL006_cox_regression_inter_wave2_coviddeath_ldr.lo
> g
  log type:  text
 opened on:  25 Feb 2021, 20:16:42

. 
. 
. * Categories of various exposures
. local lo_ldr            = 0

. local hi_ldr            = 1

. local lo_ldr_cat        = 0

. local hi_ldr_cat        = 2

. local hi_ldr            = 1

. local lo_ldr_carecat= 0

. local hi_ldr_carecat= 2

. local lo_ds             = 0

. local hi_ds             = 1

. local lo_cp             = 0

. local hi_cp             = 1

. local lo_ldr_group      = 0

. local hi_ldr_group      = 5

. 
. * Open temporary file to post results
. tempfile ldrfile

. tempname ldrresults

. 
. postfile `ldrresults'   wave str15(outcome) str15(exposure) str20(model)     
>    ///
>                                                 expcat agebroad lnhr sehr usi
> ng `ldrfile'

. 
. 
.         * Open dataset (complete case ethnicity)
.         use "analysis/data_ldanalysis_cohort`i'.dta", clear 
(Analysis dataset, wave 2 (1 Sept 20 - latest), for learning disability work)

.         drop if ethnicity_5>=.
(11,245 observations deleted)

. 
.         * Only keep data for adults
.         keep if child==0
(6,499 observations deleted)

. 
.         
.         /*  Declare data to be survival  */
. 
.         stset stime_`out'`i', fail(`out'`i') scale(365.25)

     failure event:  coviddeath2 != 0 & coviddeath2 < .
obs. time interval:  (0, stime_coviddeath2]
 exit on or before:  failure
    t for analysis:  time/365.25

------------------------------------------------------------------------------
     27,126  total observations
          0  exclusions
------------------------------------------------------------------------------
     27,126  observations remaining, representing
        571  failures in single-record/single-failure data
 11,482.376  total analysis time at risk and under observation
                                                at risk from t =         0
                                     earliest observed entry t =         0
                                          last observed exit t =  .4462697

. 
.         
.                 
.         /*  Fit Cox models  */
.         
.         * Confounder only model
.         stcox i.`exp'##i.agebroad age1 age2 age3 male i.ethnicity_5,    ///
>                 strata(stpcode) cluster(household_id) 

         failure _d:  coviddeath2
   analysis time _t:  stime_coviddeath2/365.25

Iteration 0:   log pseudolikelihood =  -3842.445
Iteration 1:   log pseudolikelihood =  -3836.927
Iteration 2:   log pseudolikelihood = -3836.9085
Iteration 3:   log pseudolikelihood = -3836.9085
Refining estimates:
Iteration 0:   log pseudolikelihood = -3836.9085

Stratified Cox regr. -- Breslow method for ties

No. of subjects      =       27,126             Number of obs    =      27,126
No. of failures      =          571
Time at risk         =  11482.37645
                                                Wald chi2(13)    =       11.10
Log pseudolikelihood =   -3836.9085             Prob > chi2      =      0.6026

                       (Std. Err. adjusted for 1,203 clusters in household_id)
------------------------------------------------------------------------------
             |               Robust
          _t | Haz. Ratio   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
       1.ldr |   1.025936   .1023649     0.26   0.797     .8437031    1.247529
             |
    agebroad |
     65-<75  |    1.04073   .2684962     0.15   0.877     .6276792    1.725592
        75+  |     1.1448   .4989888     0.31   0.756     .4872059    2.689963
             |
ldr#agebroad |
   1#65-<75  |   1.167793   .2941651     0.62   0.538     .7127704    1.913296
      1#75+  |   1.148441   .3075997     0.52   0.605     .6793943    1.941312
             |
        age1 |   .9975519   .0278051    -0.09   0.930     .9445167    1.053565
        age2 |   1.016415   .0685293     0.24   0.809     .8905967    1.160009
        age3 |   .9470627   .1662127    -0.31   0.757     .6714134     1.33588
        male |   1.085723   .0879838     1.01   0.310     .9262753    1.272617
             |
 ethnicity_5 |
      Mixed  |   1.158148   .1648794     1.03   0.302     .8761586    1.530894
Asian or ..  |   1.225327   .1611861     1.54   0.122     .9468478    1.585709
      Black  |   1.373009   .1822352     2.39   0.017     1.058513    1.780946
      Other  |   1.059494   .1459167     0.42   0.675     .8088504    1.387805
------------------------------------------------------------------------------
                                                         Stratified by stpcode

.         forvalues k = `lo_`exp'' (1) `hi_`exp'' {
  2.                 capture qui di _b[`k'.`exp']
  3.                 if _rc==0 {
  4.                         post `ldrresults' (`i') ("`out'") ("`exp'")       
>       ///
>                                 ("Confounders")                              
>                            ///
>                                 (`k') (1) (_b[`k'.`exp']) (_se[`k'.`exp'])
  5.                 }
  6.                 forvalues l = 2 (1) 3 {
  7.                         capture qui di _b[`k'.`exp'#`l'.agebroad]
  8.                         if _rc==0 {
  9.                             lincom `k'.`exp' + `k'.`exp'#`l'.agebroad
 10.                                 post `ldrresults' (`i') ("`out'") ("`exp'"
> )             ///
>                                         ("Confounders")                      
>                                    ///
>                                         (`k') (`l') (r(estimate)) (r(se))
 11.                         }
 12.                 }
 13.         }

 ( 1)  0b.ldr + 0b.ldr#2o.agebroad = 0

------------------------------------------------------------------------------
          _t |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
         (1) |          0  (omitted)
------------------------------------------------------------------------------

 ( 1)  0b.ldr + 0b.ldr#3o.agebroad = 0

------------------------------------------------------------------------------
          _t |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
         (1) |          0  (omitted)
------------------------------------------------------------------------------

 ( 1)  1.ldr + 1.ldr#2.agebroad = 0

------------------------------------------------------------------------------
          _t |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
         (1) |   .1807207   .2306346     0.78   0.433    -.2713148    .6327562
------------------------------------------------------------------------------

 ( 1)  1.ldr + 1.ldr#3.agebroad = 0

------------------------------------------------------------------------------
          _t |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
         (1) |   .1640103   .2477642     0.66   0.508    -.3215986    .6496191
------------------------------------------------------------------------------

.         
.         * Confounders with deprivation
.         stcox i.`exp'##i.agebroad age1 age2 age3 male i.ethnicity_5 imd, ///
>                 strata(stpcode) cluster(household_id) 

         failure _d:  coviddeath2
   analysis time _t:  stime_coviddeath2/365.25

Iteration 0:   log pseudolikelihood =  -3842.445
Iteration 1:   log pseudolikelihood =  -3836.922
Iteration 2:   log pseudolikelihood = -3836.9035
Iteration 3:   log pseudolikelihood = -3836.9035
Refining estimates:
Iteration 0:   log pseudolikelihood = -3836.9035

Stratified Cox regr. -- Breslow method for ties

No. of subjects      =       27,126             Number of obs    =      27,126
No. of failures      =          571
Time at risk         =  11482.37645
                                                Wald chi2(14)    =       11.12
Log pseudolikelihood =   -3836.9035             Prob > chi2      =      0.6763

                       (Std. Err. adjusted for 1,203 clusters in household_id)
------------------------------------------------------------------------------
             |               Robust
          _t | Haz. Ratio   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
       1.ldr |   1.025945   .1023635     0.26   0.797     .8437148    1.247535
             |
    agebroad |
     65-<75  |   1.040729   .2685022     0.15   0.877      .627672    1.725611
        75+  |   1.145278   .4998485     0.31   0.756     .4868669    2.694089
             |
ldr#agebroad |
   1#65-<75  |   1.167517   .2942829     0.61   0.539     .7123783    1.913446
      1#75+  |   1.147906   .3076515     0.51   0.607     .6788521    1.941055
             |
        age1 |   .9975528   .0278037    -0.09   0.930     .9445203    1.053563
        age2 |   1.016419   .0685287     0.24   0.809     .8906013    1.160011
        age3 |    .947041   .1662149    -0.31   0.757     .6713897    1.335866
        male |   1.085739   .0879847     1.02   0.310     .9262902    1.272636
             |
 ethnicity_5 |
      Mixed  |   1.158111    .164864     1.03   0.302     .8761463    1.530819
Asian or ..  |   1.225282   .1611735     1.54   0.122     .9468239    1.585635
      Black  |   1.372832   .1821436     2.39   0.017     1.058479    1.780543
      Other  |   1.059296    .145758     0.42   0.675     .8088964    1.387208
             |
         imd |   .9965006   .0352655    -0.10   0.921     .9297241    1.068073
------------------------------------------------------------------------------
                                                         Stratified by stpcode

.         forvalues k = `lo_`exp'' (1) `hi_`exp'' {
  2.                 capture qui di _b[`k'.`exp']
  3.                 if _rc==0 {
  4.                         post `ldrresults' (`i') ("`out'") ("`exp'")     //
> /
>                                 ("Confounders+IMD")                          
>                    ///
>                                 (`k') (1) (_b[`k'.`exp']) (_se[`k'.`exp'])
  5.                 }       
  6.                 forvalues l = 2 (1) 3 {
  7.                         capture qui di _b[`k'.`exp'#`l'.agebroad]
  8.                         if _rc==0 {
  9.                             lincom `k'.`exp' + `k'.`exp'#`l'.agebroad
 10.                                 post `ldrresults' (`i') ("`out'") ("`exp'"
> )             ///
>                                         ("Confounders+IMD")                  
>                            ///
>                                         (`k') (`l') (r(estimate)) (r(se))
 11.                         }
 12.                 }
 13.         }

 ( 1)  0b.ldr + 0b.ldr#2o.agebroad = 0

------------------------------------------------------------------------------
          _t |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
         (1) |          0  (omitted)
------------------------------------------------------------------------------

 ( 1)  0b.ldr + 0b.ldr#3o.agebroad = 0

------------------------------------------------------------------------------
          _t |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
         (1) |          0  (omitted)
------------------------------------------------------------------------------

 ( 1)  1.ldr + 1.ldr#2.agebroad = 0

------------------------------------------------------------------------------
          _t |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
         (1) |    .180494   .2308093     0.78   0.434    -.2718839    .6328718
------------------------------------------------------------------------------

 ( 1)  1.ldr + 1.ldr#3.agebroad = 0

------------------------------------------------------------------------------
          _t |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
         (1) |   .1635541   .2479684     0.66   0.510     -.322455    .6495632
------------------------------------------------------------------------------

.         
.         * Confounders with residential care
.         stcox i.`exp'##i.agebroad age1 age2 age3 male   ///
>                                 i.ethnicity_5 resid_care_ldr,           ///
>                 strata(stpcode) cluster(household_id) 

         failure _d:  coviddeath2
   analysis time _t:  stime_coviddeath2/365.25

Iteration 0:   log pseudolikelihood =  -3842.445
Iteration 1:   log pseudolikelihood = -3835.4462
Iteration 2:   log pseudolikelihood = -3835.3854
Iteration 3:   log pseudolikelihood = -3835.3853
Refining estimates:
Iteration 0:   log pseudolikelihood = -3835.3853

Stratified Cox regr. -- Breslow method for ties

No. of subjects      =       27,126             Number of obs    =      27,126
No. of failures      =          571
Time at risk         =  11482.37645
                                                Wald chi2(14)    =       14.41
Log pseudolikelihood =   -3835.3853             Prob > chi2      =      0.4198

                       (Std. Err. adjusted for 1,203 clusters in household_id)
------------------------------------------------------------------------------
             |               Robust
          _t | Haz. Ratio   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
       1.ldr |    1.02108   .1020238     0.21   0.835     .8394785    1.241966
             |
    agebroad |
     65-<75  |   1.038572   .2679241     0.15   0.883     .6263966    1.721965
        75+  |   1.133349   .4943415     0.29   0.774     .4820461    2.664641
             |
ldr#agebroad |
   1#65-<75  |   1.165371   .2935936     0.61   0.544      .711246    1.909452
      1#75+  |   1.157085    .310036     0.54   0.586     .6843679    1.956326
             |
        age1 |    .997961   .0278011    -0.07   0.942     .9449327    1.053965
        age2 |   1.015284   .0684124     0.23   0.822      .889675    1.158627
        age3 |   .9500432   .1666418    -0.29   0.770      .673657    1.339824
        male |   1.084714   .0878739     1.00   0.315     .9254617     1.27137
             |
 ethnicity_5 |
      Mixed  |   1.158291   .1649058     1.03   0.302     .8762587    1.531099
Asian or ..  |   1.224745   .1611146     1.54   0.123     .9463912    1.584969
      Black  |   1.371899   .1821309     2.38   0.017     1.057592    1.779615
      Other  |   1.059944   .1459947     0.42   0.673     .8091707    1.388436
             |
resid_care~r |   1.513449   .3640901     1.72   0.085     .9444834    2.425164
------------------------------------------------------------------------------
                                                         Stratified by stpcode

.         forvalues k = `lo_`exp'' (1) `hi_`exp'' {
  2.                 capture qui di _b[`k'.`exp']
  3.                 if _rc==0 {
  4.                         post `ldrresults' (`i') ("`out'") ("`exp'")     //
> /
>                                 ("Confounders+Resid")                        
>                    ///
>                                 (`k') (1) (_b[`k'.`exp']) (_se[`k'.`exp'])
  5.                 }               
  6.                 forvalues l = 2 (1) 3 {
  7.                         capture qui di _b[`k'.`exp'#`l'.agebroad]
  8.                         if _rc==0 {
  9.                             lincom `k'.`exp' + `k'.`exp'#`l'.agebroad
 10.                                 post `ldrresults' (`i') ("`out'") ("`exp'"
> )             ///
>                                         ("Confounders+Resid")                
>                            ///
>                                         (`k') (`l') (r(estimate)) (r(se))
 11.                         }
 12.                 }
 13.         }

 ( 1)  0b.ldr + 0b.ldr#2o.agebroad = 0

------------------------------------------------------------------------------
          _t |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
         (1) |          0  (omitted)
------------------------------------------------------------------------------

 ( 1)  0b.ldr + 0b.ldr#3o.agebroad = 0

------------------------------------------------------------------------------
          _t |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
         (1) |          0  (omitted)
------------------------------------------------------------------------------

 ( 1)  1.ldr + 1.ldr#2.agebroad = 0

------------------------------------------------------------------------------
          _t |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
         (1) |   .1739001   .2307057     0.75   0.451    -.2782747    .6260749
------------------------------------------------------------------------------

 ( 1)  1.ldr + 1.ldr#3.agebroad = 0

------------------------------------------------------------------------------
          _t |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
         (1) |   .1667647   .2478242     0.67   0.501    -.3189618    .6524911
------------------------------------------------------------------------------

.         
.         * Confounders with physical comorbidities that are indicators for vac
> cination 
.         stcox i.`exp'##i.agebroad age1 age2 age3 male           ///
>                                 i.ethnicity_5                                
>                    ///
>                                 obese40                                      
>                            ///
>                                 respiratory asthma_severe                    
>            ///
>                                 cardiac af dvt_pe i.diabcat                  
>            ///
>                                 liver stroke tia dementia                    
>            ///
>                                 i.kidneyfn                                   
>                            ///
>                                 spleen transplant dialysis                   
>            ///
>                                 immunosuppression cancerHaem                 
>    ///
>                                 autoimmune ibd cancerExhaem1yr,              
>    ///
>                 strata(stpcode) cluster(household_id) 

         failure _d:  coviddeath2
   analysis time _t:  stime_coviddeath2/365.25

Iteration 0:   log pseudolikelihood = -488.07844
Iteration 1:   log pseudolikelihood = -473.51467
Iteration 2:   log pseudolikelihood = -472.34687
Iteration 3:   log pseudolikelihood = -472.28163
Iteration 4:   log pseudolikelihood =  -472.2795
Iteration 5:   log pseudolikelihood = -472.27892
Iteration 6:   log pseudolikelihood = -472.27871
Iteration 7:   log pseudolikelihood = -472.27863
Iteration 8:   log pseudolikelihood =  -472.2786
Iteration 9:   log pseudolikelihood = -472.27859
Iteration 10:  log pseudolikelihood = -472.27859
Iteration 11:  log pseudolikelihood = -472.27858
Iteration 12:  log pseudolikelihood = -472.27858
Iteration 13:  log pseudolikelihood = -472.27858
Iteration 14:  log pseudolikelihood = -472.27858
Iteration 15:  log pseudolikelihood = -472.27858
Iteration 16:  log pseudolikelihood = -472.27858
Iteration 17:  log pseudolikelihood = -472.27858
Iteration 18:  log pseudolikelihood = -472.27858
Iteration 19:  log pseudolikelihood = -472.27858
Iteration 20:  log pseudolikelihood = -472.27858
Iteration 21:  log pseudolikelihood = -472.27858
Iteration 22:  log pseudolikelihood = -472.27858
Iteration 23:  log pseudolikelihood = -472.27858
Iteration 24:  log pseudolikelihood = -472.27858
Iteration 25:  log pseudolikelihood = -472.27858
Iteration 26:  log pseudolikelihood = -472.27858
Iteration 27:  log pseudolikelihood = -472.27858
Refining estimates:
Iteration 0:   log pseudolikelihood = -472.27858
Iteration 1:   log pseudolikelihood = -472.27858
Iteration 2:   log pseudolikelihood = -472.27858
Iteration 3:   log pseudolikelihood = -472.27858
Iteration 4:   log pseudolikelihood = -472.27858
Iteration 5:   log pseudolikelihood = -472.27858

Stratified Cox regr. -- no ties

No. of subjects      =        5,429             Number of obs    =       5,429
No. of failures      =           96
Time at risk         =  2306.483231
                                                Wald chi2(36)    =     2832.92
Log pseudolikelihood =   -472.27858             Prob > chi2      =      0.0000

                         (Std. Err. adjusted for 949 clusters in household_id)
------------------------------------------------------------------------------
             |               Robust
          _t | Haz. Ratio   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
       1.ldr |   1.287695   .2911934     1.12   0.264     .8266589    2.005856
             |
    agebroad |
     65-<75  |   .3835655   .2619302    -1.40   0.161     .1005933    1.462548
        75+  |   .2621544   .2641974    -1.33   0.184     .0363682    1.889697
             |
ldr#agebroad |
   1#65-<75  |   1.518101   .9860187     0.64   0.520     .4250487    5.422041
      1#75+  |   .9543497   .6931772    -0.06   0.949     .2298531    3.962458
             |
        age1 |   1.071337   .0921907     0.80   0.423     .9050622    1.268159
        age2 |   .8557054   .1715483    -0.78   0.437     .5776687    1.267563
        age3 |   1.568962   .8069493     0.88   0.381     .5725615     4.29935
        male |   .8834612   .1849435    -0.59   0.554     .5861343    1.331612
             |
 ethnicity_5 |
      Mixed  |    2.59054   .9452152     2.61   0.009       1.2671    5.296266
Asian or ..  |   2.212947   .8289692     2.12   0.034     1.061967    4.611379
      Black  |   1.572682   .6231811     1.14   0.253      .723351    3.419264
      Other  |   2.258005   .8464901     2.17   0.030     1.082987    4.707896
             |
     obese40 |   .8957768   .2523951    -0.39   0.696      .515661    1.556092
 respiratory |   .8720303   .2303495    -0.52   0.604     .5196178    1.463454
asthma_sev~e |   .8534362   .3092942    -0.44   0.662     .4194563    1.736422
     cardiac |   .9717832   .2388733    -0.12   0.907     .6002556    1.573267
          af |    .939108   .2283199    -0.26   0.796     .5831333    1.512388
      dvt_pe |   .7206062   .1992927    -1.18   0.236     .4190709    1.239106
             |
     diabcat |
Controlle..  |   1.327715   .3754523     1.00   0.316     .7627834    2.311044
Uncontrol..  |   .6319206   .4524754    -0.64   0.522     .1553012    2.571284
Diabetes,..  |   1.25e-14   9.81e-15   -40.67   0.000     2.66e-15    5.83e-14
             |
       liver |   1.264643   .2889024     1.03   0.304     .8081923    1.978889
      stroke |   .7988844    .242621    -0.74   0.460     .4405287    1.448751
         tia |   .6940925   .1935505    -1.31   0.190      .401843    1.198887
    dementia |   1.061492   .2719515     0.23   0.816     .6424522    1.753849
             |
    kidneyfn |
Stage 3a/..  |   2.399707   1.652465     1.27   0.204     .6223166    9.253478
Stage 4/5..  |   .5869694   .2148776    -1.46   0.146     .2864229    1.202882
             |
      spleen |   1.225992   .2553866     0.98   0.328     .8150299    1.844173
  transplant |   1.272667   .3275065     0.94   0.349     .7685425    2.107473
    dialysis |   1.277868   .5150703     0.61   0.543     .5799519    2.815657
immunosupp~n |   1.061547   .2312719     0.27   0.784     .6926181    1.626989
  cancerHaem |   .8817765   .0871575    -1.27   0.203     .7264791    1.070271
  autoimmune |   .9973375   .2736388    -0.01   0.992     .5825036    1.707598
         ibd |   1.235149   .2949413     0.88   0.376     .7735015    1.972322
cancerExha~r |   2.624957   2.716411     0.93   0.351     .3453543    19.95168
------------------------------------------------------------------------------
                                                         Stratified by stpcode

.         forvalues k = `lo_`exp'' (1) `hi_`exp'' {
  2.                 capture qui di _b[`k'.`exp']
  3.                 if _rc==0 {
  4.                         post `ldrresults' (`i') ("`out'") ("`exp'") ///
>                         ("Confounders+Comorb")                               
>            ///
>                         (`k') (1) (_b[`k'.`exp']) (_se[`k'.`exp'])
  5.                 }
  6.                                 forvalues l = 2 (1) 3 {
  7.                         capture qui di _b[`k'.`exp'#`l'.agebroad]
  8.                         if _rc==0 {
  9.                             lincom `k'.`exp' + `k'.`exp'#`l'.agebroad
 10.                                 post `ldrresults' (`i') ("`out'") ("`exp'"
> )             ///
>                                         ("Confounders+Comorb")               
>                            ///
>                                         (`k') (`l') (r(estimate)) (r(se))
 11.                         }
 12.                 }
 13.         }

 ( 1)  0b.ldr + 0b.ldr#2o.agebroad = 0

------------------------------------------------------------------------------
          _t |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
         (1) |          0  (omitted)
------------------------------------------------------------------------------

 ( 1)  0b.ldr + 0b.ldr#3o.agebroad = 0

------------------------------------------------------------------------------
          _t |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
         (1) |          0  (omitted)
------------------------------------------------------------------------------

 ( 1)  1.ldr + 1.ldr#2.agebroad = 0

------------------------------------------------------------------------------
          _t |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
         (1) |   .6703143    .617463     1.09   0.278     -.539891     1.88052
------------------------------------------------------------------------------

 ( 1)  1.ldr + 1.ldr#3.agebroad = 0

------------------------------------------------------------------------------
          _t |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
         (1) |   .2061288   .6874775     0.30   0.764    -1.141302     1.55356
------------------------------------------------------------------------------

.         
.         * All variables
.         stcox i.`exp'##i.agebroad age1 age2 age3 male           ///
>                                 i.ethnicity_5 imd resid_care_ldr             
>    ///
>                                 obese40                                      
>                            ///
>                                 respiratory asthma_severe                    
>            ///
>                                 cardiac af dvt_pe i.diabcat                  
>            ///
>                                 liver stroke tia dementia                    
>            ///
>                                 i.kidneyfn                                   
>                            ///
>                                 spleen transplant dialysis                   
>            ///
>                                 immunosuppression cancerHaem                 
>    ///
>                                 autoimmune ibd cancerExhaem1yr,              
>    ///
>                                 strata(stpcode) cluster(household_id) 

         failure _d:  coviddeath2
   analysis time _t:  stime_coviddeath2/365.25

Iteration 0:   log pseudolikelihood = -488.07844
Iteration 1:   log pseudolikelihood = -473.09087
Iteration 2:   log pseudolikelihood = -471.89645
Iteration 3:   log pseudolikelihood = -471.82908
Iteration 4:   log pseudolikelihood = -471.82694
Iteration 5:   log pseudolikelihood = -471.82637
Iteration 6:   log pseudolikelihood = -471.82616
Iteration 7:   log pseudolikelihood = -471.82609
Iteration 8:   log pseudolikelihood = -471.82606
Iteration 9:   log pseudolikelihood = -471.82605
Iteration 10:  log pseudolikelihood = -471.82605
Iteration 11:  log pseudolikelihood = -471.82604
Iteration 12:  log pseudolikelihood = -471.82604
Iteration 13:  log pseudolikelihood = -471.82604
Iteration 14:  log pseudolikelihood = -471.82604
Iteration 15:  log pseudolikelihood = -471.82604
Iteration 16:  log pseudolikelihood = -471.82604
Iteration 17:  log pseudolikelihood = -471.82604
Iteration 18:  log pseudolikelihood = -471.82604
Iteration 19:  log pseudolikelihood = -471.82604
Iteration 20:  log pseudolikelihood = -471.82604
Iteration 21:  log pseudolikelihood = -471.82604
Iteration 22:  log pseudolikelihood = -471.82604
Iteration 23:  log pseudolikelihood = -471.82604
Iteration 24:  log pseudolikelihood = -471.82604
Iteration 25:  log pseudolikelihood = -471.82604
Iteration 26:  log pseudolikelihood = -471.82604
Iteration 27:  log pseudolikelihood = -471.82604
Iteration 28:  log pseudolikelihood = -471.82604
Iteration 29:  log pseudolikelihood = -471.82604
Iteration 30:  log pseudolikelihood = -471.82604
Iteration 31:  log pseudolikelihood = -471.82604
Iteration 32:  log pseudolikelihood = -471.82604
Iteration 33:  log pseudolikelihood = -471.82604
Refining estimates:
Iteration 0:   log pseudolikelihood = -471.82604
Iteration 1:   log pseudolikelihood = -471.82604
Iteration 2:   log pseudolikelihood = -471.82604

Stratified Cox regr. -- no ties

No. of subjects      =        5,429             Number of obs    =       5,429
No. of failures      =           96
Time at risk         =  2306.483231
                                                Wald chi2(38)    =     3409.90
Log pseudolikelihood =   -471.82604             Prob > chi2      =      0.0000

                         (Std. Err. adjusted for 949 clusters in household_id)
------------------------------------------------------------------------------
             |               Robust
          _t | Haz. Ratio   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
       1.ldr |   1.286604   .2906207     1.12   0.265     .8263682    2.003161
             |
    agebroad |
     65-<75  |   .3885232   .2659419    -1.38   0.167     .1015721     1.48614
        75+  |   .2634939   .2675532    -1.31   0.189     .0360127    1.927905
             |
ldr#agebroad |
   1#65-<75  |   1.512907    .987848     0.63   0.526     .4207488    5.440034
      1#75+  |   .9724425   .7032436    -0.04   0.969     .2356668    4.012633
             |
        age1 |   1.071698   .0924386     0.80   0.422     .9050087     1.26909
        age2 |   .8555892   .1718472    -0.78   0.437     .5771642    1.268327
        age3 |    1.56706    .806995     0.87   0.383     .5711354    4.299641
        male |   .8863523    .185559    -0.58   0.564     .5880391       1.336
             |
 ethnicity_5 |
      Mixed  |   2.599863    .948292     2.62   0.009     1.271971    5.314025
Asian or ..  |   2.207069   .8330156     2.10   0.036     1.053286    4.624721
      Black  |   1.569715   .6226839     1.14   0.256      .721375    3.415706
      Other  |   2.267749   .8489272     2.19   0.029     1.088803    4.723246
             |
         imd |   1.074008   .1006833     0.76   0.446     .8937406    1.290636
resid_care~r |   .7925278   .3390857    -0.54   0.587     .3426297    1.833175
     obese40 |   .8930785   .2516262    -0.40   0.688     .5141174    1.551376
 respiratory |   .8691341   .2304815    -0.53   0.597     .5168456    1.461547
asthma_sev~e |    .853712   .3096138    -0.44   0.663     .4193803     1.73786
     cardiac |   .9639243   .2369685    -0.15   0.881     .5953686     1.56063
          af |   .9452607   .2299823    -0.23   0.817     .5867512    1.522822
      dvt_pe |   .7209789    .199918    -1.18   0.238     .4186928    1.241508
             |
     diabcat |
Controlle..  |   1.337539   .3781074     1.03   0.304     .7685663    2.327725
Uncontrol..  |   .6398455   .4588441    -0.62   0.534     .1569148    2.609073
Diabetes,..  |   5.92e-16   4.76e-16   -43.61   0.000     1.22e-16    2.86e-15
             |
       liver |   1.273862   .2900997     1.06   0.288     .8152226    1.990529
      stroke |   .7952381   .2422589    -0.75   0.452     .4377133     1.44479
         tia |   .6927901   .1929284    -1.32   0.188     .4013829    1.195761
    dementia |   1.059851   .2702597     0.23   0.820     .6429695    1.747026
             |
    kidneyfn |
Stage 3a/..  |   2.370657   1.557148     1.31   0.189     .6542797    8.589621
Stage 4/5..  |   .5879902   .2159212    -1.45   0.148     .2862811    1.207668
             |
      spleen |   1.224959   .2551135     0.97   0.330     .8144191    1.842448
  transplant |   1.268048   .3289701     0.92   0.360       .76262    2.108449
    dialysis |   1.277446   .5156466     0.61   0.544     .5790971    2.817953
immunosupp~n |   1.060608   .2320164     0.27   0.788     .6907927    1.628403
  cancerHaem |   .8820916   .0872064    -1.27   0.204     .7267101    1.070696
  autoimmune |   .9920587   .2720666    -0.03   0.977     .5795622    1.698145
         ibd |   1.241314   .2968728     0.90   0.366     .7767984    1.983605
cancerExha~r |   2.686366   2.789694     0.95   0.341     .3509322    20.56399
------------------------------------------------------------------------------
                                                         Stratified by stpcode

.         forvalues k = `lo_`exp'' (1) `hi_`exp'' {
  2.                 capture qui di _b[`k'.`exp']
  3.                 if _rc==0 {
  4.                         post `ldrresults' (`i') ("`out'") ("`exp'")     //
> /
>                         ("All")                                              
>                                    ///
>                         (`k') (1) (_b[`k'.`exp']) (_se[`k'.`exp'])
  5.                 }
  6.                                 forvalues l = 2 (1) 3 {
  7.                         capture qui di _b[`k'.`exp'#`l'.agebroad]
  8.                         if _rc==0 {
  9.                             lincom `k'.`exp' + `k'.`exp'#`l'.agebroad
 10.                                 post `ldrresults' (`i') ("`out'") ("`exp'"
> )     ///
>                                         ("All")                              
>                                    ///
>                                         (`k') (`l') (r(estimate)) (r(se))
 11.                         }
 12.                 }
 13.         }

 ( 1)  0b.ldr + 0b.ldr#2o.agebroad = 0

------------------------------------------------------------------------------
          _t |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
         (1) |          0  (omitted)
------------------------------------------------------------------------------

 ( 1)  0b.ldr + 0b.ldr#3o.agebroad = 0

------------------------------------------------------------------------------
          _t |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
         (1) |          0  (omitted)
------------------------------------------------------------------------------

 ( 1)  1.ldr + 1.ldr#2.agebroad = 0

------------------------------------------------------------------------------
          _t |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
         (1) |    .666039   .6222325     1.07   0.284    -.5535143    1.885592
------------------------------------------------------------------------------

 ( 1)  1.ldr + 1.ldr#3.agebroad = 0

------------------------------------------------------------------------------
          _t |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
         (1) |   .2240616   .6847875     0.33   0.744    -1.118097     1.56622
------------------------------------------------------------------------------

. 
. postclose `ldrresults'

. 
. use `ldrfile', clear

. 
. 
. *************************
. *  Tidy output for HRs  *
. *************************
. 
. * Outcome
. rename outcome out

. gen outcome     = 1 if out=="coviddeath"

. replace outcome = 2 if out=="covidadmission"
(0 real changes made)

. replace outcome = 3 if out=="composite"
(0 real changes made)

. 
. label define outcome    1 "COVID-19 death"              ///
>                                                 2 "COVID-19 admission"  ///
>                                                 3 "Composite"

. label values outcome outcome

. drop out

. 
. * Exposure
. rename exposure exp

. gen     exposure = 1 if exp=="ldr"

. replace exposure = 2 if exp=="ldr_cat"
(0 real changes made)

. replace exposure = 3 if exp=="ldr_carecat"
(0 real changes made)

. replace exposure = 4 if exp=="ds"
(0 real changes made)

. replace exposure = 5 if exp=="cp"
(0 real changes made)

. replace exposure = 6 if exp=="ldr_group"
(0 real changes made)

. 
. label define exposure   1 "Learning disability register"        ///
>                                                 2 "LDR Severe vs mild"       
>                    ///
>                                                 3 "LDR by residential care"  
>                    ///
>                                                 4 "Down's syndrome"          
>                            ///
>                                                 5 "Cerebral Palsy"           
>                            ///
>                                                 6 "Combined grouping"        
>                    

. label values exposure exposure                                          

. drop exp

. 
. * Age categories
. label define agebroad   1 "16-<65"              ///
>                                                 2 "65-<75"              ///
>                                                 3 "75+"

. label values agebroad agebroad

. 
. 
. * Categories of exposure
. gen category     = "No"                                         if expcat==0
(15 missing values generated)

. replace category = "Yes"                                        if inlist(exp
> osure, 1, 4, 5) & expcat==1
variable category was str2 now str3
(15 real changes made)

. 
. replace category = "LDR, mild"                          if inlist(exposure, 2
> ) & expcat==1
(0 real changes made)

. replace category = "LDR, profound"                      if inlist(exposure, 2
> ) & expcat==2
(0 real changes made)

. 
. replace category = "LDR, community"             if inlist(exposure, 3) & expc
> at==1
(0 real changes made)

. replace category = "LDR, residential care"      if inlist(exposure, 3) & expc
> at==2
(0 real changes made)

. 
. replace category = "DS but not LDR"             if inlist(exposure, 6) & expc
> at==1
(0 real changes made)

. replace category = "DS and LDR"                         if inlist(exposure, 6
> ) & expcat==2
(0 real changes made)

. replace category = "CP but not LDR"             if inlist(exposure, 6) & expc
> at==3
(0 real changes made)

. replace category = "CP and LDR"                         if inlist(exposure, 6
> ) & expcat==4
(0 real changes made)

. replace category = "LDR with no DS or CP"       if inlist(exposure, 6) & expc
> at==5
(0 real changes made)

. 
. * Model adjustment
. gen     adjustment = 1 if model=="Confounders"
(24 missing values generated)

. replace adjustment = 2 if model=="Confounders+IMD"
(6 real changes made)

. replace adjustment = 3 if model=="Confounders+Resid"
(6 real changes made)

. replace adjustment = 4 if model=="Confounders+Comorb"
(6 real changes made)

. replace adjustment = 5 if model=="All"
(6 real changes made)

. label define adj        1 "Confounders"                                      
>    ///     
>                                         2 "Confounders with IMD"             
>            ///
>                                         3 "Confounders with care"            
>            ///
>                                         4 "Confounders with comorbidities"   
>    ///
>                                         5 "All"

. label values adjustment adj

. drop model

. 
. * Hazard ratio with 95% confidence interval
. gen cl = exp(lnhr - invnorm(0.975)*sehr)

. gen cu = exp(lnhr + invnorm(0.975)*sehr)

. gen hr = exp(lnhr)

. 
. gen hr_ci =   string(round(hr, 0.01)) + " (" ///
>                         + string(round(cl, 0.01)) + ", " ///
>                         + string(round(cu, 0.01)) + ")"

. replace hr_ci = "" if expcat==0
(15 real changes made)

. drop cl cu hr lnhr sehr

. 
. * Put in wide format
. reshape wide hr_ci, i(wave outcome exposure expcat agebroad) j(adjust)
(note: j = 1 2 3 4 5)

Data                               long   ->   wide
-----------------------------------------------------------------------------
Number of obs.                       30   ->       6
Number of variables                   8   ->      11
j variable (5 values)        adjustment   ->   (dropped)
xij variables:
                                  hr_ci   ->   hr_ci1 hr_ci2 ... hr_ci5
-----------------------------------------------------------------------------

. rename hr_ci1 hr_conf

. rename hr_ci2 hr_conf_imd

. rename hr_ci3 hr_conf_resid

. rename hr_ci4 hr_conf_comorb

. 
. 
. order wave outcome exposure agebroad category hr*

. sort wave outcome exposure agebroad expcat

. 
. * Save data
. outsheet using "output/ldcox_inter_wave`i'_`out'_`exp'", replace
(note: file output/ldcox_inter_wave2_coviddeath_ldr.out not found)

. 
. log close
      name:  <unnamed>
       log:  /workspace/logs/AL006_cox_regression_inter_wave2_coviddeath_ldr.lo
> g
  log type:  text
 closed on:  25 Feb 2021, 20:16:50
-------------------------------------------------------------------------------
