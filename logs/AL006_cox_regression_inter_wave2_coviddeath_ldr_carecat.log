-------------------------------------------------------------------------------
      name:  <unnamed>
       log:  /workspace/logs/AL006_cox_regression_inter_wave2_coviddeath_ldr_ca
> recat.log
  log type:  text
 opened on:  25 Feb 2021, 20:19:50

. 
. 
. * Categories of various exposures
. local lo_ldr            = 0

. local hi_ldr            = 1

. local lo_ldr_cat        = 0

. local hi_ldr_cat        = 2

. local hi_ldr            = 1

. local lo_ldr_carecat= 0

. local hi_ldr_carecat= 2

. local lo_ds             = 0

. local hi_ds             = 1

. local lo_cp             = 0

. local hi_cp             = 1

. local lo_ldr_group      = 0

. local hi_ldr_group      = 5

. 
. * Open temporary file to post results
. tempfile ldrfile

. tempname ldrresults

. 
. postfile `ldrresults'   wave str15(outcome) str15(exposure) str20(model)     
>    ///
>                                                 expcat agebroad lnhr sehr usi
> ng `ldrfile'

. 
. 
.         * Open dataset (complete case ethnicity)
.         use "analysis/data_ldanalysis_cohort`i'.dta", clear 
(Analysis dataset, wave 2 (1 Sept 20 - latest), for learning disability work)

.         drop if ethnicity_5>=.
(11,245 observations deleted)

. 
.         * Only keep data for adults
.         keep if child==0
(6,499 observations deleted)

. 
.         
.         /*  Declare data to be survival  */
. 
.         stset stime_`out'`i', fail(`out'`i') scale(365.25)

     failure event:  coviddeath2 != 0 & coviddeath2 < .
obs. time interval:  (0, stime_coviddeath2]
 exit on or before:  failure
    t for analysis:  time/365.25

------------------------------------------------------------------------------
     27,126  total observations
          0  exclusions
------------------------------------------------------------------------------
     27,126  observations remaining, representing
        571  failures in single-record/single-failure data
 11,482.376  total analysis time at risk and under observation
                                                at risk from t =         0
                                     earliest observed entry t =         0
                                          last observed exit t =  .4462697

. 
.         
.                 
.         /*  Fit Cox models  */
.         
.         * Confounder only model
.         stcox i.`exp'##i.agebroad age1 age2 age3 male i.ethnicity_5,    ///
>                 strata(stpcode) cluster(household_id) 

         failure _d:  coviddeath2
   analysis time _t:  stime_coviddeath2/365.25

Iteration 0:   log pseudolikelihood =  -3842.445
Iteration 1:   log pseudolikelihood = -3836.2836
Iteration 2:   log pseudolikelihood = -3836.0913
Iteration 3:   log pseudolikelihood =  -3836.029
Iteration 4:   log pseudolikelihood =  -3836.006
Iteration 5:   log pseudolikelihood = -3835.9976
Iteration 6:   log pseudolikelihood = -3835.9945
Iteration 7:   log pseudolikelihood = -3835.9934
Iteration 8:   log pseudolikelihood = -3835.9929
Iteration 9:   log pseudolikelihood = -3835.9928
Iteration 10:  log pseudolikelihood = -3835.9927
Iteration 11:  log pseudolikelihood = -3835.9927
Iteration 12:  log pseudolikelihood = -3835.9927
Iteration 13:  log pseudolikelihood = -3835.9927
Iteration 14:  log pseudolikelihood = -3835.9927
Iteration 15:  log pseudolikelihood = -3835.9927
Iteration 16:  log pseudolikelihood = -3835.9927
Iteration 17:  log pseudolikelihood = -3835.9927
Iteration 18:  log pseudolikelihood = -3835.9927
Iteration 19:  log pseudolikelihood = -3835.9927
Iteration 20:  log pseudolikelihood = -3835.9927
Iteration 21:  log pseudolikelihood = -3835.9927
Iteration 22:  log pseudolikelihood = -3835.9927
Iteration 23:  log pseudolikelihood = -3835.9927
Iteration 24:  log pseudolikelihood = -3835.9927
Iteration 25:  log pseudolikelihood = -3835.9927
Iteration 26:  log pseudolikelihood = -3835.9927
Iteration 27:  log pseudolikelihood = -3835.9927
Iteration 28:  log pseudolikelihood = -3835.9927
Refining estimates:
Iteration 0:   log pseudolikelihood = -3835.9927
Iteration 1:   log pseudolikelihood = -3835.9927
Iteration 2:   log pseudolikelihood = -3835.9927

Stratified Cox regr. -- Breslow method for ties

No. of subjects      =       27,126             Number of obs    =      27,126
No. of failures      =          571
Time at risk         =  11482.37645
                                                Wald chi2(16)    =    22856.31
Log pseudolikelihood =   -3835.9927             Prob > chi2      =      0.0000

                       (Std. Err. adjusted for 1,203 clusters in household_id)
------------------------------------------------------------------------------
             |               Robust
          _t | Haz. Ratio   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
 ldr_carecat |
LDR, not ..  |   1.038225   .4182441     0.09   0.926     .4713992     2.28662
LDR, in r..  |   1.025503   .1033399     0.25   0.803     .8417081    1.249432
             |
    agebroad |
     65-<75  |   1.039969   .2684288     0.15   0.879     .6270684    1.724749
        75+  |   1.142791   .4984697     0.31   0.760     .4860537    2.686886
             |
 ldr_carecat#|
    agebroad |
LDR, not .. #|
     65-<75  |   8.87e-14   4.23e-14   -63.05   0.000     3.48e-14    2.26e-13
LDR, not .. #|
        75+  |   .9526578   1.044173    -0.04   0.965     .1111646    8.164084
LDR, in r.. #|
     65-<75  |   1.201533   .3032305     0.73   0.467     .7326864    1.970394
LDR, in r.. #|
        75+  |   1.157095   .3134255     0.54   0.590     .6804586    1.967598
             |
        age1 |   .9976237   .0278094    -0.09   0.932     .9445806    1.053646
        age2 |   1.016202   .0685237     0.24   0.812     .8903949    1.159785
        age3 |    .947679   .1663627    -0.31   0.760     .6717922    1.336865
        male |   1.085997    .087991     1.02   0.309     .9265347    1.272905
             |
 ethnicity_5 |
      Mixed  |   1.160975   .1653391     1.05   0.295     .8782127    1.534779
Asian or ..  |    1.22662   .1614578     1.55   0.121     .9476937    1.587641
      Black  |   1.373386   .1823496     2.39   0.017     1.058706    1.781598
      Other  |   1.060721   .1461571     0.43   0.669     .8096803    1.389596
------------------------------------------------------------------------------
                                                         Stratified by stpcode

.         forvalues k = `lo_`exp'' (1) `hi_`exp'' {
  2.                 capture qui di _b[`k'.`exp']
  3.                 if _rc==0 {
  4.                         post `ldrresults' (`i') ("`out'") ("`exp'")       
>       ///
>                                 ("Confounders")                              
>                            ///
>                                 (`k') (1) (_b[`k'.`exp']) (_se[`k'.`exp'])
  5.                 }
  6.                 forvalues l = 2 (1) 3 {
  7.                         capture qui di _b[`k'.`exp'#`l'.agebroad]
  8.                         if _rc==0 {
  9.                             lincom `k'.`exp' + `k'.`exp'#`l'.agebroad
 10.                                 post `ldrresults' (`i') ("`out'") ("`exp'"
> )             ///
>                                         ("Confounders")                      
>                                    ///
>                                         (`k') (`l') (r(estimate)) (r(se))
 11.                         }
 12.                 }
 13.         }

 ( 1)  0b.ldr_carecat + 0b.ldr_carecat#2o.agebroad = 0

------------------------------------------------------------------------------
          _t |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
         (1) |          0  (omitted)
------------------------------------------------------------------------------

 ( 1)  0b.ldr_carecat + 0b.ldr_carecat#3o.agebroad = 0

------------------------------------------------------------------------------
          _t |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
         (1) |          0  (omitted)
------------------------------------------------------------------------------

 ( 1)  1.ldr_carecat + 1.ldr_carecat#2.agebroad = 0

------------------------------------------------------------------------------
          _t |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
         (1) |  -30.01609   .2510189  -119.58   0.000    -30.50808    -29.5241
------------------------------------------------------------------------------

 ( 1)  1.ldr_carecat + 1.ldr_carecat#3.agebroad = 0

------------------------------------------------------------------------------
          _t |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
         (1) |  -.0109871    1.01424    -0.01   0.991    -1.998861    1.976886
------------------------------------------------------------------------------

 ( 1)  2.ldr_carecat + 2.ldr_carecat#2.agebroad = 0

------------------------------------------------------------------------------
          _t |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
         (1) |   .2087815   .2306118     0.91   0.365    -.2432093    .6607724
------------------------------------------------------------------------------

 ( 1)  2.ldr_carecat + 2.ldr_carecat#3.agebroad = 0

------------------------------------------------------------------------------
          _t |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
         (1) |    .171096   .2505031     0.68   0.495     -.319881    .6620731
------------------------------------------------------------------------------

.         
.         * Confounders with deprivation
.         stcox i.`exp'##i.agebroad age1 age2 age3 male i.ethnicity_5 imd, ///
>                 strata(stpcode) cluster(household_id) 

         failure _d:  coviddeath2
   analysis time _t:  stime_coviddeath2/365.25

Iteration 0:   log pseudolikelihood =  -3842.445
Iteration 1:   log pseudolikelihood = -3836.2786
Iteration 2:   log pseudolikelihood = -3836.0863
Iteration 3:   log pseudolikelihood = -3836.0239
Iteration 4:   log pseudolikelihood =  -3836.001
Iteration 5:   log pseudolikelihood = -3835.9925
Iteration 6:   log pseudolikelihood = -3835.9894
Iteration 7:   log pseudolikelihood = -3835.9883
Iteration 8:   log pseudolikelihood = -3835.9879
Iteration 9:   log pseudolikelihood = -3835.9877
Iteration 10:  log pseudolikelihood = -3835.9876
Iteration 11:  log pseudolikelihood = -3835.9876
Iteration 12:  log pseudolikelihood = -3835.9876
Iteration 13:  log pseudolikelihood = -3835.9876
Iteration 14:  log pseudolikelihood = -3835.9876
Iteration 15:  log pseudolikelihood = -3835.9876
Iteration 16:  log pseudolikelihood = -3835.9876
Iteration 17:  log pseudolikelihood = -3835.9876
Iteration 18:  log pseudolikelihood = -3835.9876
Iteration 19:  log pseudolikelihood = -3835.9876
Iteration 20:  log pseudolikelihood = -3835.9876
Iteration 21:  log pseudolikelihood = -3835.9876
Iteration 22:  log pseudolikelihood = -3835.9876
Iteration 23:  log pseudolikelihood = -3835.9876
Iteration 24:  log pseudolikelihood = -3835.9876
Iteration 25:  log pseudolikelihood = -3835.9876
Iteration 26:  log pseudolikelihood = -3835.9876
Iteration 27:  log pseudolikelihood = -3835.9876
Iteration 28:  log pseudolikelihood = -3835.9876
Iteration 29:  log pseudolikelihood = -3835.9876
Iteration 30:  log pseudolikelihood = -3835.9876
Iteration 31:  log pseudolikelihood = -3835.9876
Iteration 32:  log pseudolikelihood = -3835.9876
Iteration 33:  log pseudolikelihood = -3835.9876
Iteration 34:  log pseudolikelihood = -3835.9876
Iteration 35:  log pseudolikelihood = -3835.9876
Iteration 36:  log pseudolikelihood = -3835.9876
Refining estimates:
Iteration 0:   log pseudolikelihood = -3835.9876
Iteration 1:   log pseudolikelihood = -3835.9876
Iteration 2:   log pseudolikelihood = -3835.9876

Stratified Cox regr. -- Breslow method for ties

No. of subjects      =       27,126             Number of obs    =      27,126
No. of failures      =          571
Time at risk         =  11482.37645
                                                Wald chi2(17)    =    36688.97
Log pseudolikelihood =   -3835.9876             Prob > chi2      =      0.0000

                       (Std. Err. adjusted for 1,203 clusters in household_id)
------------------------------------------------------------------------------
             |               Robust
          _t | Haz. Ratio   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
 ldr_carecat |
LDR, not ..  |   1.037835   .4182069     0.09   0.927     .4711152    2.286279
LDR, in r..  |   1.025527   .1033388     0.25   0.802     .8417333    1.249452
             |
    agebroad |
     65-<75  |   1.039972   .2684375     0.15   0.879     .6270605     1.72478
        75+  |   1.143278   .4993416     0.31   0.759      .485712    2.691072
             |
 ldr_carecat#|
    agebroad |
LDR, not .. #|
     65-<75  |   2.98e-17   1.42e-17   -79.82   0.000     1.17e-17    7.57e-17
LDR, not .. #|
        75+  |   .9529326   1.044457    -0.04   0.965     .1112007    8.166143
LDR, in r.. #|
     65-<75  |   1.201236   .3033575     0.73   0.468     .7322646    1.970557
LDR, in r.. #|
        75+  |    1.15652   .3134692     0.54   0.592     .6798902    1.967285
             |
        age1 |   .9976244   .0278081    -0.09   0.932     .9445836    1.053643
        age2 |   1.016207   .0685233     0.24   0.812        .8904    1.159789
        age3 |   .9476545   .1663655    -0.31   0.759      .671765     1.33685
        male |   1.086013   .0879912     1.02   0.308     .9265496     1.27292
             |
 ethnicity_5 |
      Mixed  |    1.16094   .1653256     1.05   0.295     .8781992    1.534711
Asian or ..  |   1.226581   .1614462     1.55   0.121     .9476736    1.587574
      Black  |   1.373211   .1822595     2.39   0.017     1.058672    1.781201
      Other  |   1.060523    .145999     0.43   0.669     .8097254    1.389001
             |
         imd |   .9964857   .0352645    -0.10   0.921     .9297111    1.068056
------------------------------------------------------------------------------
                                                         Stratified by stpcode

.         forvalues k = `lo_`exp'' (1) `hi_`exp'' {
  2.                 capture qui di _b[`k'.`exp']
  3.                 if _rc==0 {
  4.                         post `ldrresults' (`i') ("`out'") ("`exp'")     //
> /
>                                 ("Confounders+IMD")                          
>                    ///
>                                 (`k') (1) (_b[`k'.`exp']) (_se[`k'.`exp'])
  5.                 }       
  6.                 forvalues l = 2 (1) 3 {
  7.                         capture qui di _b[`k'.`exp'#`l'.agebroad]
  8.                         if _rc==0 {
  9.                             lincom `k'.`exp' + `k'.`exp'#`l'.agebroad
 10.                                 post `ldrresults' (`i') ("`out'") ("`exp'"
> )             ///
>                                         ("Confounders+IMD")                  
>                            ///
>                                         (`k') (`l') (r(estimate)) (r(se))
 11.                         }
 12.                 }
 13.         }

 ( 1)  0b.ldr_carecat + 0b.ldr_carecat#2o.agebroad = 0

------------------------------------------------------------------------------
          _t |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
         (1) |          0  (omitted)
------------------------------------------------------------------------------

 ( 1)  0b.ldr_carecat + 0b.ldr_carecat#3o.agebroad = 0

------------------------------------------------------------------------------
          _t |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
         (1) |          0  (omitted)
------------------------------------------------------------------------------

 ( 1)  1.ldr_carecat + 1.ldr_carecat#2.agebroad = 0

------------------------------------------------------------------------------
          _t |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
         (1) |  -38.01643   .2510954  -151.40   0.000    -38.50856   -37.52429
------------------------------------------------------------------------------

 ( 1)  1.ldr_carecat + 1.ldr_carecat#3.agebroad = 0

------------------------------------------------------------------------------
          _t |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
         (1) |  -.0110746   1.014301    -0.01   0.991    -1.999069    1.976919
------------------------------------------------------------------------------

 ( 1)  2.ldr_carecat + 2.ldr_carecat#2.agebroad = 0

------------------------------------------------------------------------------
          _t |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
         (1) |   .2085581   .2307817     0.90   0.366    -.2437658     .660882
------------------------------------------------------------------------------

 ( 1)  2.ldr_carecat + 2.ldr_carecat#3.agebroad = 0

------------------------------------------------------------------------------
          _t |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
         (1) |   .1706218   .2507005     0.68   0.496    -.3207422    .6619858
------------------------------------------------------------------------------

.         
.         * Confounders with residential care
.         stcox i.`exp'##i.agebroad age1 age2 age3 male   ///
>                                 i.ethnicity_5 resid_care_ldr,           ///
>                 strata(stpcode) cluster(household_id) 

         failure _d:  coviddeath2
   analysis time _t:  stime_coviddeath2/365.25

Iteration 0:   log pseudolikelihood =  -3842.445
Iteration 1:   log pseudolikelihood = -3834.5496
Iteration 2:   log pseudolikelihood = -3834.2617
Iteration 3:   log pseudolikelihood = -3834.1991
Iteration 4:   log pseudolikelihood = -3834.1762
Iteration 5:   log pseudolikelihood = -3834.1678
Iteration 6:   log pseudolikelihood = -3834.1647
Iteration 7:   log pseudolikelihood = -3834.1636
Iteration 8:   log pseudolikelihood = -3834.1632
Iteration 9:   log pseudolikelihood =  -3834.163
Iteration 10:  log pseudolikelihood =  -3834.163
Iteration 11:  log pseudolikelihood = -3834.1629
Iteration 12:  log pseudolikelihood = -3834.1629
Iteration 13:  log pseudolikelihood = -3834.1629
Iteration 14:  log pseudolikelihood = -3834.1629
Iteration 15:  log pseudolikelihood = -3834.1629
Iteration 16:  log pseudolikelihood = -3834.1629
Iteration 17:  log pseudolikelihood = -3834.1629
Iteration 18:  log pseudolikelihood = -3834.1629
Iteration 19:  log pseudolikelihood = -3834.1629
Iteration 20:  log pseudolikelihood = -3834.1629
Iteration 21:  log pseudolikelihood = -3834.1629
Iteration 22:  log pseudolikelihood = -3834.1629
Iteration 23:  log pseudolikelihood = -3834.1629
Iteration 24:  log pseudolikelihood = -3834.1629
Iteration 25:  log pseudolikelihood = -3834.1629
Iteration 26:  log pseudolikelihood = -3834.1629
Iteration 27:  log pseudolikelihood = -3834.1629
Iteration 28:  log pseudolikelihood = -3834.1629
Iteration 29:  log pseudolikelihood = -3834.1629
Iteration 30:  log pseudolikelihood = -3834.1629
Refining estimates:
Iteration 0:   log pseudolikelihood = -3834.1629
Iteration 1:   log pseudolikelihood = -3834.1629
Iteration 2:   log pseudolikelihood = -3834.1629

Stratified Cox regr. -- Breslow method for ties

No. of subjects      =       27,126             Number of obs    =      27,126
No. of failures      =          571
Time at risk         =  11482.37645
                                                Wald chi2(17)    =    25966.40
Log pseudolikelihood =   -3834.1629             Prob > chi2      =      0.0000

                       (Std. Err. adjusted for 1,203 clusters in household_id)
------------------------------------------------------------------------------
             |               Robust
          _t | Haz. Ratio   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
 ldr_carecat |
LDR, not ..  |    1.82795   .9559812     1.15   0.249     .6558478    5.094782
LDR, in r..  |    1.00347   .1015715     0.03   0.973     .8228971    1.223667
             |
    agebroad |
     65-<75  |   1.039438   .2682462     0.15   0.881     .6268018     1.72372
        75+  |    1.13267   .4941103     0.29   0.775     .4817031    2.663344
             |
 ldr_carecat#|
    agebroad |
LDR, not .. #|
     65-<75  |   1.20e-14   5.71e-15   -67.26   0.000     4.71e-15    3.05e-14
LDR, not .. #|
        75+  |   .9590708   1.051109    -0.04   0.970     .1119343    8.217474
LDR, in r.. #|
     65-<75  |   1.201959   .3033829     0.73   0.466     .7328928    1.971237
LDR, in r.. #|
        75+  |   1.164442   .3154792     0.56   0.574     .6847061    1.980303
             |
        age1 |   .9981922   .0278168    -0.06   0.948     .9451346    1.054228
        age2 |   1.014701   .0683946     0.22   0.829     .8891267    1.158009
        age3 |   .9513282    .166925    -0.28   0.776     .6744878    1.341796
        male |   1.085387   .0879288     1.01   0.312     .9260351     1.27216
             |
 ethnicity_5 |
      Mixed  |   1.161353    .165419     1.05   0.294     .8784601    1.535346
Asian or ..  |   1.226767   .1614704     1.55   0.120     .9478171    1.587814
      Black  |   1.374174   .1824621     2.39   0.017     1.059302    1.782641
      Other  |   1.062128   .1463844     0.44   0.662     .8107048    1.391525
             |
resid_care~r |   1.799364   .5864731     1.80   0.071     .9499132    3.408428
------------------------------------------------------------------------------
                                                         Stratified by stpcode

.         forvalues k = `lo_`exp'' (1) `hi_`exp'' {
  2.                 capture qui di _b[`k'.`exp']
  3.                 if _rc==0 {
  4.                         post `ldrresults' (`i') ("`out'") ("`exp'")     //
> /
>                                 ("Confounders+Resid")                        
>                    ///
>                                 (`k') (1) (_b[`k'.`exp']) (_se[`k'.`exp'])
  5.                 }               
  6.                 forvalues l = 2 (1) 3 {
  7.                         capture qui di _b[`k'.`exp'#`l'.agebroad]
  8.                         if _rc==0 {
  9.                             lincom `k'.`exp' + `k'.`exp'#`l'.agebroad
 10.                                 post `ldrresults' (`i') ("`out'") ("`exp'"
> )             ///
>                                         ("Confounders+Resid")                
>                            ///
>                                         (`k') (`l') (r(estimate)) (r(se))
 11.                         }
 12.                 }
 13.         }

 ( 1)  0b.ldr_carecat + 0b.ldr_carecat#2o.agebroad = 0

------------------------------------------------------------------------------
          _t |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
         (1) |          0  (omitted)
------------------------------------------------------------------------------

 ( 1)  0b.ldr_carecat + 0b.ldr_carecat#3o.agebroad = 0

------------------------------------------------------------------------------
          _t |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
         (1) |          0  (omitted)
------------------------------------------------------------------------------

 ( 1)  1.ldr_carecat + 1.ldr_carecat#2.agebroad = 0

------------------------------------------------------------------------------
          _t |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
         (1) |   -31.4523   .3995323   -78.72   0.000    -32.23537   -30.66923
------------------------------------------------------------------------------

 ( 1)  1.ldr_carecat + 1.ldr_carecat#3.agebroad = 0

------------------------------------------------------------------------------
          _t |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
         (1) |   .5614049   1.065445     0.53   0.598     -1.52683     2.64964
------------------------------------------------------------------------------

 ( 1)  2.ldr_carecat + 2.ldr_carecat#2.agebroad = 0

------------------------------------------------------------------------------
          _t |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
         (1) |   .1874168   .2311772     0.81   0.418    -.2656822    .6405158
------------------------------------------------------------------------------

 ( 1)  2.ldr_carecat + 2.ldr_carecat#3.agebroad = 0

------------------------------------------------------------------------------
          _t |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
         (1) |   .1557062   .2505364     0.62   0.534    -.3353361    .6467485
------------------------------------------------------------------------------

.         
.         * Confounders with physical comorbidities that are indicators for vac
> cination 
.         stcox i.`exp'##i.agebroad age1 age2 age3 male           ///
>                                 i.ethnicity_5                                
>                    ///
>                                 obese40                                      
>                            ///
>                                 respiratory asthma_severe                    
>            ///
>                                 cardiac af dvt_pe i.diabcat                  
>            ///
>                                 liver stroke tia dementia                    
>            ///
>                                 i.kidneyfn                                   
>                            ///
>                                 spleen transplant dialysis                   
>            ///
>                                 immunosuppression cancerHaem                 
>    ///
>                                 autoimmune ibd cancerExhaem1yr,              
>    ///
>                 strata(stpcode) cluster(household_id) 

         failure _d:  coviddeath2
   analysis time _t:  stime_coviddeath2/365.25

Iteration 0:   log pseudolikelihood = -488.07844
Iteration 1:   log pseudolikelihood = -487.69736
Iteration 2:   log pseudolikelihood = -470.55655
Iteration 3:   log pseudolikelihood = -470.17181
Iteration 4:   log pseudolikelihood = -469.84062
Iteration 5:   log pseudolikelihood = -469.82605
Iteration 6:   log pseudolikelihood = -469.82497
Iteration 7:   log pseudolikelihood = -469.82459
Iteration 8:   log pseudolikelihood = -469.82445
Iteration 9:   log pseudolikelihood =  -469.8244
Iteration 10:  log pseudolikelihood = -469.82438
Iteration 11:  log pseudolikelihood = -469.82437
Iteration 12:  log pseudolikelihood = -469.82437
Iteration 13:  log pseudolikelihood = -469.82437
Iteration 14:  log pseudolikelihood = -469.82437
Iteration 15:  log pseudolikelihood = -469.82437
Iteration 16:  log pseudolikelihood = -469.82437
Iteration 17:  log pseudolikelihood = -469.82437
Iteration 18:  log pseudolikelihood = -469.82437
Iteration 19:  log pseudolikelihood = -469.82437
Iteration 20:  log pseudolikelihood = -469.82437
Iteration 21:  log pseudolikelihood = -469.82437
Iteration 22:  log pseudolikelihood = -469.82437
Iteration 23:  log pseudolikelihood = -469.82437
Iteration 24:  log pseudolikelihood = -469.82437
Iteration 25:  log pseudolikelihood = -469.82437
Iteration 26:  log pseudolikelihood = -469.82437
Iteration 27:  log pseudolikelihood = -469.82437
Iteration 28:  log pseudolikelihood = -469.82437
Iteration 29:  log pseudolikelihood = -469.82437
Iteration 30:  log pseudolikelihood = -469.82437
Iteration 31:  log pseudolikelihood = -469.82437
Iteration 32:  log pseudolikelihood = -469.82437
Iteration 33:  log pseudolikelihood = -469.82437
Iteration 34:  log pseudolikelihood = -469.82437
Refining estimates:
Iteration 0:   log pseudolikelihood = -469.82437
Iteration 1:   log pseudolikelihood = -469.82437
Iteration 2:   log pseudolikelihood = -469.82437
Iteration 3:   log pseudolikelihood = -469.82437

Stratified Cox regr. -- no ties

No. of subjects      =        5,429             Number of obs    =       5,429
No. of failures      =           96
Time at risk         =  2306.483231
                                                Wald chi2(39)    =     8078.70
Log pseudolikelihood =   -469.82437             Prob > chi2      =      0.0000

                         (Std. Err. adjusted for 949 clusters in household_id)
------------------------------------------------------------------------------
             |               Robust
          _t | Haz. Ratio   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
 ldr_carecat |
LDR, not ..  |   2.959194    1.72585     1.86   0.063     .9434937    9.281282
LDR, in r..  |   1.219588   .2819968     0.86   0.391     .7751679    1.918804
             |
    agebroad |
     65-<75  |   .3633848   .2473664    -1.49   0.137     .0957039    1.379761
        75+  |    .229081   .2314449    -1.46   0.145      .031623    1.659489
             |
 ldr_carecat#|
    agebroad |
LDR, not .. #|
     65-<75  |   4.88e-17   4.50e-17   -40.71   0.000     8.00e-18    2.97e-16
LDR, not .. #|
        75+  |   4.603387   5.013924     1.40   0.161      .544458    38.92158
LDR, in r.. #|
     65-<75  |   1.653336    1.07615     0.77   0.440     .4616546    5.921134
LDR, in r.. #|
        75+  |   .7975142   .6281743    -0.29   0.774     .1703243    3.734224
             |
        age1 |   1.078411   .0935301     0.87   0.384     .9098295    1.278229
        age2 |   .8388083   .1692632    -0.87   0.384     .5648053    1.245738
        age3 |   1.669088    .861621     0.99   0.321     .6068336    4.590804
        male |   .8870024   .1869916    -0.57   0.570      .586787    1.340816
             |
 ethnicity_5 |
      Mixed  |   2.611792    .948089     2.64   0.008     1.282182    5.320195
Asian or ..  |   2.211839    .830982     2.11   0.035     1.059155    4.618997
      Black  |   1.592253   .6308596     1.17   0.240     .7324217    3.461489
      Other  |   2.249122   .8399965     2.17   0.030     1.081704    4.676464
             |
     obese40 |   .8942304   .2510935    -0.40   0.691     .5157486    1.550461
 respiratory |   .8472475   .2268493    -0.62   0.536     .5013053    1.431918
asthma_sev~e |    .848678   .3085244    -0.45   0.652     .4161991    1.730552
     cardiac |   .9448309     .23431    -0.23   0.819     .5811166     1.53619
          af |   .9606954   .2332032    -0.17   0.869     .5969824    1.546001
      dvt_pe |   .7301143   .2019708    -1.14   0.255      .424545    1.255619
             |
     diabcat |
Controlle..  |   1.365615   .3868241     1.10   0.271     .7838207    2.379247
Uncontrol..  |   .5862438   .4283251    -0.73   0.465     .1400129    2.454644
Diabetes,..  |   1.41e-16   1.11e-16   -46.32   0.000     3.01e-17    6.60e-16
             |
       liver |   1.279845    .292576     1.08   0.280     .8176559    2.003293
      stroke |   .7944351   .2410221    -0.76   0.448      .438343    1.439802
         tia |   .7041364   .1961973    -1.26   0.208     .4078326    1.215715
    dementia |   1.077379   .2730583     0.29   0.769     .6555927    1.770528
             |
    kidneyfn |
Stage 3a/..  |   1.695027   .9793745     0.91   0.361     .5462083     5.26011
Stage 4/5..  |   .5891231   .2142701    -1.45   0.146     .2888121    1.201702
             |
      spleen |   1.221016   .2543669     0.96   0.338        .8117    1.836737
  transplant |   1.257959   .3215063     0.90   0.369     .7622865    2.075939
    dialysis |   1.284571   .5181571     0.62   0.535     .5826517     2.83209
immunosupp~n |   1.057356   .2307105     0.26   0.798     .6894338    1.621622
  cancerHaem |   .8867917   .0874582    -1.22   0.223     .7309261    1.075895
  autoimmune |    .997113    .271522    -0.01   0.992     .5847299    1.700331
         ibd |   1.246673   .2981008     0.92   0.357     .7802173       1.992
cancerExha~r |   2.691594   2.795947     0.95   0.340     .3514041    20.61636
------------------------------------------------------------------------------
                                                         Stratified by stpcode

.         forvalues k = `lo_`exp'' (1) `hi_`exp'' {
  2.                 capture qui di _b[`k'.`exp']
  3.                 if _rc==0 {
  4.                         post `ldrresults' (`i') ("`out'") ("`exp'") ///
>                         ("Confounders+Comorb")                               
>            ///
>                         (`k') (1) (_b[`k'.`exp']) (_se[`k'.`exp'])
  5.                 }
  6.                                 forvalues l = 2 (1) 3 {
  7.                         capture qui di _b[`k'.`exp'#`l'.agebroad]
  8.                         if _rc==0 {
  9.                             lincom `k'.`exp' + `k'.`exp'#`l'.agebroad
 10.                                 post `ldrresults' (`i') ("`out'") ("`exp'"
> )             ///
>                                         ("Confounders+Comorb")               
>                            ///
>                                         (`k') (`l') (r(estimate)) (r(se))
 11.                         }
 12.                 }
 13.         }

 ( 1)  0b.ldr_carecat + 0b.ldr_carecat#2o.agebroad = 0

------------------------------------------------------------------------------
          _t |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
         (1) |          0  (omitted)
------------------------------------------------------------------------------

 ( 1)  0b.ldr_carecat + 0b.ldr_carecat#3o.agebroad = 0

------------------------------------------------------------------------------
          _t |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
         (1) |          0  (omitted)
------------------------------------------------------------------------------

 ( 1)  1.ldr_carecat + 1.ldr_carecat#2.agebroad = 0

------------------------------------------------------------------------------
          _t |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
         (1) |  -36.47464    .755226   -48.30   0.000    -37.95486   -34.99443
------------------------------------------------------------------------------

 ( 1)  1.ldr_carecat + 1.ldr_carecat#3.agebroad = 0

------------------------------------------------------------------------------
          _t |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
         (1) |   2.611709   .8672314     3.01   0.003     .9119669    4.311452
------------------------------------------------------------------------------

 ( 1)  2.ldr_carecat + 2.ldr_carecat#2.agebroad = 0

------------------------------------------------------------------------------
          _t |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
         (1) |   .7013079   .6160096     1.14   0.255    -.5060486    1.908664
------------------------------------------------------------------------------

 ( 1)  2.ldr_carecat + 2.ldr_carecat#3.agebroad = 0

------------------------------------------------------------------------------
          _t |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
         (1) |  -.0277425   .7531626    -0.04   0.971    -1.503914    1.448429
------------------------------------------------------------------------------

.         
.         * All variables
.         stcox i.`exp'##i.agebroad age1 age2 age3 male           ///
>                                 i.ethnicity_5 imd resid_care_ldr             
>    ///
>                                 obese40                                      
>                            ///
>                                 respiratory asthma_severe                    
>            ///
>                                 cardiac af dvt_pe i.diabcat                  
>            ///
>                                 liver stroke tia dementia                    
>            ///
>                                 i.kidneyfn                                   
>                            ///
>                                 spleen transplant dialysis                   
>            ///
>                                 immunosuppression cancerHaem                 
>    ///
>                                 autoimmune ibd cancerExhaem1yr,              
>    ///
>                                 strata(stpcode) cluster(household_id) 

         failure _d:  coviddeath2
   analysis time _t:  stime_coviddeath2/365.25

Iteration 0:   log pseudolikelihood = -488.07844
Iteration 1:   log pseudolikelihood = -487.16428
Iteration 2:   log pseudolikelihood = -469.69872
Iteration 3:   log pseudolikelihood = -469.30667
Iteration 4:   log pseudolikelihood =  -468.9623
Iteration 5:   log pseudolikelihood = -468.94678
Iteration 6:   log pseudolikelihood = -468.94571
Iteration 7:   log pseudolikelihood = -468.94533
Iteration 8:   log pseudolikelihood = -468.94519
Iteration 9:   log pseudolikelihood = -468.94514
Iteration 10:  log pseudolikelihood = -468.94512
Iteration 11:  log pseudolikelihood = -468.94511
Iteration 12:  log pseudolikelihood = -468.94511
Iteration 13:  log pseudolikelihood = -468.94511
Iteration 14:  log pseudolikelihood = -468.94511
Iteration 15:  log pseudolikelihood = -468.94511
Iteration 16:  log pseudolikelihood = -468.94511
Iteration 17:  log pseudolikelihood = -468.94511
Iteration 18:  log pseudolikelihood = -468.94511
Iteration 19:  log pseudolikelihood = -468.94511
Iteration 20:  log pseudolikelihood = -468.94511
Iteration 21:  log pseudolikelihood = -468.94511
Iteration 22:  log pseudolikelihood = -468.94511
Iteration 23:  log pseudolikelihood = -468.94511
Iteration 24:  log pseudolikelihood = -468.94511
Iteration 25:  log pseudolikelihood = -468.94511
Iteration 26:  log pseudolikelihood = -468.94511
Iteration 27:  log pseudolikelihood = -468.94511
Iteration 28:  log pseudolikelihood = -468.94511
Iteration 29:  log pseudolikelihood = -468.94511
Iteration 30:  log pseudolikelihood = -468.94511
Iteration 31:  log pseudolikelihood = -468.94511
Iteration 32:  log pseudolikelihood = -468.94511
Iteration 33:  log pseudolikelihood = -468.94511
Iteration 34:  log pseudolikelihood = -468.94511
Iteration 35:  log pseudolikelihood = -468.94511
Iteration 36:  log pseudolikelihood = -468.94511
Iteration 37:  log pseudolikelihood = -468.94511
Iteration 38:  log pseudolikelihood = -468.94511
Refining estimates:
Iteration 0:   log pseudolikelihood = -468.94511
Iteration 1:   log pseudolikelihood = -468.94511

Stratified Cox regr. -- no ties

No. of subjects      =        5,429             Number of obs    =       5,429
No. of failures      =           96
Time at risk         =  2306.483231
                                                Wald chi2(41)    =     8951.04
Log pseudolikelihood =   -468.94511             Prob > chi2      =      0.0000

                         (Std. Err. adjusted for 949 clusters in household_id)
------------------------------------------------------------------------------
             |               Robust
          _t | Haz. Ratio   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
 ldr_carecat |
LDR, not ..  |   7.250268   7.284337     1.97   0.049     1.011935    51.94639
LDR, in r..  |   1.188886   .2763952     0.74   0.457     .7537906    1.875123
             |
    agebroad |
     65-<75  |   .3603044   .2488539    -1.48   0.139     .0930603    1.395001
        75+  |   .2150437   .2215559    -1.49   0.136     .0285462    1.619964
             |
 ldr_carecat#|
    agebroad |
LDR, not .. #|
     65-<75  |   6.34e-18   5.87e-18   -42.78   0.000     1.03e-18    3.89e-17
LDR, not .. #|
        75+  |   4.405931   4.774688     1.37   0.171     .5267378    36.85369
LDR, in r.. #|
     65-<75  |   1.612605   1.054802     0.73   0.465      .447464    5.811626
LDR, in r.. #|
        75+  |    .782272   .6155371    -0.31   0.755     .1673335    3.657065
             |
        age1 |   1.082027   .0953653     0.89   0.371     .9103673    1.286054
        age2 |   .8307885   .1709445    -0.90   0.368     .5550674     1.24347
        age3 |   1.718892   .9082255     1.03   0.305     .6102275    4.841781
        male |   .8911723   .1883642    -0.55   0.586      .588906    1.348582
             |
 ethnicity_5 |
      Mixed  |   2.610702   .9486586     2.64   0.008     1.280719     5.32183
Asian or ..  |   2.179674   .8217272     2.07   0.039       1.0411    4.563422
      Black  |   1.582585   .6275283     1.16   0.247     .7275244    3.442598
      Other  |   2.237274   .8334964     2.16   0.031     1.077963    4.643381
             |
         imd |   1.070092   .0994671     0.73   0.466     .8918678    1.283932
resid_care~r |   2.511663    2.12276     1.09   0.276     .4792468    13.16327
     obese40 |   .8946034   .2513801    -0.40   0.692     .5157583    1.551726
 respiratory |   .8492961   .2276434    -0.61   0.542     .5022327    1.436195
asthma_sev~e |   .8545781   .3101624    -0.43   0.665     .4195801    1.740559
     cardiac |   .9493046   .2373825    -0.21   0.835     .5815066    1.549732
          af |    .965726   .2347074    -0.14   0.886     .5997638     1.55499
      dvt_pe |   .7343123   .2034666    -1.11   0.265      .426605    1.263967
             |
     diabcat |
Controlle..  |   1.385407   .3934259     1.15   0.251     .7940623    2.417133
Uncontrol..  |   .5913323   .4312529    -0.72   0.471     .1415985    2.469475
Diabetes,..  |   1.85e-17   1.48e-17   -47.96   0.000     3.82e-18    8.91e-17
             |
       liver |   1.283341   .2937574     1.09   0.276     .8194107    2.009937
      stroke |   .7897031   .2411611    -0.77   0.439     .4340325     1.43683
         tia |   .7007912   .1950844    -1.28   0.202     .4061004    1.209327
    dementia |    1.06492   .2686833     0.25   0.803      .649465    1.746137
             |
    kidneyfn |
Stage 3a/..  |   1.806888   1.127391     0.95   0.343     .5319022    6.138053
Stage 4/5..  |   .5995222   .2181014    -1.41   0.160      .293863     1.22311
             |
      spleen |   1.217701   .2533617     0.95   0.344      .809907    1.830824
  transplant |   1.252007   .3212986     0.88   0.381     .7571213     2.07037
    dialysis |   1.276261   .5148174     0.60   0.545     .5788716    2.813822
immunosupp~n |   1.057212   .2311963     0.25   0.799     .6886799    1.622958
  cancerHaem |   .8883534   .0873529    -1.20   0.229     .7326322    1.077173
  autoimmune |   1.001135   .2730081     0.00   0.997     .5866392    1.708496
         ibd |   1.242138   .2972412     0.91   0.365     .7771039    1.985458
cancerExha~r |   2.654738   2.770768     0.94   0.350     .3432551    20.53177
------------------------------------------------------------------------------
                                                         Stratified by stpcode

.         forvalues k = `lo_`exp'' (1) `hi_`exp'' {
  2.                 capture qui di _b[`k'.`exp']
  3.                 if _rc==0 {
  4.                         post `ldrresults' (`i') ("`out'") ("`exp'")     //
> /
>                         ("All")                                              
>                                    ///
>                         (`k') (1) (_b[`k'.`exp']) (_se[`k'.`exp'])
  5.                 }
  6.                                 forvalues l = 2 (1) 3 {
  7.                         capture qui di _b[`k'.`exp'#`l'.agebroad]
  8.                         if _rc==0 {
  9.                             lincom `k'.`exp' + `k'.`exp'#`l'.agebroad
 10.                                 post `ldrresults' (`i') ("`out'") ("`exp'"
> )     ///
>                                         ("All")                              
>                                    ///
>                                         (`k') (`l') (r(estimate)) (r(se))
 11.                         }
 12.                 }
 13.         }

 ( 1)  0b.ldr_carecat + 0b.ldr_carecat#2o.agebroad = 0

------------------------------------------------------------------------------
          _t |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
         (1) |          0  (omitted)
------------------------------------------------------------------------------

 ( 1)  0b.ldr_carecat + 0b.ldr_carecat#3o.agebroad = 0

------------------------------------------------------------------------------
          _t |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
         (1) |          0  (omitted)
------------------------------------------------------------------------------

 ( 1)  1.ldr_carecat + 1.ldr_carecat#2.agebroad = 0

------------------------------------------------------------------------------
          _t |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
         (1) |  -37.61886   1.085064   -34.67   0.000    -39.74555   -35.49217
------------------------------------------------------------------------------

 ( 1)  1.ldr_carecat + 1.ldr_carecat#3.agebroad = 0

------------------------------------------------------------------------------
          _t |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
         (1) |    3.46399   1.364694     2.54   0.011     .7892387    6.138742
------------------------------------------------------------------------------

 ( 1)  2.ldr_carecat + 2.ldr_carecat#2.agebroad = 0

------------------------------------------------------------------------------
          _t |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
         (1) |   .6508673   .6214177     1.05   0.295     -.567089    1.868824
------------------------------------------------------------------------------

 ( 1)  2.ldr_carecat + 2.ldr_carecat#3.agebroad = 0

------------------------------------------------------------------------------
          _t |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
         (1) |  -.0725361   .7509665    -0.10   0.923    -1.544403    1.399331
------------------------------------------------------------------------------

. 
. postclose `ldrresults'

. 
. use `ldrfile', clear

. 
. 
. *************************
. *  Tidy output for HRs  *
. *************************
. 
. * Outcome
. rename outcome out

. gen outcome     = 1 if out=="coviddeath"

. replace outcome = 2 if out=="covidadmission"
(0 real changes made)

. replace outcome = 3 if out=="composite"
(0 real changes made)

. 
. label define outcome    1 "COVID-19 death"              ///
>                                                 2 "COVID-19 admission"  ///
>                                                 3 "Composite"

. label values outcome outcome

. drop out

. 
. * Exposure
. rename exposure exp

. gen     exposure = 1 if exp=="ldr"
(45 missing values generated)

. replace exposure = 2 if exp=="ldr_cat"
(0 real changes made)

. replace exposure = 3 if exp=="ldr_carecat"
(45 real changes made)

. replace exposure = 4 if exp=="ds"
(0 real changes made)

. replace exposure = 5 if exp=="cp"
(0 real changes made)

. replace exposure = 6 if exp=="ldr_group"
(0 real changes made)

. 
. label define exposure   1 "Learning disability register"        ///
>                                                 2 "LDR Severe vs mild"       
>                    ///
>                                                 3 "LDR by residential care"  
>                    ///
>                                                 4 "Down's syndrome"          
>                            ///
>                                                 5 "Cerebral Palsy"           
>                            ///
>                                                 6 "Combined grouping"        
>                    

. label values exposure exposure                                          

. drop exp

. 
. * Age categories
. label define agebroad   1 "16-<65"              ///
>                                                 2 "65-<75"              ///
>                                                 3 "75+"

. label values agebroad agebroad

. 
. 
. * Categories of exposure
. gen category     = "No"                                         if expcat==0
(30 missing values generated)

. replace category = "Yes"                                        if inlist(exp
> osure, 1, 4, 5) & expcat==1
(0 real changes made)

. 
. replace category = "LDR, mild"                          if inlist(exposure, 2
> ) & expcat==1
(0 real changes made)

. replace category = "LDR, profound"                      if inlist(exposure, 2
> ) & expcat==2
(0 real changes made)

. 
. replace category = "LDR, community"             if inlist(exposure, 3) & expc
> at==1
variable category was str2 now str14
(15 real changes made)

. replace category = "LDR, residential care"      if inlist(exposure, 3) & expc
> at==2
variable category was str14 now str21
(15 real changes made)

. 
. replace category = "DS but not LDR"             if inlist(exposure, 6) & expc
> at==1
(0 real changes made)

. replace category = "DS and LDR"                         if inlist(exposure, 6
> ) & expcat==2
(0 real changes made)

. replace category = "CP but not LDR"             if inlist(exposure, 6) & expc
> at==3
(0 real changes made)

. replace category = "CP and LDR"                         if inlist(exposure, 6
> ) & expcat==4
(0 real changes made)

. replace category = "LDR with no DS or CP"       if inlist(exposure, 6) & expc
> at==5
(0 real changes made)

. 
. * Model adjustment
. gen     adjustment = 1 if model=="Confounders"
(36 missing values generated)

. replace adjustment = 2 if model=="Confounders+IMD"
(9 real changes made)

. replace adjustment = 3 if model=="Confounders+Resid"
(9 real changes made)

. replace adjustment = 4 if model=="Confounders+Comorb"
(9 real changes made)

. replace adjustment = 5 if model=="All"
(9 real changes made)

. label define adj        1 "Confounders"                                      
>    ///     
>                                         2 "Confounders with IMD"             
>            ///
>                                         3 "Confounders with care"            
>            ///
>                                         4 "Confounders with comorbidities"   
>    ///
>                                         5 "All"

. label values adjustment adj

. drop model

. 
. * Hazard ratio with 95% confidence interval
. gen cl = exp(lnhr - invnorm(0.975)*sehr)

. gen cu = exp(lnhr + invnorm(0.975)*sehr)

. gen hr = exp(lnhr)

. 
. gen hr_ci =   string(round(hr, 0.01)) + " (" ///
>                         + string(round(cl, 0.01)) + ", " ///
>                         + string(round(cu, 0.01)) + ")"

. replace hr_ci = "" if expcat==0
(15 real changes made)

. drop cl cu hr lnhr sehr

. 
. * Put in wide format
. reshape wide hr_ci, i(wave outcome exposure expcat agebroad) j(adjust)
(note: j = 1 2 3 4 5)

Data                               long   ->   wide
-----------------------------------------------------------------------------
Number of obs.                       45   ->       9
Number of variables                   8   ->      11
j variable (5 values)        adjustment   ->   (dropped)
xij variables:
                                  hr_ci   ->   hr_ci1 hr_ci2 ... hr_ci5
-----------------------------------------------------------------------------

. rename hr_ci1 hr_conf

. rename hr_ci2 hr_conf_imd

. rename hr_ci3 hr_conf_resid

. rename hr_ci4 hr_conf_comorb

. 
. 
. order wave outcome exposure agebroad category hr*

. sort wave outcome exposure agebroad expcat

. 
. * Save data
. outsheet using "output/ldcox_inter_wave`i'_`out'_`exp'", replace
(note: file output/ldcox_inter_wave2_coviddeath_ldr_carecat.out not found)

. 
. log close
      name:  <unnamed>
       log:  /workspace/logs/AL006_cox_regression_inter_wave2_coviddeath_ldr_ca
> recat.log
  log type:  text
 closed on:  25 Feb 2021, 20:20:05
-------------------------------------------------------------------------------
