---------------------------------------------------------------------------------------------------------------------------------------
      name:  <unnamed>
       log:  C:\Users\emsuewil\Documents\Work\Covid\OpenSAFELY\Absolute_risks\absolute-risks-covid-research\logs/001_clean_input_data.l
> og
  log type:  text
 opened on:  11 Feb 2021, 11:49:57

. 
. 
. forvalues i = 1 (1) 2 {
  2. 
.         * Index date
.         if `i'==1 {
  3.             local index_date = "2020-03-01"
  4.         }
  5.         else if `i'==2 {
  6.             local index_date = "2020-09-01"         
  7.         }
  8.         
.         * Display the input parameter (index date for cohort)
.         noi di "`index_date'"
  9.         local index = date(subinstr("`index_date'", "-", "/", .), "YMD")
 10.         
.         * Import data
.         import delimited output/input_`index_date'.csv, clear
 11. 
. 
.         ****************************************
.         *  Create residential care indicators  *
.         ****************************************
.         
.         * Households with 5+ over 65 and 5+ on learning disability register
.         gen tempold = (age>=65)
 12.         replace tempold = . if age>=.
 13.         gen templdr  = (ldr != "")
 14.         
.         bysort household_id: egen num_old = sum(tempold)
 15.         bysort household_id: egen num_ldr = sum(templdr)
 16.         
.         recode num_old 0/4=0 5/max=1, gen(resid_care_old)
 17.         recode num_ldr 0/4=0 5/max=1, gen(resid_care_ldr)
 18.         drop templdr tempold num_old num_ldr
 19.         
.         order resid_care_old resid_care_ldr, after(household_id)
 20.         
.         
.         
.         ****************************
.         *  Create required cohort  *
.         ****************************
. 
.         di "STARTING COUNT FROM IMPORT:"
 21.         noi count
 22. 
.         * Age: Exclude implausibly ages (below zero and above 105)
.         qui summ age // Should be no missing ages
 23.         noi di "DROPPING AGE>105:" 
 24.         drop if age>105
 25.         noi di "DROPPING AGE<0:" 
 26.         drop if age<0
 27.         assert inrange(age, 0, 105)
 28. 
.         * Sex: Exclude categories other than M and F
.         assert inlist(sex, "M", "F", "I", "U")
 29.         noi di "DROPPING GENDER NOT M/F:" 
 30.         drop if inlist(sex, "I", "U")
 31. 
.         * Sustainability and Transformation Partnership (geographic area):
.         *   Exclude if missing
.         noi di "DROPPING IF STP MISSING:"
 32.         drop if stp==""
 33. 
.         * Index of Multiple Deprivation: Exclude if missing 
.         noi di "DROPPING IF NO IMD" 
 34.         capture confirm string var imd 
 35.         if _rc==0 {
 36.                 drop if imd==""
 37.         }
 38.         else {
 39.                 drop if imd>=.
 40.                 drop if imd==-1
 41.         }
 42. 
. 
.         * People who had an event prior to our start date
.         * (this should not occur (much) in the real data)
.         noi di "DROPPING IF DIED BEFORE INDEX DATE" 
 43.         confirm string variable died_date_ons
 44.         gen temp = date(died_date_ons, "YMD")
 45.         drop if temp < `index'
 46.         drop temp
 47. 
. 
. 
. 
.         ***********************************************
.         *  Convert strings to dates (for covariates)  *
.         ***********************************************
. 
.         foreach var of varlist  cf                                                              ///
>                                                         respiratory                                             ///
>                                                         cardiac                                                 ///
>                                                         hypertension                                    ///
>                                                         af                                                              ///
>                                                         dvt_pe                                                  ///
>                                                         pad_surg                                                ///
>                                                         amputate                                                ///
>                                                         diabetes                                                ///
>                                                         tia                                                             ///
>                                                         stroke                                                  ///
>                                                         dementia                                                ///
>                                                         neuro                                                   ///
>                                                         lung_cancer                                     ///
>                                                         haem_cancer                                             ///
>                                                         other_cancer                                    ///
>                                                         liver                                                   ///
>                                                         transplant_notkidney                    ///     
>                                                         transplant_kidney                               ///
>                                                         dialysis                                                ///
>                                                         dysplenia                                               ///
>                                                         sickle_cell                                     ///
>                                                         hiv                                                     ///
>                                                         perm_immuno                                             ///
>                                                         aplastic_anaemia                                ///
>                                                         temp_immuno                                             ///
>                                                         autoimmune                                              ///
>                                                         ibd                                                     ///
>                                                         fracture                                                ///
>                                                         smi                                                     ///
>                                                         ldr                                                             ///
>                                                         ld_profound                                     ///
>                                                         ds                                                              ///
>                                                         cp                                                              ///
>                                                         {
 48.                 capture confirm string variable `var'
 49.                 if _rc!=0 {
 50.                         assert `var'==.
 51.                         rename `var' `var'_date
 52.                 }
 53.                 else {
 54.                         replace `var' = `var' + "-15"
 55.                         rename `var' `var'_dstr
 56.                         replace `var'_dstr = " " if `var'_dstr == "-15"
 57.                         gen `var'_date = date(`var'_dstr, "YMD") 
 58.                         order `var'_date, after(`var'_dstr)
 59.                         drop `var'_dstr
 60.                 }
 61.                 format `var'_date %td
 62.         }
 63. 
. 
. 
. 
. 
. 
.         **********************
.         *  Recode variables  *
.         **********************
. 
. 
.         /*  Demographics  */
. 
.         * Check there are no missing ages
.         assert age<.
 64. 
.         * Sex
.         assert inlist(sex, "M", "F")
 65.         gen male = (sex=="M")
 66.         drop sex
 67. 
. 
.         * Smoking
.         label define smoke 1 "Never" 2 "Former" 3 "Current" .u "Unknown (.u)"
 68. 
.         gen     smoke = 1  if smoking_status=="N"
 69.         replace smoke = 2  if smoking_status=="E"
 70.         replace smoke = 3  if smoking_status=="S"
 71.         replace smoke = .u if smoking_status=="M"
 72.         replace smoke = .u if smoking_status==""
 73.         label values smoke smoke
 74.         drop smoking_status 
 75. 
. 
. 
.         * Ethnicity (5 category)
.         rename ethnicity ethnicity_5
 76.         replace ethnicity_5 = .u if ethnicity_5==.
 77.         label define ethnicity  1 "White"                                                               ///
>                                                         2 "Mixed"                                                               ///
>                                                         3 "Asian or Asian British"                              ///
>                                                         4 "Black"                                                               ///
>                                                         5 "Other"                                                               ///
>                                                         .u "Unknown"
 78.         label values ethnicity_5 ethnicity
 79. 
.         * Ethnicity (16 category)
.         replace ethnicity_16 = .u if ethnicity_5>=.
 80.         replace ethnicity_16 = .u if ethnicity_16>=.
 81.         label define ethnicity_16                                                                               ///
>                                                         1 "British or Mixed British"                    ///
>                                                         2 "Irish"                                                               ///
>                                                         3 "Other White"                                                 ///
>                                                         4 "White + Black Caribbean"                     ///
>                                                         5 "White + Black African"                               ///
>                                                         6 "White + Asian"                                               ///
>                                                         7 "Other mixed"                                                 ///
>                                                         8 "Indian or British Indian"                    ///
>                                                         9 "Pakistani or British Pakistani"              ///
>                                                         10 "Bangladeshi or British Bangladeshi" ///
>                                                         11 "Other Asian"                                                ///
>                                                         12 "Caribbean"                                                  ///
>                                                         13 "African"                                                    ///
>                                                         14 "Other Black"                                                ///
>                                                         15 "Chinese"                                                    ///
>                                                         16 "Other"                                                              ///
>                                                         .u "Unknown"  
 82.         label values ethnicity_16 ethnicity_16
 83.         drop ethnicity_date ethnicity_16_date
 84. 
. 
. 
.         /* BMI */
. 
. 
.         * For adults
.         replace bmi_adult = . if age<16
 85. 
.         * For children  
.         capture confirm string variable bmi_child_date_measured
 86.         if _rc!=0 {
 87.                 assert bmi_child_date_measured==.
 88.                 rename bmi_child_date_measured bmi_child_date_measured_date
 89.         }
 90.         else {
 91.                 replace bmi_child_date_measured = bmi_child_date_measured + "-15"
 92.                 rename bmi_child_date_measured bmi_child_date_measured_dstr
 93.                 replace bmi_child_date_measured_dstr = " " if bmi_child_date_measured_dstr == "-15"
 94.                 gen bmi_child_date_measured_date = date(bmi_child_date_measured_dstr, "YMD") 
 95.                 order bmi_child_date_measured_date, after(bmi_child_date_measured_dstr)
 96.                 drop bmi_child_date_measured_dstr
 97.         }
 98.         format bmi_child_date_measured_date %td
 99.         replace bmi_child                                        = . if age>=16
100.         replace bmi_child_date_measured_date = . if age>=16
101. 
.         * Combine BMI measurements
.         noi summ bmi_adult bmi_child 
102.         gen     bmi = bmi_adult if age>=16
103.         replace bmi = bmi_child if age<16
104.         replace bmi = . if !inrange(bmi, 15, 50)
105.         order bmi, after(bmi_adult)
106.         drop bmi_adult bmi_child
107. 
. 
. 
.         /*  Geographical location  */
. 
. 
.         * STP 
.         rename stp stpcode
108.         bysort stpcode: gen stp = 1 if _n==1
109.         replace stp = sum(stp)
110.         order stp, after(stpcode)
111. 
.         * Region
.         gen     region_7 = 1 if region=="East"
112.         replace region_7 = 2 if region=="London"
113.         replace region_7 = 3 if region=="East Midlands" 
114.         replace region_7 = 3 if region=="West Midlands"
115.         replace region_7 = 4 if region=="North East" 
116.         replace region_7 = 4 if region=="Yorkshire and The Humber"
117.         replace region_7 = 5 if region=="North West"
118.         replace region_7 = 6 if region=="South East"
119.         replace region_7 = 7 if region=="South West"
120. 
.         label define region_7   1 "East"                                                        ///
>                                                         2 "London"                                                      ///
>                                                         3 "Midlands"                                            ///
>                                                         4 "North East and Yorkshire"            ///
>                                                         5 "North West"                                          ///
>                                                         6 "South East"                                          ///     
>                                                         7 "South West"
121.         label values region_7 region_7
122.         label var region_7 "Region of England (7 regions)"
123.         drop region
124. 
. 
.         *  Rural-urban classification 
.         capture confirm string var rural_urban 
125.         if _rc==0 {
126.                 assert inlist(rural_urban, "rural", "urban", "")
127.                 replace rural_urban = "urban" if !inlist(rural_urban, "rural", "urban")
128. 
.                 gen rural = rural_urban=="rural"
129.                 order rural, after(rural_urban)
130.                 drop rural_urban
131.         }
132.         else {
133.                 recode rural_urban -1 0=.
134.                 bysort stp: egen ru_mode=mode(rural_urban)
135.                 replace rural_urban = ru_mode if rural_urban>=.
136.                 drop ru_mode
137.                 
.                 * Categorise
.                 recode rural_urban 1/4=0 5/8=1, gen(rural)
138.                 order rural, after(rural_urban)
139.                 drop rural_urban
140.         }
141. 
. 
.         *  IMD 
.         rename imd imd_order
142. 
. 
. 
. 
.         /*  Asthma  */
. 
.         label define asthmacat  1 "No"                          ///
>                                                         2 "Yes, no OCS"         ///
>                                                         3 "Yes with OCS"
143. 
.         * Asthma  (coded: 0 No, 1 Yes no OCS, 2 Yes with OCS)
.         rename asthma_severity asthmacat
144.         recode asthmacat 0=1 1=2 2=3
145.         label values asthmacat asthmacat
146. 
. 
. 
. 
.         ************
.         *   eGFR   *
.         ************
. 
.         * Set implausible creatinine values to missing (Note: zero changed to missing)
.         replace creatinine = . if !inrange(creatinine, 20, 3000) 
147. 
.         * Divide by 88.4 (to convert umol/l to mg/dl)
.         gen SCr_adj = creatinine/88.4
148. 
.         gen     min = .
149.         replace min = SCr_adj/0.7       if male==0
150.         replace min = SCr_adj/0.9       if male==1
151.         replace min = min^-0.329        if male==0
152.         replace min = min^-0.411        if male==1
153.         replace min = 1                         if min<1
154. 
.         gen     max = .
155.         replace max = SCr_adj/0.7       if male==0
156.         replace max = SCr_adj/0.9       if male==1
157.         replace max = max^-1.209
158.         replace max = 1                         if max>1
159. 
.         gen     egfr = min*max*141
160.         replace egfr = egfr*(0.993^age)
161.         replace egfr = egfr*1.018 if male==0
162. 
.         replace egfr = . if creatinine==. 
163. 
.         * Delete variables no longer needed
.         drop min max SCr_adj creatinine 
164. 
. 
.          
.                 
.         ****************************************
.         *   Hba1c:  Level of diabetic control  *
.         ****************************************
. 
.         * Set zero or negative to missing
.         replace hba1c_percentage   = . if hba1c_percentage   <= 0
165.         replace hba1c_mmol_per_mol = . if hba1c_mmol_per_mol <= 0
166. 
. 
.         /* Express  HbA1c as percentage  */ 
. 
.         * Express all values as perecentage 
.         noi summ hba1c_percentage hba1c_mmol_per_mol
167.         gen     hba1c_pct = hba1c_percentage 
168.         replace hba1c_pct = (hba1c_mmol_per_mol/10.929) + 2.15  ///
>                                 if hba1c_mmol_per_mol<. 
169. 
.         * Valid % range between 0-20  
.         replace hba1c_pct = . if !inrange(hba1c_pct, 0, 20) 
170.         replace hba1c_pct = round(hba1c_pct, 0.1)
171. 
. 
.         * Delete unneeded variables
.         drop hba1c_percentage hba1c_mmol_per_mol 
172. 
. 
. 
. 
.         ********************************
.         *  Outcomes and survival time  *
.         ********************************
. 
. 
.         /*   Outcomes   */
. 
.         * Format ONS death date
.         confirm string variable died_date_ons
173.         rename died_date_ons died_date_ons_dstr
174.         gen died_date_ons = date(died_date_ons_dstr, "YMD")
175.         format died_date_ons %td
176.         drop died_date_ons_dstr
177. 
.         * Date of Covid death in ONS
.         gen coviddeath_date = died_date_ons if died_ons_covid_flag_any==1
178.         gen otherdeath_date = died_date_ons if died_ons_covid_flag_any!=1
179.         drop died_date_ons
180.         format coviddeath_date otherdeath_date %td
181. 
.         * Delete unneeded variables
.         drop died_ons_covid_flag_any 
182. 
.         * COVID-19 admission
.         confirm string variable covid_admission_date
183.         rename covid_admission_date covid_admission_date_dstr
184.         gen covidadmission_date = date(covid_admission_date_dstr, "YMD")
185.         format covidadmission_date %td
186.         drop covid_admission_date_dstr
187.         
.         * SGSS positive test
.         confirm string variable sgss_first_positive_test_date
188.         gen covidpostest_date = date(sgss_first_positive_test_date, "YMD")
189.         format covidpostest_date %td
190.         drop sgss_first_positive_test_date
191. 
.         
.         
.         
. 
.         *********************
.         *  Label variables  *
.         *********************
. 
. 
.         * Demographics
.         label var patient_id                            "Patient ID"
192.         label var age                                           "Age (years)"
193.         label var male                                          "Male"
194.         label var imd_order                             "Ranking of index of Multiple Deprivation (IMD)"
195.         label var ethnicity_16                          "Ethnicity in 16 categories"
196.         label var ethnicity_5                           "Ethnicity in 5 categories"
197.         label var stp                                           "Sustainability and Transformation Partnership"
198.         label var stpcode                                       "Sustainability and Transformation Partnership"
199.         label var region_7                                      "Geographical region (7 England regions)"
200.         label var rural                                         "Rural/urban binary classification"
201.         label var household_id                          "Household ID"
202.         label var household_size                        "Household size"
203.         label var resid_care_old                        "Residential care, elderly"
204.         label var resid_care_ldr                        "Residential care, learning disability"
205. 
.         label var smoke                                         "Smoking status"
206.         label var bmi                                           "Body Mass Index (BMI, kg/m2)"
207.         label var bmi_child_date_measured_date "Date BMI measured (if age<16)"
208. 
. 
.         * Clinical measurements
.         label var bp_sys                                        "Systolic blood pressure"
209.         label var bp_sys_date                           "Systolic blood pressure, date"
210.         label var bp_dias                                       "Diastolic blood pressure"
211.         label var bp_dias_date                          "Diastolic blood pressure, date"
212.         label var egfr                                          "Estimated globular filtration rate"
213.         label var hba1c_pct                                     "Hba1c percentage"
214.         label var asthmacat                                     "Asthma"
215. 
.         * Dates of comorbidities        
.         label var cf_date                                       "Cystic fibrosis, date"
216.         label var respiratory_date                      "Respiratory disease (excl. asthma), date"
217.         label var cardiac_date                          "Heart disease, date"
218.         label var af_date                                       "Atrial fibrillation, date"
219.         label var dvt_pe_date                           "Deep vein thrombosis/pulmonary embolism, date"
220.         label var pad_surg_date                         "Surgery for peripheral arterial disease, date"
221.         label var amputate_date                         "Limb amputation, date"
222.         label var diabetes_date                         "Diabetes, date"
223.         label var hypertension_date                     "Date of diagnosed hypertension"
224.         label var tia_date                                      "Transient ischemic attack, date"
225.         label var stroke_date                           "Stroke, date"
226.         label var dementia_date                         "Dementia, date"
227.         label var neuro_date                            "Neuro condition other than stroke/dementia, date"      
228.         label var lung_cancer_date                      "Lung cancer, date"
229.         label var other_cancer_date                     "Other cancer, date"
230.         label var haem_cancer_date                      "Haematological malignancy, date"
231.         label var liver_date                            "Liver, date"
232.         label var dialysis_date                         "Dialysis, date"
233.         label var transplant_kidney_date        "Kidney transplant recipient, date"
234.         label var transplant_notkidney_date     "Organ (not kidney) transplant recipient, date"
235.         label var dysplenia_date                        "Dysplenia, date"
236.         label var sickle_cell_date                      "Sickle cell, date"
237.         label var aplastic_anaemia_date         "Aplastic anaemia, date"
238.         label var autoimmune_date                       "RA, SLE, Psoriasis (autoimmune disease), date"
239.         label var hiv_date                                      "HIV, date"
240.         label var perm_immuno_date                      "Conditions causing permanent immunosuppression, date"
241.         label var temp_immuno_date                      "Conditions causing temporary immunosuppression, date"
242.         label var ibd_date                                      "IBD, date"
243.         label var fracture_date                         "Fracture, date"
244.         label var smi_date                                      "Serious mental illness, date"
245.         label var ldr_date                                      "Learning disability register, date"
246.         label var ld_profound_date                      "Profound/severe learning disability, date"
247.         label var ds_date                                       "Down's Syndrome, date"
248.         label var cp_date                                       "Cerebral Palsy, date"
249.          
. 
. 
.         * Outcomes 
.         label var  coviddeath_date                      "Date of ONS COVID-19 death"
250.         label var  otherdeath_date                      "Date of ONS non-COVID-19 death"
251.         label var  covidadmission_date          "Date of COVID-19 hospital admission"
252.         label var  covidpostest_date            "SGSS first positive test"
253. 
.         
. 
.         *********************
.         *  Order variables  *
.         *********************
. 
.         sort patient_id
254.         order   patient_id stp* region_7 imd* rural                                             ///
>                         household* resid_care_old resid_care_ldr                                        ///
>                         age male                                                                                                     
>    ///
>                         bmi* smoke*                                                                                             ///
>                         ethnicity*                                                                                                   
>    /// 
>                         respiratory* asthma* cf* cardiac* diabetes* hba1c*                      ///
>                         bp_sys bp_sys_date bp_dias bp_dias_date                                         ///
>                         hypertension*                                                                                           ///
>                         af* dvt_pe* pad* amputate*                                                                      ///
>                         stroke* dementia* neuro* tia*                                                           ///
>                         lung_cancer* haem_cancer* other_cancer*                                         ///     
>                         transplant_kidney* dialysis* liver* transplant_notkidney*       ///
>                         dysplenia* sickle* hiv* perm* temp* aplastic*                           ///
>                         autoimmune* ibd* smi* fracture*                                                         ///
>                         smi* ld* fracture*                                                                                      ///
>                         coviddeath_date otherdeath_date covidadmission_date                     ///
>                         covidpostest_date
255. 
. 
. 
. 
.                         
. 
.         ***************
.         *  Save data  *
.         ***************
. 
.         sort patient_id
256.         if "`index_date'" == "2020-03-01" {
257.                 label data "Base cohort dataset (wave 1), index date 1st March 2020"
258.                 save "analysis/data_base_cohort1.dta", replace
259.         }
260.         else if "`index_date'" == "2020-09-01" {
261.                 label data "Base cohort dataset (wave 2), index date 1st September 2020"
262.                 save "analysis/data_base_cohort2.dta", replace
263.         }
264. 
. }
2020-03-01
(63 vars, 1,000 obs)
(0 real changes made)
(395 differences between num_old and resid_care_old)
(643 differences between num_ldr and resid_care_ldr)
STARTING COUNT FROM IMPORT:
  1,000
DROPPING AGE>105:
(0 observations deleted)
DROPPING AGE<0:
(0 observations deleted)
DROPPING GENDER NOT M/F:
(0 observations deleted)
DROPPING IF STP MISSING:
(0 observations deleted)
DROPPING IF NO IMD
(0 observations deleted)
(0 observations deleted)
DROPPING IF DIED BEFORE INDEX DATE
(800 missing values generated)
(0 observations deleted)
variable cf was str7 now str10
(1,000 real changes made)
(804 real changes made)
(804 missing values generated)
variable respiratory was str7 now str10
(1,000 real changes made)
(802 real changes made)
(802 missing values generated)
variable cardiac was str7 now str10
(1,000 real changes made)
(803 real changes made)
(803 missing values generated)
variable hypertension was str7 now str10
(1,000 real changes made)
(806 real changes made)
(806 missing values generated)
variable af was str7 now str10
(1,000 real changes made)
(802 real changes made)
(802 missing values generated)
variable dvt_pe was str7 now str10
(1,000 real changes made)
(805 real changes made)
(805 missing values generated)
variable pad_surg was str7 now str10
(1,000 real changes made)
(800 real changes made)
(800 missing values generated)
variable amputate was str7 now str10
(1,000 real changes made)
(802 real changes made)
(802 missing values generated)
variable diabetes was str7 now str10
(1,000 real changes made)
(802 real changes made)
(802 missing values generated)
variable tia was str7 now str10
(1,000 real changes made)
(804 real changes made)
(804 missing values generated)
variable stroke was str7 now str10
(1,000 real changes made)
(803 real changes made)
(803 missing values generated)
variable dementia was str7 now str10
(1,000 real changes made)
(803 real changes made)
(803 missing values generated)
variable neuro was str7 now str10
(1,000 real changes made)
(802 real changes made)
(802 missing values generated)
variable lung_cancer was str7 now str10
(1,000 real changes made)
(803 real changes made)
(803 missing values generated)
variable haem_cancer was str7 now str10
(1,000 real changes made)
(803 real changes made)
(803 missing values generated)
variable other_cancer was str7 now str10
(1,000 real changes made)
(805 real changes made)
(805 missing values generated)
variable liver was str7 now str10
(1,000 real changes made)
(805 real changes made)
(805 missing values generated)
variable transplant_notkidney was str7 now str10
(1,000 real changes made)
(806 real changes made)
(806 missing values generated)
variable transplant_kidney was str7 now str10
(1,000 real changes made)
(803 real changes made)
(803 missing values generated)
variable dialysis was str7 now str10
(1,000 real changes made)
(808 real changes made)
(808 missing values generated)
variable dysplenia was str7 now str10
(1,000 real changes made)
(801 real changes made)
(801 missing values generated)
variable sickle_cell was str7 now str10
(1,000 real changes made)
(805 real changes made)
(805 missing values generated)
variable hiv was str7 now str10
(1,000 real changes made)
(806 real changes made)
(806 missing values generated)
variable perm_immuno was str7 now str10
(1,000 real changes made)
(802 real changes made)
(802 missing values generated)
variable aplastic_anaemia was str7 now str10
(1,000 real changes made)
(998 real changes made)
(998 missing values generated)
variable temp_immuno was str7 now str10
(1,000 real changes made)
(991 real changes made)
(991 missing values generated)
variable autoimmune was str7 now str10
(1,000 real changes made)
(807 real changes made)
(807 missing values generated)
variable ibd was str7 now str10
(1,000 real changes made)
(803 real changes made)
(803 missing values generated)
variable fracture was str7 now str10
(1,000 real changes made)
(995 real changes made)
(995 missing values generated)
variable smi was str7 now str10
(1,000 real changes made)
(802 real changes made)
(802 missing values generated)
variable ldr was str7 now str10
(1,000 real changes made)
(608 real changes made)
(608 missing values generated)
variable ld_profound was str7 now str10
(1,000 real changes made)
(801 real changes made)
(801 missing values generated)
variable ds was str7 now str10
(1,000 real changes made)
(804 real changes made)
(804 missing values generated)
variable cp was str7 now str10
(1,000 real changes made)
(807 real changes made)
(807 missing values generated)
(948 missing values generated)
(15 real changes made)
(115 real changes made)
(18 real changes made, 18 to missing)
(800 real changes made, 800 to missing)
(250 real changes made, 250 to missing)
(250 real changes made, 250 to missing)
(195 real changes made, 195 to missing)
(203 real changes made, 203 to missing)
variable bmi_child_date_measured was str7 now str10
(1,000 real changes made)
(50 real changes made)
(50 missing values generated)
(797 real changes made, 797 to missing)
(759 real changes made, 759 to missing)

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
   bmi_adult |        797    33.12665     11.9984  -.1307325     59.823
   bmi_child |        203    32.82115    12.94715          0   73.42787
(203 missing values generated)
(203 real changes made)
(131 real changes made, 131 to missing)
(969 missing values generated)
(999 real changes made)
(899 missing values generated)
(204 real changes made)
(211 real changes made)
(100 real changes made)
(100 real changes made)
(103 real changes made)
(100 real changes made)
(81 real changes made)
(0 real changes made)
(rural_urban: 29 changes made)
(29 real changes made)
(1000 differences between rural_urban and rural)
(asthmacat: 200 changes made)
(54 real changes made, 54 to missing)
(54 missing values generated)
(1,000 missing values generated)
(491 real changes made)
(455 real changes made)
(491 real changes made)
(455 real changes made)
(273 real changes made)
(1,000 missing values generated)
(491 real changes made)
(455 real changes made)
(946 real changes made)
(727 real changes made)
(54 missing values generated)
(933 real changes made)
(491 real changes made)
(0 real changes made)
(58 real changes made, 58 to missing)
(72 real changes made, 72 to missing)

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
hba1c_perc~e |        942    5.024326    1.956973   .1241322   11.11007
hba1c_mmol~l |        928    41.16155    18.88956   .0039162   103.7383
(58 missing values generated)
(928 real changes made)
(0 real changes made)
(996 real changes made)
(800 missing values generated)
(959 missing values generated)
(841 missing values generated)
(800 missing values generated)
(800 missing values generated)
(note: file analysis/data_base_cohort1.dta not found)
file analysis/data_base_cohort1.dta saved
2020-09-01
(63 vars, 1,000 obs)
(0 real changes made)
(352 differences between num_old and resid_care_old)
(629 differences between num_ldr and resid_care_ldr)
STARTING COUNT FROM IMPORT:
  1,000
DROPPING AGE>105:
(0 observations deleted)
DROPPING AGE<0:
(0 observations deleted)
DROPPING GENDER NOT M/F:
(0 observations deleted)
DROPPING IF STP MISSING:
(0 observations deleted)
DROPPING IF NO IMD
(0 observations deleted)
(0 observations deleted)
DROPPING IF DIED BEFORE INDEX DATE
(800 missing values generated)
(107 observations deleted)
variable cf was str7 now str10
(893 real changes made)
(713 real changes made)
(713 missing values generated)
variable respiratory was str7 now str10
(893 real changes made)
(717 real changes made)
(717 missing values generated)
variable cardiac was str7 now str10
(893 real changes made)
(715 real changes made)
(715 missing values generated)
variable hypertension was str7 now str10
(893 real changes made)
(713 real changes made)
(713 missing values generated)
variable af was str7 now str10
(893 real changes made)
(723 real changes made)
(723 missing values generated)
variable dvt_pe was str7 now str10
(893 real changes made)
(726 real changes made)
(726 missing values generated)
variable pad_surg was str7 now str10
(893 real changes made)
(720 real changes made)
(720 missing values generated)
variable amputate was str7 now str10
(893 real changes made)
(712 real changes made)
(712 missing values generated)
variable diabetes was str7 now str10
(893 real changes made)
(722 real changes made)
(722 missing values generated)
variable tia was str7 now str10
(893 real changes made)
(721 real changes made)
(721 missing values generated)
variable stroke was str7 now str10
(893 real changes made)
(715 real changes made)
(715 missing values generated)
variable dementia was str7 now str10
(893 real changes made)
(716 real changes made)
(716 missing values generated)
variable neuro was str7 now str10
(893 real changes made)
(720 real changes made)
(720 missing values generated)
variable lung_cancer was str7 now str10
(893 real changes made)
(718 real changes made)
(718 missing values generated)
variable haem_cancer was str7 now str10
(893 real changes made)
(714 real changes made)
(714 missing values generated)
variable other_cancer was str7 now str10
(893 real changes made)
(719 real changes made)
(719 missing values generated)
variable liver was str7 now str10
(893 real changes made)
(716 real changes made)
(716 missing values generated)
variable transplant_notkidney was str7 now str10
(893 real changes made)
(719 real changes made)
(719 missing values generated)
variable transplant_kidney was str7 now str10
(893 real changes made)
(711 real changes made)
(711 missing values generated)
variable dialysis was str7 now str10
(893 real changes made)
(717 real changes made)
(717 missing values generated)
variable dysplenia was str7 now str10
(893 real changes made)
(722 real changes made)
(722 missing values generated)
variable sickle_cell was str7 now str10
(893 real changes made)
(709 real changes made)
(709 missing values generated)
variable hiv was str7 now str10
(893 real changes made)
(718 real changes made)
(718 missing values generated)
variable perm_immuno was str7 now str10
(893 real changes made)
(721 real changes made)
(721 missing values generated)
variable aplastic_anaemia was str7 now str10
(893 real changes made)
(890 real changes made)
(890 missing values generated)
(893 real changes made)
(893 real changes made)
(893 missing values generated)
variable autoimmune was str7 now str10
(893 real changes made)
(716 real changes made)
(716 missing values generated)
variable ibd was str7 now str10
(893 real changes made)
(715 real changes made)
(715 missing values generated)
variable fracture was str7 now str10
(893 real changes made)
(885 real changes made)
(885 missing values generated)
variable smi was str7 now str10
(893 real changes made)
(716 real changes made)
(716 missing values generated)
variable ldr was str7 now str10
(893 real changes made)
(543 real changes made)
(543 missing values generated)
variable ld_profound was str7 now str10
(893 real changes made)
(720 real changes made)
(720 missing values generated)
variable ds was str7 now str10
(893 real changes made)
(716 real changes made)
(716 missing values generated)
variable cp was str7 now str10
(893 real changes made)
(714 real changes made)
(714 missing values generated)
(852 missing values generated)
(18 real changes made)
(98 real changes made)
(16 real changes made, 16 to missing)
(720 real changes made, 720 to missing)
(226 real changes made, 226 to missing)
(226 real changes made, 226 to missing)
(161 real changes made, 161 to missing)
(140 real changes made, 140 to missing)
variable bmi_child_date_measured was str7 now str10
(893 real changes made)
(46 real changes made)
(46 missing values generated)
(753 real changes made, 753 to missing)
(717 real changes made, 717 to missing)

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
   bmi_adult |        753    33.25179    12.35759          0    61.6464
   bmi_child |        140    33.50246    13.40188          0   64.15395
(140 missing values generated)
(140 real changes made)
(120 real changes made, 120 to missing)
(862 missing values generated)
(892 real changes made)
(800 missing values generated)
(167 real changes made)
(172 real changes made)
(92 real changes made)
(93 real changes made)
(107 real changes made)
(83 real changes made)
(86 real changes made)
(0 real changes made)
(rural_urban: 30 changes made)
(30 real changes made)
(893 differences between rural_urban and rural)
(asthmacat: 173 changes made)
(48 real changes made, 48 to missing)
(48 missing values generated)
(893 missing values generated)
(421 real changes made)
(424 real changes made)
(421 real changes made)
(424 real changes made)
(217 real changes made)
(893 missing values generated)
(421 real changes made)
(424 real changes made)
(845 real changes made)
(676 real changes made)
(48 missing values generated)
(838 real changes made)
(421 real changes made)
(0 real changes made)
(49 real changes made, 49 to missing)
(65 real changes made, 65 to missing)

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
hba1c_perc~e |        844    5.132201    2.003754   .0194196   12.16265
hba1c_mmol~l |        828    40.25959    19.33875   .2936997   95.63728
(49 missing values generated)
(828 real changes made)
(0 real changes made)
(890 real changes made)
(800 missing values generated)
(876 missing values generated)
(817 missing values generated)
(713 missing values generated)
(715 missing values generated)
(note: file analysis/data_base_cohort2.dta not found)
file analysis/data_base_cohort2.dta saved

. log close
      name:  <unnamed>
       log:  C:\Users\emsuewil\Documents\Work\Covid\OpenSAFELY\Absolute_risks\absolute-risks-covid-research\logs/001_clean_input_data.l
> og
  log type:  text
 closed on:  11 Feb 2021, 11:49:57
---------------------------------------------------------------------------------------------------------------------------------------
