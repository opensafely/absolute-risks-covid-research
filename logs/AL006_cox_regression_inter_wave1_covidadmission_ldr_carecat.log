-------------------------------------------------------------------------------
      name:  <unnamed>
       log:  /workspace/logs/AL006_cox_regression_inter_wave1_covidadmission_ld
> r_carecat.log
  log type:  text
 opened on:  25 Feb 2021, 20:10:11

. 
. 
. * Categories of various exposures
. local lo_ldr            = 0

. local hi_ldr            = 1

. local lo_ldr_cat        = 0

. local hi_ldr_cat        = 2

. local hi_ldr            = 1

. local lo_ldr_carecat= 0

. local hi_ldr_carecat= 2

. local lo_ds             = 0

. local hi_ds             = 1

. local lo_cp             = 0

. local hi_cp             = 1

. local lo_ldr_group      = 0

. local hi_ldr_group      = 5

. 
. * Open temporary file to post results
. tempfile ldrfile

. tempname ldrresults

. 
. postfile `ldrresults'   wave str15(outcome) str15(exposure) str20(model)     
>    ///
>                                                 expcat agebroad lnhr sehr usi
> ng `ldrfile'

. 
. 
.         * Open dataset (complete case ethnicity)
.         use "analysis/data_ldanalysis_cohort`i'.dta", clear 
(Analysis dataset, wave 1 (1 Mar - 31 Aug 20), for learning disability work)

.         drop if ethnicity_5>=.
(12,499 observations deleted)

. 
.         * Only keep data for adults
.         keep if child==0
(7,126 observations deleted)

. 
.         
.         /*  Declare data to be survival  */
. 
.         stset stime_`out'`i', fail(`out'`i') scale(365.25)

     failure event:  covidadmission1 != 0 & covidadmission1 < .
obs. time interval:  (0, stime_covidadmission1]
 exit on or before:  failure
    t for analysis:  time/365.25

------------------------------------------------------------------------------
     30,365  total observations
          0  exclusions
------------------------------------------------------------------------------
     30,365  observations remaining, representing
      2,991  failures in single-record/single-failure data
 13,799.439  total analysis time at risk and under observation
                                                at risk from t =         0
                                     earliest observed entry t =         0
                                          last observed exit t =  .5037645

. 
.         
.                 
.         /*  Fit Cox models  */
.         
.         * Confounder only model
.         stcox i.`exp'##i.agebroad age1 age2 age3 male i.ethnicity_5,    ///
>                 strata(stpcode) cluster(household_id) 

         failure _d:  covidadmission1
   analysis time _t:  stime_covidadmission1/365.25

Iteration 0:   log pseudolikelihood = -20307.744
Iteration 1:   log pseudolikelihood = -20302.049
Iteration 2:   log pseudolikelihood = -20302.046
Iteration 3:   log pseudolikelihood = -20302.046
Refining estimates:
Iteration 0:   log pseudolikelihood = -20302.046

Stratified Cox regr. -- Breslow method for ties

No. of subjects      =       30,365             Number of obs    =      30,365
No. of failures      =        2,991
Time at risk         =  13799.43874
                                                Wald chi2(16)    =       11.52
Log pseudolikelihood =   -20302.046             Prob > chi2      =      0.7764

                       (Std. Err. adjusted for 1,207 clusters in household_id)
------------------------------------------------------------------------------
             |               Robust
          _t | Haz. Ratio   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
 ldr_carecat |
LDR, not ..  |   .9078779   .1643883    -0.53   0.594     .6366511    1.294653
LDR, in r..  |   .9614338   .0403194    -0.94   0.348     .8855697    1.043797
             |
    agebroad |
     65-<75  |    1.12578   .1186326     1.12   0.261     .9157048    1.384049
        75+  |   1.097486   .2047851     0.50   0.618     .7613233    1.582081
             |
 ldr_carecat#|
    agebroad |
LDR, not .. #|
     65-<75  |   1.024851   .4648505     0.05   0.957     .4212832    2.493145
LDR, not .. #|
        75+  |   1.083575   .5767441     0.15   0.880     .3817669    3.075529
LDR, in r.. #|
     65-<75  |   .9325111   .1056688    -0.62   0.537     .7467907    1.164419
LDR, in r.. #|
        75+  |   .9853769   .1269429    -0.11   0.909     .7654993    1.268411
             |
        age1 |   .9976739    .011457    -0.20   0.839     .9754694    1.020384
        age2 |   1.005146    .029144     0.18   0.859     .9496173    1.063921
        age3 |   .9802334   .0750731    -0.26   0.794     .8436038    1.138991
        male |   .9852317   .0356117    -0.41   0.681     .9178492    1.057561
             |
 ethnicity_5 |
      Mixed  |   1.066007   .0591104     1.15   0.249      .956226    1.188391
Asian or ..  |   .9733643   .0549084    -0.48   0.632     .8714818    1.087158
      Black  |   .9454865   .0529968    -1.00   0.317      .847117    1.055279
      Other  |   .9295066   .0557934    -1.22   0.223     .8263411    1.045552
------------------------------------------------------------------------------
                                                         Stratified by stpcode

.         forvalues k = `lo_`exp'' (1) `hi_`exp'' {
  2.                 capture qui di _b[`k'.`exp']
  3.                 if _rc==0 {
  4.                         post `ldrresults' (`i') ("`out'") ("`exp'")       
>       ///
>                                 ("Confounders")                              
>                            ///
>                                 (`k') (1) (_b[`k'.`exp']) (_se[`k'.`exp'])
  5.                 }
  6.                 forvalues l = 2 (1) 3 {
  7.                         capture qui di _b[`k'.`exp'#`l'.agebroad]
  8.                         if _rc==0 {
  9.                             lincom `k'.`exp' + `k'.`exp'#`l'.agebroad
 10.                                 post `ldrresults' (`i') ("`out'") ("`exp'"
> )             ///
>                                         ("Confounders")                      
>                                    ///
>                                         (`k') (`l') (r(estimate)) (r(se))
 11.                         }
 12.                 }
 13.         }

 ( 1)  0b.ldr_carecat + 0b.ldr_carecat#2o.agebroad = 0

------------------------------------------------------------------------------
          _t |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
         (1) |          0  (omitted)
------------------------------------------------------------------------------

 ( 1)  0b.ldr_carecat + 0b.ldr_carecat#3o.agebroad = 0

------------------------------------------------------------------------------
          _t |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
         (1) |          0  (omitted)
------------------------------------------------------------------------------

 ( 1)  1.ldr_carecat + 1.ldr_carecat#2.agebroad = 0

------------------------------------------------------------------------------
          _t |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
         (1) |  -.0720978   .4113814    -0.18   0.861    -.8783906     .734195
------------------------------------------------------------------------------

 ( 1)  1.ldr_carecat + 1.ldr_carecat#3.agebroad = 0

------------------------------------------------------------------------------
          _t |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
         (1) |  -.0163794   .5096865    -0.03   0.974    -1.015347    .9825878
------------------------------------------------------------------------------

 ( 1)  2.ldr_carecat + 2.ldr_carecat#2.agebroad = 0

------------------------------------------------------------------------------
          _t |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
         (1) |  -.1092037   .1084852    -1.01   0.314    -.3218308    .1034233
------------------------------------------------------------------------------

 ( 1)  2.ldr_carecat + 2.ldr_carecat#3.agebroad = 0

------------------------------------------------------------------------------
          _t |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
         (1) |  -.0540606    .123172    -0.44   0.661    -.2954732     .187352
------------------------------------------------------------------------------

.         
.         * Confounders with deprivation
.         stcox i.`exp'##i.agebroad age1 age2 age3 male i.ethnicity_5 imd, ///
>                 strata(stpcode) cluster(household_id) 

         failure _d:  covidadmission1
   analysis time _t:  stime_covidadmission1/365.25

Iteration 0:   log pseudolikelihood = -20307.744
Iteration 1:   log pseudolikelihood = -20302.042
Iteration 2:   log pseudolikelihood = -20302.039
Iteration 3:   log pseudolikelihood = -20302.039
Refining estimates:
Iteration 0:   log pseudolikelihood = -20302.039

Stratified Cox regr. -- Breslow method for ties

No. of subjects      =       30,365             Number of obs    =      30,365
No. of failures      =        2,991
Time at risk         =  13799.43874
                                                Wald chi2(17)    =       11.52
Log pseudolikelihood =   -20302.039             Prob > chi2      =      0.8282

                       (Std. Err. adjusted for 1,207 clusters in household_id)
------------------------------------------------------------------------------
             |               Robust
          _t | Haz. Ratio   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
 ldr_carecat |
LDR, not ..  |   .9080472   .1644163    -0.53   0.594     .6367734    1.294887
LDR, in r..  |   .9614674   .0403097    -0.94   0.349     .8856207     1.04381
             |
    agebroad |
     65-<75  |   1.125907   .1186728     1.13   0.261     .9157649     1.38427
        75+  |   1.097681   .2048555     0.50   0.618     .7614123    1.582458
             |
 ldr_carecat#|
    agebroad |
LDR, not .. #|
     65-<75  |   1.024375   .4646719     0.05   0.958     .4210573    2.492165
LDR, not .. #|
        75+  |   1.083794   .5769106     0.15   0.880     .3818096    3.076429
LDR, in r.. #|
     65-<75  |   .9323938   .1056186    -0.62   0.537     .7467547    1.164182
LDR, in r.. #|
        75+  |   .9852445   .1269415    -0.12   0.908     .7653727     1.26828
             |
        age1 |   .9976736   .0114567    -0.20   0.839     .9754696    1.020383
        age2 |    1.00515   .0291422     0.18   0.859     .9496253    1.063922
        age3 |   .9802081   .0750622    -0.26   0.794     .8435971    1.138942
        male |   .9852158   .0356144    -0.41   0.680     .9178282    1.057551
             |
 ethnicity_5 |
      Mixed  |   1.066033   .0591196     1.15   0.249     .9562361    1.188437
Asian or ..  |   .9734176   .0549248    -0.48   0.633      .871506    1.087246
      Black  |   .9455176   .0530055    -1.00   0.318     .8471327    1.055329
      Other  |    .929513   .0557953    -1.22   0.223      .826344    1.045563
             |
         imd |   1.001538   .0129202     0.12   0.905      .976532    1.027184
------------------------------------------------------------------------------
                                                         Stratified by stpcode

.         forvalues k = `lo_`exp'' (1) `hi_`exp'' {
  2.                 capture qui di _b[`k'.`exp']
  3.                 if _rc==0 {
  4.                         post `ldrresults' (`i') ("`out'") ("`exp'")     //
> /
>                                 ("Confounders+IMD")                          
>                    ///
>                                 (`k') (1) (_b[`k'.`exp']) (_se[`k'.`exp'])
  5.                 }       
  6.                 forvalues l = 2 (1) 3 {
  7.                         capture qui di _b[`k'.`exp'#`l'.agebroad]
  8.                         if _rc==0 {
  9.                             lincom `k'.`exp' + `k'.`exp'#`l'.agebroad
 10.                                 post `ldrresults' (`i') ("`out'") ("`exp'"
> )             ///
>                                         ("Confounders+IMD")                  
>                            ///
>                                         (`k') (`l') (r(estimate)) (r(se))
 11.                         }
 12.                 }
 13.         }

 ( 1)  0b.ldr_carecat + 0b.ldr_carecat#2o.agebroad = 0

------------------------------------------------------------------------------
          _t |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
         (1) |          0  (omitted)
------------------------------------------------------------------------------

 ( 1)  0b.ldr_carecat + 0b.ldr_carecat#3o.agebroad = 0

------------------------------------------------------------------------------
          _t |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
         (1) |          0  (omitted)
------------------------------------------------------------------------------

 ( 1)  1.ldr_carecat + 1.ldr_carecat#2.agebroad = 0

------------------------------------------------------------------------------
          _t |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
         (1) |  -.0723763   .4114116    -0.18   0.860    -.8787282    .7339756
------------------------------------------------------------------------------

 ( 1)  1.ldr_carecat + 1.ldr_carecat#3.agebroad = 0

------------------------------------------------------------------------------
          _t |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
         (1) |  -.0159909   .5097182    -0.03   0.975     -1.01502    .9830384
------------------------------------------------------------------------------

 ( 1)  2.ldr_carecat + 2.ldr_carecat#2.agebroad = 0

------------------------------------------------------------------------------
          _t |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
         (1) |  -.1092946   .1084658    -1.01   0.314    -.3218836    .1032944
------------------------------------------------------------------------------

 ( 1)  2.ldr_carecat + 2.ldr_carecat#3.agebroad = 0

------------------------------------------------------------------------------
          _t |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
         (1) |  -.0541601   .1231979    -0.44   0.660    -.2956236    .1873034
------------------------------------------------------------------------------

.         
.         * Confounders with residential care
.         stcox i.`exp'##i.agebroad age1 age2 age3 male   ///
>                                 i.ethnicity_5 resid_care_ldr,           ///
>                 strata(stpcode) cluster(household_id) 

         failure _d:  covidadmission1
   analysis time _t:  stime_covidadmission1/365.25

Iteration 0:   log pseudolikelihood = -20307.744
Iteration 1:   log pseudolikelihood = -20301.211
Iteration 2:   log pseudolikelihood =   -20301.2
Iteration 3:   log pseudolikelihood =   -20301.2
Refining estimates:
Iteration 0:   log pseudolikelihood =   -20301.2

Stratified Cox regr. -- Breslow method for ties

No. of subjects      =       30,365             Number of obs    =      30,365
No. of failures      =        2,991
Time at risk         =  13799.43874
                                                Wald chi2(17)    =       13.30
Log pseudolikelihood =     -20301.2             Prob > chi2      =      0.7158

                       (Std. Err. adjusted for 1,207 clusters in household_id)
------------------------------------------------------------------------------
             |               Robust
          _t | Haz. Ratio   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
 ldr_carecat |
LDR, not ..  |   .7926886   .1705706    -1.08   0.280     .5199257    1.208548
LDR, in r..  |   .9677756   .0408822    -0.78   0.438     .8908755    1.051314
             |
    agebroad |
     65-<75  |   1.124315   .1184551     1.11   0.266     .9145499    1.382192
        75+  |   1.096605    .204633     0.49   0.621     .7606958    1.580846
             |
 ldr_carecat#|
    agebroad |
LDR, not .. #|
     65-<75  |   1.025619   .4652174     0.06   0.956     .4215841    2.495102
LDR, not .. #|
        75+  |   1.083063   .5764318     0.15   0.881     .3816135    3.073855
LDR, in r.. #|
     65-<75  |   .9332578   .1057671    -0.61   0.542     .7473672    1.165384
LDR, in r.. #|
        75+  |    .984896   .1268877    -0.12   0.906     .7651156    1.267809
             |
        age1 |    .997721   .0114572    -0.20   0.843     .9755161    1.020431
        age2 |   1.004981   .0291375     0.17   0.864     .9494653    1.063744
        age3 |   .9807436   .0751015    -0.25   0.800     .8440609     1.13956
        male |   .9849047   .0355952    -0.42   0.674      .917553      1.0572
             |
 ethnicity_5 |
      Mixed  |    1.06548    .059085     1.14   0.253      .955747    1.187812
Asian or ..  |   .9724526   .0548728    -0.50   0.621     .8706379    1.086174
      Black  |   .9451223    .052976    -1.01   0.314     .8467914    1.054871
      Other  |   .9289923   .0557838    -1.23   0.220     .8258467     1.04502
             |
resid_care~r |   .8674535   .0936578    -1.32   0.188     .7020097    1.071888
------------------------------------------------------------------------------
                                                         Stratified by stpcode

.         forvalues k = `lo_`exp'' (1) `hi_`exp'' {
  2.                 capture qui di _b[`k'.`exp']
  3.                 if _rc==0 {
  4.                         post `ldrresults' (`i') ("`out'") ("`exp'")     //
> /
>                                 ("Confounders+Resid")                        
>                    ///
>                                 (`k') (1) (_b[`k'.`exp']) (_se[`k'.`exp'])
  5.                 }               
  6.                 forvalues l = 2 (1) 3 {
  7.                         capture qui di _b[`k'.`exp'#`l'.agebroad]
  8.                         if _rc==0 {
  9.                             lincom `k'.`exp' + `k'.`exp'#`l'.agebroad
 10.                                 post `ldrresults' (`i') ("`out'") ("`exp'"
> )             ///
>                                         ("Confounders+Resid")                
>                            ///
>                                         (`k') (`l') (r(estimate)) (r(se))
 11.                         }
 12.                 }
 13.         }

 ( 1)  0b.ldr_carecat + 0b.ldr_carecat#2o.agebroad = 0

------------------------------------------------------------------------------
          _t |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
         (1) |          0  (omitted)
------------------------------------------------------------------------------

 ( 1)  0b.ldr_carecat + 0b.ldr_carecat#3o.agebroad = 0

------------------------------------------------------------------------------
          _t |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
         (1) |          0  (omitted)
------------------------------------------------------------------------------

 ( 1)  1.ldr_carecat + 1.ldr_carecat#2.agebroad = 0

------------------------------------------------------------------------------
          _t |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
         (1) |  -.2070281   .4206119    -0.49   0.623    -1.031412    .6173561
------------------------------------------------------------------------------

 ( 1)  1.ldr_carecat + 1.ldr_carecat#3.agebroad = 0

------------------------------------------------------------------------------
          _t |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
         (1) |   -.152532   .5242404    -0.29   0.771    -1.180024    .8749603
------------------------------------------------------------------------------

 ( 1)  2.ldr_carecat + 2.ldr_carecat#2.agebroad = 0

------------------------------------------------------------------------------
          _t |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
         (1) |  -.1018289   .1086974    -0.94   0.349    -.3148719    .1112141
------------------------------------------------------------------------------

 ( 1)  2.ldr_carecat + 2.ldr_carecat#3.agebroad = 0

------------------------------------------------------------------------------
          _t |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
         (1) |  -.0479743   .1232106    -0.39   0.697    -.2894626     .193514
------------------------------------------------------------------------------

.         
.         * Confounders with physical comorbidities that are indicators for vac
> cination 
.         stcox i.`exp'##i.agebroad age1 age2 age3 male           ///
>                                 i.ethnicity_5                                
>                    ///
>                                 obese40                                      
>                            ///
>                                 respiratory asthma_severe                    
>            ///
>                                 cardiac af dvt_pe i.diabcat                  
>            ///
>                                 liver stroke tia dementia                    
>            ///
>                                 i.kidneyfn                                   
>                            ///
>                                 spleen transplant dialysis                   
>            ///
>                                 immunosuppression cancerHaem                 
>    ///
>                                 autoimmune ibd cancerExhaem1yr,              
>    ///
>                 strata(stpcode) cluster(household_id) 

         failure _d:  covidadmission1
   analysis time _t:  stime_covidadmission1/365.25

Iteration 0:   log pseudolikelihood = -2953.2419
Iteration 1:   log pseudolikelihood = -2935.5566
Iteration 2:   log pseudolikelihood = -2934.5385
Iteration 3:   log pseudolikelihood = -2934.4459
Iteration 4:   log pseudolikelihood = -2934.4238
Iteration 5:   log pseudolikelihood = -2934.4157
Iteration 6:   log pseudolikelihood = -2934.4127
Iteration 7:   log pseudolikelihood = -2934.4116
Iteration 8:   log pseudolikelihood = -2934.4112
Iteration 9:   log pseudolikelihood = -2934.4111
Iteration 10:  log pseudolikelihood =  -2934.411
Iteration 11:  log pseudolikelihood =  -2934.411
Iteration 12:  log pseudolikelihood =  -2934.411
Iteration 13:  log pseudolikelihood =  -2934.411
Iteration 14:  log pseudolikelihood =  -2934.411
Iteration 15:  log pseudolikelihood =  -2934.411
Iteration 16:  log pseudolikelihood =  -2934.411
Iteration 17:  log pseudolikelihood =  -2934.411
Iteration 18:  log pseudolikelihood =  -2934.411
Iteration 19:  log pseudolikelihood =  -2934.411
Iteration 20:  log pseudolikelihood =  -2934.411
Iteration 21:  log pseudolikelihood =  -2934.411
Iteration 22:  log pseudolikelihood =  -2934.411
Iteration 23:  log pseudolikelihood =  -2934.411
Iteration 24:  log pseudolikelihood =  -2934.411
Iteration 25:  log pseudolikelihood =  -2934.411
Iteration 26:  log pseudolikelihood =  -2934.411
Iteration 27:  log pseudolikelihood =  -2934.411
Iteration 28:  log pseudolikelihood =  -2934.411
Iteration 29:  log pseudolikelihood =  -2934.411
Refining estimates:
Iteration 0:   log pseudolikelihood =  -2934.411
Iteration 1:   log pseudolikelihood =  -2934.411

Stratified Cox regr. -- Breslow method for ties

No. of subjects      =        6,087             Number of obs    =       6,087
No. of failures      =          570
Time at risk         =  2776.616016
                                                Wald chi2(39)    =     6344.66
Log pseudolikelihood =    -2934.411             Prob > chi2      =      0.0000

                         (Std. Err. adjusted for 986 clusters in household_id)
------------------------------------------------------------------------------
             |               Robust
          _t | Haz. Ratio   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
 ldr_carecat |
LDR, not ..  |   .7319506   .3339694    -0.68   0.494     .2992963    1.790038
LDR, in r..  |   .9295994   .0864315    -0.79   0.432     .7747356    1.115419
             |
    agebroad |
     65-<75  |   1.192819   .2627473     0.80   0.423     .7745984    1.836844
        75+  |    .932557    .376645    -0.17   0.863     .4225602     2.05808
             |
 ldr_carecat#|
    agebroad |
LDR, not .. #|
     65-<75  |   2.714783    1.96242     1.38   0.167     .6583119    11.19537
LDR, not .. #|
        75+  |   2.631745   2.271691     1.12   0.262     .4847263    14.28864
LDR, in r.. #|
     65-<75  |   .9657994   .2296697    -0.15   0.884     .6059948    1.539235
LDR, in r.. #|
        75+  |   .9070632   .2666512    -0.33   0.740     .5098097    1.613864
             |
        age1 |    1.00794   .0266377     0.30   0.765     .9570604    1.061525
        age2 |   .9702781   .0634196    -0.46   0.644     .8536104    1.102891
        age3 |   1.095905   .1829919     0.55   0.583     .7900253    1.520214
        male |   .9829626   .0848989    -0.20   0.842     .8298859    1.164275
             |
 ethnicity_5 |
      Mixed  |   1.034377   .1313501     0.27   0.790     .8064719    1.326687
Asian or ..  |   1.020485    .125966     0.16   0.870     .8011915      1.2998
      Black  |   .8329195   .1094776    -1.39   0.164     .6437578    1.077664
      Other  |   .8126804   .1087872    -1.55   0.121     .6251383    1.056485
             |
     obese40 |   .9646053   .0953545    -0.36   0.715     .7947041     1.17083
 respiratory |   1.073384   .1064369     0.71   0.475     .8837918    1.303648
asthma_sev~e |   .8285287   .1158551    -1.35   0.179     .6299152    1.089765
     cardiac |   1.228111   .1185161     2.13   0.033      1.01647    1.483819
          af |   .9957404   .1054229    -0.04   0.968     .8091445    1.225367
      dvt_pe |   1.156272   .1154871     1.45   0.146     .9506986    1.406297
             |
     diabcat |
Controlle..  |   1.107001   .1256136     0.90   0.370     .8862587    1.382724
Uncontrol..  |   .8103592    .194162    -0.88   0.380     .5066754    1.296061
Diabetes,..  |   8.32e-14   3.31e-14   -75.78   0.000     3.82e-14    1.81e-13
             |
       liver |   1.199598   .1190546     1.83   0.067     .9875478    1.457182
      stroke |   .9834838   .1023765    -0.16   0.873     .8019747    1.206073
         tia |   1.141953   .1192785     1.27   0.204     .9305489    1.401385
    dementia |   .9656272   .1035167    -0.33   0.744     .7826352    1.191406
             |
    kidneyfn |
Stage 3a/..  |   1.280063   .6118458     0.52   0.605     .5016181    3.266552
Stage 4/5..  |   1.026556   .1414015     0.19   0.849      .783673    1.344714
             |
      spleen |   1.042425   .0902472     0.48   0.631     .8797362    1.235199
  transplant |   1.203585   .1297846     1.72   0.086     .9742945    1.486836
    dialysis |   .9111296   .1423837    -0.60   0.551     .6707513    1.237653
immunosupp~n |   1.069396   .0960725     0.75   0.455     .8967439     1.27529
  cancerHaem |   .9975041   .0347919    -0.07   0.943     .9315919     1.06808
  autoimmune |   .8897157   .1005708    -1.03   0.301     .7129088    1.110372
         ibd |   .9571676   .1031429    -0.41   0.685     .7749324    1.182258
cancerExha~r |   1.063817   .6056893     0.11   0.913     .3485227    3.247152
------------------------------------------------------------------------------
                                                         Stratified by stpcode

.         forvalues k = `lo_`exp'' (1) `hi_`exp'' {
  2.                 capture qui di _b[`k'.`exp']
  3.                 if _rc==0 {
  4.                         post `ldrresults' (`i') ("`out'") ("`exp'") ///
>                         ("Confounders+Comorb")                               
>            ///
>                         (`k') (1) (_b[`k'.`exp']) (_se[`k'.`exp'])
  5.                 }
  6.                                 forvalues l = 2 (1) 3 {
  7.                         capture qui di _b[`k'.`exp'#`l'.agebroad]
  8.                         if _rc==0 {
  9.                             lincom `k'.`exp' + `k'.`exp'#`l'.agebroad
 10.                                 post `ldrresults' (`i') ("`out'") ("`exp'"
> )             ///
>                                         ("Confounders+Comorb")               
>                            ///
>                                         (`k') (`l') (r(estimate)) (r(se))
 11.                         }
 12.                 }
 13.         }

 ( 1)  0b.ldr_carecat + 0b.ldr_carecat#2o.agebroad = 0

------------------------------------------------------------------------------
          _t |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
         (1) |          0  (omitted)
------------------------------------------------------------------------------

 ( 1)  0b.ldr_carecat + 0b.ldr_carecat#3o.agebroad = 0

------------------------------------------------------------------------------
          _t |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
         (1) |          0  (omitted)
------------------------------------------------------------------------------

 ( 1)  1.ldr_carecat + 1.ldr_carecat#2.agebroad = 0

------------------------------------------------------------------------------
          _t |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
         (1) |   .6866698   .5612494     1.22   0.221    -.4133587    1.786698
------------------------------------------------------------------------------

 ( 1)  1.ldr_carecat + 1.ldr_carecat#3.agebroad = 0

------------------------------------------------------------------------------
          _t |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
         (1) |   .6556048   .7332385     0.89   0.371    -.7815163    2.092726
------------------------------------------------------------------------------

 ( 1)  2.ldr_carecat + 2.ldr_carecat#2.agebroad = 0

------------------------------------------------------------------------------
          _t |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
         (1) |  -.1078007   .2198422    -0.49   0.624    -.5386834    .3230821
------------------------------------------------------------------------------

 ( 1)  2.ldr_carecat + 2.ldr_carecat#3.agebroad = 0

------------------------------------------------------------------------------
          _t |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
         (1) |  -.1705447   .2739651    -0.62   0.534    -.7075064     .366417
------------------------------------------------------------------------------

.         
.         * All variables
.         stcox i.`exp'##i.agebroad age1 age2 age3 male           ///
>                                 i.ethnicity_5 imd resid_care_ldr             
>    ///
>                                 obese40                                      
>                            ///
>                                 respiratory asthma_severe                    
>            ///
>                                 cardiac af dvt_pe i.diabcat                  
>            ///
>                                 liver stroke tia dementia                    
>            ///
>                                 i.kidneyfn                                   
>                            ///
>                                 spleen transplant dialysis                   
>            ///
>                                 immunosuppression cancerHaem                 
>    ///
>                                 autoimmune ibd cancerExhaem1yr,              
>    ///
>                                 strata(stpcode) cluster(household_id) 

         failure _d:  covidadmission1
   analysis time _t:  stime_covidadmission1/365.25

Iteration 0:   log pseudolikelihood = -2953.2419
Iteration 1:   log pseudolikelihood = -2935.1459
Iteration 2:   log pseudolikelihood = -2934.1214
Iteration 3:   log pseudolikelihood = -2934.0293
Iteration 4:   log pseudolikelihood = -2934.0072
Iteration 5:   log pseudolikelihood = -2933.9991
Iteration 6:   log pseudolikelihood = -2933.9961
Iteration 7:   log pseudolikelihood =  -2933.995
Iteration 8:   log pseudolikelihood = -2933.9946
Iteration 9:   log pseudolikelihood = -2933.9945
Iteration 10:  log pseudolikelihood = -2933.9944
Iteration 11:  log pseudolikelihood = -2933.9944
Iteration 12:  log pseudolikelihood = -2933.9944
Iteration 13:  log pseudolikelihood = -2933.9944
Iteration 14:  log pseudolikelihood = -2933.9944
Iteration 15:  log pseudolikelihood = -2933.9944
Iteration 16:  log pseudolikelihood = -2933.9944
Iteration 17:  log pseudolikelihood = -2933.9944
Iteration 18:  log pseudolikelihood = -2933.9944
Iteration 19:  log pseudolikelihood = -2933.9944
Iteration 20:  log pseudolikelihood = -2933.9944
Iteration 21:  log pseudolikelihood = -2933.9944
Iteration 22:  log pseudolikelihood = -2933.9944
Iteration 23:  log pseudolikelihood = -2933.9944
Iteration 24:  log pseudolikelihood = -2933.9944
Iteration 25:  log pseudolikelihood = -2933.9944
Iteration 26:  log pseudolikelihood = -2933.9944
Iteration 27:  log pseudolikelihood = -2933.9944
Iteration 28:  log pseudolikelihood = -2933.9944
Iteration 29:  log pseudolikelihood = -2933.9944
Iteration 30:  log pseudolikelihood = -2933.9944
Refining estimates:
Iteration 0:   log pseudolikelihood = -2933.9944
Iteration 1:   log pseudolikelihood = -2933.9944
Iteration 2:   log pseudolikelihood = -2933.9944

Stratified Cox regr. -- Breslow method for ties

No. of subjects      =        6,087             Number of obs    =       6,087
No. of failures      =          570
Time at risk         =  2776.616016
                                                Wald chi2(41)    =     7190.50
Log pseudolikelihood =   -2933.9944             Prob > chi2      =      0.0000

                         (Std. Err. adjusted for 986 clusters in household_id)
------------------------------------------------------------------------------
             |               Robust
          _t | Haz. Ratio   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
 ldr_carecat |
LDR, not ..  |   .5885608   .3092197    -1.01   0.313     .2101768    1.648155
LDR, in r..  |   .9394633    .087922    -0.67   0.505     .7820203    1.128604
             |
    agebroad |
     65-<75  |   1.196281   .2628968     0.82   0.415     .7776275    1.840326
        75+  |   .9352707   .3782163    -0.17   0.869     .4233679    2.066126
             |
 ldr_carecat#|
    agebroad |
LDR, not .. #|
     65-<75  |   2.721424   1.966013     1.39   0.166     .6604963      11.213
LDR, not .. #|
        75+  |   2.638842   2.278796     1.12   0.261     .4856802     14.3376
LDR, in r.. #|
     65-<75  |   .9655549   .2299174    -0.15   0.883     .6054654    1.539801
LDR, in r.. #|
        75+  |    .908245   .2672761    -0.33   0.744     .5101684    1.616935
             |
        age1 |   1.008079   .0265644     0.31   0.760     .9573353    1.061512
        age2 |   .9699849   .0632737    -0.47   0.640     .8535711    1.102276
        age3 |   1.096388   .1828135     0.55   0.581     .7907396     1.52018
        male |   .9842241   .0851703    -0.18   0.854     .8306822    1.166146
             |
 ethnicity_5 |
      Mixed  |   1.036119   .1316672     0.28   0.780     .8076838    1.329163
Asian or ..  |   1.021904   .1262256     0.18   0.861     .8021761    1.301819
      Black  |   .8339843   .1097185    -1.38   0.168     .6444278    1.079298
      Other  |   .8158712    .109415    -1.52   0.129     .6272902    1.061145
             |
         imd |   .9965369   .0283721    -0.12   0.903     .9424517    1.053726
resid_care~r |   .7964238   .1921365    -0.94   0.345     .4963552    1.277897
     obese40 |    .965289   .0953841    -0.36   0.721     .7953288    1.171569
 respiratory |   1.072025    .106443     0.70   0.484      .882445    1.302332
asthma_sev~e |   .8307016   .1161939    -1.33   0.185     .6315151    1.092714
     cardiac |   1.230562   .1190097     2.15   0.032     1.018081    1.487389
          af |   .9956307   .1054035    -0.04   0.967     .8090678    1.225213
      dvt_pe |    1.15579   .1155097     1.45   0.147     .9501885    1.405879
             |
     diabcat |
Controlle..  |   1.106549   .1256118     0.89   0.372     .8858195    1.382281
Uncontrol..  |   .8096081   .1940969    -0.88   0.378     .5060649     1.29522
Diabetes,..  |   1.13e-14   4.50e-15   -80.63   0.000     5.17e-15    2.46e-14
             |
       liver |   1.200481   .1191338     1.84   0.066     .9882879    1.458234
      stroke |    .985045   .1024037    -0.14   0.885     .8034641    1.207663
         tia |   1.141778   .1191427     1.27   0.204     .9305939    1.400887
    dementia |   .9635992   .1029867    -0.35   0.729     .7814882    1.188148
             |
    kidneyfn |
Stage 3a/..  |   1.275368   .6108237     0.51   0.612     .4988402    3.260688
Stage 4/5..  |   1.027885   .1415571     0.20   0.842     .7847291    1.346385
             |
      spleen |   1.043266   .0903238     0.49   0.625     .8804398    1.236204
  transplant |   1.201203   .1294812     1.70   0.089     .9724398    1.483781
    dialysis |   .9099641    .142161    -0.60   0.546     .6699518    1.235962
immunosupp~n |   1.067754   .0961298     0.73   0.467     .8950302    1.273811
  cancerHaem |   .9977727   .0347924    -0.06   0.949      .931859    1.068349
  autoimmune |      .8901   .1006776    -1.03   0.303     .7131172    1.111007
         ibd |   .9593754   .1034268    -0.38   0.700      .776647    1.185096
cancerExha~r |   1.063542   .6061676     0.11   0.914     .3480253    3.250113
------------------------------------------------------------------------------
                                                         Stratified by stpcode

.         forvalues k = `lo_`exp'' (1) `hi_`exp'' {
  2.                 capture qui di _b[`k'.`exp']
  3.                 if _rc==0 {
  4.                         post `ldrresults' (`i') ("`out'") ("`exp'")     //
> /
>                         ("All")                                              
>                                    ///
>                         (`k') (1) (_b[`k'.`exp']) (_se[`k'.`exp'])
  5.                 }
  6.                                 forvalues l = 2 (1) 3 {
  7.                         capture qui di _b[`k'.`exp'#`l'.agebroad]
  8.                         if _rc==0 {
  9.                             lincom `k'.`exp' + `k'.`exp'#`l'.agebroad
 10.                                 post `ldrresults' (`i') ("`out'") ("`exp'"
> )     ///
>                                         ("All")                              
>                                    ///
>                                         (`k') (`l') (r(estimate)) (r(se))
 11.                         }
 12.                 }
 13.         }

 ( 1)  0b.ldr_carecat + 0b.ldr_carecat#2o.agebroad = 0

------------------------------------------------------------------------------
          _t |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
         (1) |          0  (omitted)
------------------------------------------------------------------------------

 ( 1)  0b.ldr_carecat + 0b.ldr_carecat#3o.agebroad = 0

------------------------------------------------------------------------------
          _t |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
         (1) |          0  (omitted)
------------------------------------------------------------------------------

 ( 1)  1.ldr_carecat + 1.ldr_carecat#2.agebroad = 0

------------------------------------------------------------------------------
          _t |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
         (1) |   .4710802   .6157462     0.77   0.444    -.7357601     1.67792
------------------------------------------------------------------------------

 ( 1)  1.ldr_carecat + 1.ldr_carecat#3.agebroad = 0

------------------------------------------------------------------------------
          _t |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
         (1) |   .4402652   .7647007     0.58   0.565    -1.058521    1.939051
------------------------------------------------------------------------------

 ( 1)  2.ldr_carecat + 2.ldr_carecat#2.agebroad = 0

------------------------------------------------------------------------------
          _t |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
         (1) |  -.0974988   .2205673    -0.44   0.658    -.5298028    .3348052
------------------------------------------------------------------------------

 ( 1)  2.ldr_carecat + 2.ldr_carecat#3.agebroad = 0

------------------------------------------------------------------------------
          _t |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
         (1) |  -.1586876   .2739432    -0.58   0.562    -.6956063    .3782311
------------------------------------------------------------------------------

. 
. postclose `ldrresults'

. 
. use `ldrfile', clear

. 
. 
. *************************
. *  Tidy output for HRs  *
. *************************
. 
. * Outcome
. rename outcome out

. gen outcome     = 1 if out=="coviddeath"
(45 missing values generated)

. replace outcome = 2 if out=="covidadmission"
(45 real changes made)

. replace outcome = 3 if out=="composite"
(0 real changes made)

. 
. label define outcome    1 "COVID-19 death"              ///
>                                                 2 "COVID-19 admission"  ///
>                                                 3 "Composite"

. label values outcome outcome

. drop out

. 
. * Exposure
. rename exposure exp

. gen     exposure = 1 if exp=="ldr"
(45 missing values generated)

. replace exposure = 2 if exp=="ldr_cat"
(0 real changes made)

. replace exposure = 3 if exp=="ldr_carecat"
(45 real changes made)

. replace exposure = 4 if exp=="ds"
(0 real changes made)

. replace exposure = 5 if exp=="cp"
(0 real changes made)

. replace exposure = 6 if exp=="ldr_group"
(0 real changes made)

. 
. label define exposure   1 "Learning disability register"        ///
>                                                 2 "LDR Severe vs mild"       
>                    ///
>                                                 3 "LDR by residential care"  
>                    ///
>                                                 4 "Down's syndrome"          
>                            ///
>                                                 5 "Cerebral Palsy"           
>                            ///
>                                                 6 "Combined grouping"        
>                    

. label values exposure exposure                                          

. drop exp

. 
. * Age categories
. label define agebroad   1 "16-<65"              ///
>                                                 2 "65-<75"              ///
>                                                 3 "75+"

. label values agebroad agebroad

. 
. 
. * Categories of exposure
. gen category     = "No"                                         if expcat==0
(30 missing values generated)

. replace category = "Yes"                                        if inlist(exp
> osure, 1, 4, 5) & expcat==1
(0 real changes made)

. 
. replace category = "LDR, mild"                          if inlist(exposure, 2
> ) & expcat==1
(0 real changes made)

. replace category = "LDR, profound"                      if inlist(exposure, 2
> ) & expcat==2
(0 real changes made)

. 
. replace category = "LDR, community"             if inlist(exposure, 3) & expc
> at==1
variable category was str2 now str14
(15 real changes made)

. replace category = "LDR, residential care"      if inlist(exposure, 3) & expc
> at==2
variable category was str14 now str21
(15 real changes made)

. 
. replace category = "DS but not LDR"             if inlist(exposure, 6) & expc
> at==1
(0 real changes made)

. replace category = "DS and LDR"                         if inlist(exposure, 6
> ) & expcat==2
(0 real changes made)

. replace category = "CP but not LDR"             if inlist(exposure, 6) & expc
> at==3
(0 real changes made)

. replace category = "CP and LDR"                         if inlist(exposure, 6
> ) & expcat==4
(0 real changes made)

. replace category = "LDR with no DS or CP"       if inlist(exposure, 6) & expc
> at==5
(0 real changes made)

. 
. * Model adjustment
. gen     adjustment = 1 if model=="Confounders"
(36 missing values generated)

. replace adjustment = 2 if model=="Confounders+IMD"
(9 real changes made)

. replace adjustment = 3 if model=="Confounders+Resid"
(9 real changes made)

. replace adjustment = 4 if model=="Confounders+Comorb"
(9 real changes made)

. replace adjustment = 5 if model=="All"
(9 real changes made)

. label define adj        1 "Confounders"                                      
>    ///     
>                                         2 "Confounders with IMD"             
>            ///
>                                         3 "Confounders with care"            
>            ///
>                                         4 "Confounders with comorbidities"   
>    ///
>                                         5 "All"

. label values adjustment adj

. drop model

. 
. * Hazard ratio with 95% confidence interval
. gen cl = exp(lnhr - invnorm(0.975)*sehr)

. gen cu = exp(lnhr + invnorm(0.975)*sehr)

. gen hr = exp(lnhr)

. 
. gen hr_ci =   string(round(hr, 0.01)) + " (" ///
>                         + string(round(cl, 0.01)) + ", " ///
>                         + string(round(cu, 0.01)) + ")"

. replace hr_ci = "" if expcat==0
(15 real changes made)

. drop cl cu hr lnhr sehr

. 
. * Put in wide format
. reshape wide hr_ci, i(wave outcome exposure expcat agebroad) j(adjust)
(note: j = 1 2 3 4 5)

Data                               long   ->   wide
-----------------------------------------------------------------------------
Number of obs.                       45   ->       9
Number of variables                   8   ->      11
j variable (5 values)        adjustment   ->   (dropped)
xij variables:
                                  hr_ci   ->   hr_ci1 hr_ci2 ... hr_ci5
-----------------------------------------------------------------------------

. rename hr_ci1 hr_conf

. rename hr_ci2 hr_conf_imd

. rename hr_ci3 hr_conf_resid

. rename hr_ci4 hr_conf_comorb

. 
. 
. order wave outcome exposure agebroad category hr*

. sort wave outcome exposure agebroad expcat

. 
. * Save data
. outsheet using "output/ldcox_inter_wave`i'_`out'_`exp'", replace
(note: file output/ldcox_inter_wave1_covidadmission_ldr_carecat.out not found)

. 
. log close
      name:  <unnamed>
       log:  /workspace/logs/AL006_cox_regression_inter_wave1_covidadmission_ld
> r_carecat.log
  log type:  text
 closed on:  25 Feb 2021, 20:10:25
-------------------------------------------------------------------------------
