-------------------------------------------------------------------------------
      name:  <unnamed>
       log:  /workspace/logs/AL006_cox_regression_inter_wave2_covidadmission_ld
> r_carecat.log
  log type:  text
 opened on:  25 Feb 2021, 20:10:52

. 
. 
. * Categories of various exposures
. local lo_ldr            = 0

. local hi_ldr            = 1

. local lo_ldr_cat        = 0

. local hi_ldr_cat        = 2

. local hi_ldr            = 1

. local lo_ldr_carecat= 0

. local hi_ldr_carecat= 2

. local lo_ds             = 0

. local hi_ds             = 1

. local lo_cp             = 0

. local hi_cp             = 1

. local lo_ldr_group      = 0

. local hi_ldr_group      = 5

. 
. * Open temporary file to post results
. tempfile ldrfile

. tempname ldrresults

. 
. postfile `ldrresults'   wave str15(outcome) str15(exposure) str20(model)     
>    ///
>                                                 expcat agebroad lnhr sehr usi
> ng `ldrfile'

. 
. 
.         * Open dataset (complete case ethnicity)
.         use "analysis/data_ldanalysis_cohort`i'.dta", clear 
(Analysis dataset, wave 2 (1 Sept 20 - latest), for learning disability work)

.         drop if ethnicity_5>=.
(11,245 observations deleted)

. 
.         * Only keep data for adults
.         keep if child==0
(6,499 observations deleted)

. 
.         
.         /*  Declare data to be survival  */
. 
.         stset stime_`out'`i', fail(`out'`i') scale(365.25)

     failure event:  covidadmission2 != 0 & covidadmission2 < .
obs. time interval:  (0, stime_covidadmission2]
 exit on or before:  failure
    t for analysis:  time/365.25

------------------------------------------------------------------------------
     27,126  total observations
      2,767  observations end on or before enter()
------------------------------------------------------------------------------
     24,359  observations remaining, representing
      2,360  failures in single-record/single-failure data
  9,788.172  total analysis time at risk and under observation
                                                at risk from t =         0
                                     earliest observed entry t =         0
                                          last observed exit t =  .4462697

. 
.         
.                 
.         /*  Fit Cox models  */
.         
.         * Confounder only model
.         stcox i.`exp'##i.agebroad age1 age2 age3 male i.ethnicity_5,    ///
>                 strata(stpcode) cluster(household_id) 

         failure _d:  covidadmission2
   analysis time _t:  stime_covidadmission2/365.25

Iteration 0:   log pseudolikelihood = -15518.831
Iteration 1:   log pseudolikelihood = -15507.184
Iteration 2:   log pseudolikelihood = -15505.332
Iteration 3:   log pseudolikelihood = -15505.228
Iteration 4:   log pseudolikelihood = -15505.227
Refining estimates:
Iteration 0:   log pseudolikelihood = -15505.227

Stratified Cox regr. -- Breslow method for ties

No. of subjects      =       24,359             Number of obs    =      24,359
No. of failures      =        2,360
Time at risk         =  9788.172485
                                                Wald chi2(16)    =       28.35
Log pseudolikelihood =   -15505.227             Prob > chi2      =      0.0287

                       (Std. Err. adjusted for 1,195 clusters in household_id)
------------------------------------------------------------------------------
             |               Robust
          _t | Haz. Ratio   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
 ldr_carecat |
LDR, not ..  |   .9962901   .2186277    -0.02   0.986     .6480323    1.531705
LDR, in r..  |   1.007072    .046252     0.15   0.878     .9203797    1.101929
             |
    agebroad |
     65-<75  |    .831978   .1050077    -1.46   0.145     .6496477    1.065481
        75+  |   .9424353   .1947728    -0.29   0.774     .6285415    1.413088
             |
 ldr_carecat#|
    agebroad |
LDR, not .. #|
     65-<75  |    2.93705   1.330299     2.38   0.017     1.208844    7.135957
LDR, not .. #|
        75+  |   .2414759   .2498389    -1.37   0.170     .0317829    1.834656
LDR, in r.. #|
     65-<75  |   .9364569   .1353645    -0.45   0.650     .7054185    1.243165
LDR, in r.. #|
        75+  |   1.045813   .1439077     0.33   0.745     .7985931    1.369564
             |
        age1 |   1.001235   .0129502     0.10   0.924     .9761719    1.026941
        age2 |   .9968719   .0313303    -0.10   0.921     .9373187    1.060209
        age3 |   1.013586   .0835964     0.16   0.870     .8622967    1.191418
        male |   1.075343   .0423211     1.85   0.065     .9955139    1.161574
             |
 ethnicity_5 |
      Mixed  |   1.037426   .0690609     0.55   0.581     .9105276     1.18201
Asian or ..  |   1.042532     .07159     0.61   0.544      .911251    1.192726
      Black  |   1.160563   .0767444     2.25   0.024     1.019487    1.321162
      Other  |   .9804306   .0669003    -0.29   0.772     .8576984    1.120725
------------------------------------------------------------------------------
                                                         Stratified by stpcode

.         forvalues k = `lo_`exp'' (1) `hi_`exp'' {
  2.                 capture qui di _b[`k'.`exp']
  3.                 if _rc==0 {
  4.                         post `ldrresults' (`i') ("`out'") ("`exp'")       
>       ///
>                                 ("Confounders")                              
>                            ///
>                                 (`k') (1) (_b[`k'.`exp']) (_se[`k'.`exp'])
  5.                 }
  6.                 forvalues l = 2 (1) 3 {
  7.                         capture qui di _b[`k'.`exp'#`l'.agebroad]
  8.                         if _rc==0 {
  9.                             lincom `k'.`exp' + `k'.`exp'#`l'.agebroad
 10.                                 post `ldrresults' (`i') ("`out'") ("`exp'"
> )             ///
>                                         ("Confounders")                      
>                                    ///
>                                         (`k') (`l') (r(estimate)) (r(se))
 11.                         }
 12.                 }
 13.         }

 ( 1)  0b.ldr_carecat + 0b.ldr_carecat#2o.agebroad = 0

------------------------------------------------------------------------------
          _t |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
         (1) |          0  (omitted)
------------------------------------------------------------------------------

 ( 1)  0b.ldr_carecat + 0b.ldr_carecat#3o.agebroad = 0

------------------------------------------------------------------------------
          _t |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
         (1) |          0  (omitted)
------------------------------------------------------------------------------

 ( 1)  1.ldr_carecat + 1.ldr_carecat#2.agebroad = 0

------------------------------------------------------------------------------
          _t |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
         (1) |   1.073689   .3873745     2.77   0.006     .3144487    1.832929
------------------------------------------------------------------------------

 ( 1)  1.ldr_carecat + 1.ldr_carecat#3.agebroad = 0

------------------------------------------------------------------------------
          _t |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
         (1) |  -1.424702   1.013027    -1.41   0.160    -3.410199    .5607941
------------------------------------------------------------------------------

 ( 1)  2.ldr_carecat + 2.ldr_carecat#2.agebroad = 0

------------------------------------------------------------------------------
          _t |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
         (1) |  -.0586051   .1321503    -0.44   0.657     -.317615    .2004048
------------------------------------------------------------------------------

 ( 1)  2.ldr_carecat + 2.ldr_carecat#3.agebroad = 0

------------------------------------------------------------------------------
          _t |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
         (1) |   .0518412   .1297816     0.40   0.690    -.2025261    .3062085
------------------------------------------------------------------------------

.         
.         * Confounders with deprivation
.         stcox i.`exp'##i.agebroad age1 age2 age3 male i.ethnicity_5 imd, ///
>                 strata(stpcode) cluster(household_id) 

         failure _d:  covidadmission2
   analysis time _t:  stime_covidadmission2/365.25

Iteration 0:   log pseudolikelihood = -15518.831
Iteration 1:   log pseudolikelihood =  -15507.18
Iteration 2:   log pseudolikelihood = -15505.327
Iteration 3:   log pseudolikelihood = -15505.223
Iteration 4:   log pseudolikelihood = -15505.222
Refining estimates:
Iteration 0:   log pseudolikelihood = -15505.222

Stratified Cox regr. -- Breslow method for ties

No. of subjects      =       24,359             Number of obs    =      24,359
No. of failures      =        2,360
Time at risk         =  9788.172485
                                                Wald chi2(17)    =       28.37
Log pseudolikelihood =   -15505.222             Prob > chi2      =      0.0408

                       (Std. Err. adjusted for 1,195 clusters in household_id)
------------------------------------------------------------------------------
             |               Robust
          _t | Haz. Ratio   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
 ldr_carecat |
LDR, not ..  |   .9961622   .2185797    -0.02   0.986     .6479745    1.531448
LDR, in r..  |   1.007085   .0462565     0.15   0.878     .9203848    1.101952
             |
    agebroad |
     65-<75  |   .8319579   .1050004    -1.46   0.145     .6496393    1.065444
        75+  |   .9426244   .1947643    -0.29   0.775     .6287299    1.413231
             |
 ldr_carecat#|
    agebroad |
LDR, not .. #|
     65-<75  |   2.936408   1.329884     2.38   0.017     1.208681    7.133805
LDR, not .. #|
        75+  |   .2415023   .2498675    -1.37   0.170      .031786    1.834876
LDR, in r.. #|
     65-<75  |   .9363566   .1353482    -0.45   0.649     .7053457    1.243027
LDR, in r.. #|
        75+  |   1.045577   .1437448     0.32   0.746     .7986086    1.368921
             |
        age1 |   1.001231   .0129497     0.10   0.924     .9761687    1.026936
        age2 |   .9968837   .0313287    -0.10   0.921     .9373333    1.060217
        age3 |   1.013551   .0835881     0.16   0.870     .8622764    1.191364
        male |   1.075328   .0423119     1.85   0.065     .9955157     1.16154
             |
 ethnicity_5 |
      Mixed  |   1.037436   .0690583     0.55   0.581     .9105421    1.182014
Asian or ..  |   1.042534   .0715902     0.61   0.544     .9112527    1.192729
      Black  |   1.160492   .0766905     2.25   0.024     1.019509    1.320972
      Other  |   .9803609   .0668658    -0.29   0.771     .8576884    1.120579
             |
         imd |   .9983272   .0172732    -0.10   0.923     .9650399    1.032763
------------------------------------------------------------------------------
                                                         Stratified by stpcode

.         forvalues k = `lo_`exp'' (1) `hi_`exp'' {
  2.                 capture qui di _b[`k'.`exp']
  3.                 if _rc==0 {
  4.                         post `ldrresults' (`i') ("`out'") ("`exp'")     //
> /
>                                 ("Confounders+IMD")                          
>                    ///
>                                 (`k') (1) (_b[`k'.`exp']) (_se[`k'.`exp'])
  5.                 }       
  6.                 forvalues l = 2 (1) 3 {
  7.                         capture qui di _b[`k'.`exp'#`l'.agebroad]
  8.                         if _rc==0 {
  9.                             lincom `k'.`exp' + `k'.`exp'#`l'.agebroad
 10.                                 post `ldrresults' (`i') ("`out'") ("`exp'"
> )             ///
>                                         ("Confounders+IMD")                  
>                            ///
>                                         (`k') (`l') (r(estimate)) (r(se))
 11.                         }
 12.                 }
 13.         }

 ( 1)  0b.ldr_carecat + 0b.ldr_carecat#2o.agebroad = 0

------------------------------------------------------------------------------
          _t |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
         (1) |          0  (omitted)
------------------------------------------------------------------------------

 ( 1)  0b.ldr_carecat + 0b.ldr_carecat#3o.agebroad = 0

------------------------------------------------------------------------------
          _t |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
         (1) |          0  (omitted)
------------------------------------------------------------------------------

 ( 1)  1.ldr_carecat + 1.ldr_carecat#2.agebroad = 0

------------------------------------------------------------------------------
          _t |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
         (1) |   1.073342   .3873291     2.77   0.006     .3141908    1.832493
------------------------------------------------------------------------------

 ( 1)  1.ldr_carecat + 1.ldr_carecat#3.agebroad = 0

------------------------------------------------------------------------------
          _t |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
         (1) |  -1.424721   1.013031    -1.41   0.160    -3.410226    .5607837
------------------------------------------------------------------------------

 ( 1)  2.ldr_carecat + 2.ldr_carecat#2.agebroad = 0

------------------------------------------------------------------------------
          _t |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
         (1) |   -.058699    .132141    -0.44   0.657    -.3176906    .2002925
------------------------------------------------------------------------------

 ( 1)  2.ldr_carecat + 2.ldr_carecat#3.agebroad = 0

------------------------------------------------------------------------------
          _t |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
         (1) |   .0516291   .1296319     0.40   0.690    -.2024447     .305703
------------------------------------------------------------------------------

.         
.         * Confounders with residential care
.         stcox i.`exp'##i.agebroad age1 age2 age3 male   ///
>                                 i.ethnicity_5 resid_care_ldr,           ///
>                 strata(stpcode) cluster(household_id) 

         failure _d:  covidadmission2
   analysis time _t:  stime_covidadmission2/365.25

Iteration 0:   log pseudolikelihood = -15518.831
Iteration 1:   log pseudolikelihood =  -15506.24
Iteration 2:   log pseudolikelihood = -15504.384
Iteration 3:   log pseudolikelihood =  -15504.28
Iteration 4:   log pseudolikelihood = -15504.279
Refining estimates:
Iteration 0:   log pseudolikelihood = -15504.279

Stratified Cox regr. -- Breslow method for ties

No. of subjects      =       24,359             Number of obs    =      24,359
No. of failures      =        2,360
Time at risk         =  9788.172485
                                                Wald chi2(17)    =       29.74
Log pseudolikelihood =   -15504.279             Prob > chi2      =      0.0283

                       (Std. Err. adjusted for 1,195 clusters in household_id)
------------------------------------------------------------------------------
             |               Robust
          _t | Haz. Ratio   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
 ldr_carecat |
LDR, not ..  |   1.184366   .3077588     0.65   0.515     .7117052    1.970931
LDR, in r..  |   .9989086   .0459954    -0.02   0.981     .9127075    1.093251
             |
    agebroad |
     65-<75  |   .8316267   .1049596    -1.46   0.144      .649379    1.065022
        75+  |   .9391143   .1940454    -0.30   0.761     .6263804    1.407987
             |
 ldr_carecat#|
    agebroad |
LDR, not .. #|
     65-<75  |    2.93781   1.330628     2.38   0.017      1.20917    7.137731
LDR, not .. #|
        75+  |   .2420824   .2504682    -1.37   0.170     .0318622    1.839292
LDR, in r.. #|
     65-<75  |    .936631   .1353897    -0.45   0.651     .7055497    1.243396
LDR, in r.. #|
        75+  |   1.048252   .1441878     0.34   0.732     .8005386    1.372616
             |
        age1 |   1.001438   .0129591     0.11   0.912     .9763578    1.027162
        age2 |   .9963547    .031328    -0.12   0.908     .9368067    1.059688
        age3 |   1.014964   .0837424     0.18   0.857     .8634153    1.193112
        male |   1.074897   .0423058     1.84   0.066     .9950965    1.161097
             |
 ethnicity_5 |
      Mixed  |   1.037661   .0690612     0.56   0.579     .9107605    1.182244
Asian or ..  |   1.042864   .0716239     0.61   0.541     .9115224    1.193132
      Black  |   1.161198   .0767883     2.26   0.024     1.020041    1.321889
      Other  |   .9812981   .0669482    -0.28   0.782     .8584766    1.121691
             |
resid_care~r |   1.198534   .1663826     1.30   0.192     .9130303    1.573315
------------------------------------------------------------------------------
                                                         Stratified by stpcode

.         forvalues k = `lo_`exp'' (1) `hi_`exp'' {
  2.                 capture qui di _b[`k'.`exp']
  3.                 if _rc==0 {
  4.                         post `ldrresults' (`i') ("`out'") ("`exp'")     //
> /
>                                 ("Confounders+Resid")                        
>                    ///
>                                 (`k') (1) (_b[`k'.`exp']) (_se[`k'.`exp'])
  5.                 }               
  6.                 forvalues l = 2 (1) 3 {
  7.                         capture qui di _b[`k'.`exp'#`l'.agebroad]
  8.                         if _rc==0 {
  9.                             lincom `k'.`exp' + `k'.`exp'#`l'.agebroad
 10.                                 post `ldrresults' (`i') ("`out'") ("`exp'"
> )             ///
>                                         ("Confounders+Resid")                
>                            ///
>                                         (`k') (`l') (r(estimate)) (r(se))
 11.                         }
 12.                 }
 13.         }

 ( 1)  0b.ldr_carecat + 0b.ldr_carecat#2o.agebroad = 0

------------------------------------------------------------------------------
          _t |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
         (1) |          0  (omitted)
------------------------------------------------------------------------------

 ( 1)  0b.ldr_carecat + 0b.ldr_carecat#3o.agebroad = 0

------------------------------------------------------------------------------
          _t |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
         (1) |          0  (omitted)
------------------------------------------------------------------------------

 ( 1)  1.ldr_carecat + 1.ldr_carecat#2.agebroad = 0

------------------------------------------------------------------------------
          _t |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
         (1) |   1.246872    .416423     2.99   0.003     .4306976    2.063046
------------------------------------------------------------------------------

 ( 1)  1.ldr_carecat + 1.ldr_carecat#3.agebroad = 0

------------------------------------------------------------------------------
          _t |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
         (1) |   -1.24927   1.023096    -1.22   0.222    -3.254502    .7559626
------------------------------------------------------------------------------

 ( 1)  2.ldr_carecat + 2.ldr_carecat#2.agebroad = 0

------------------------------------------------------------------------------
          _t |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
         (1) |  -.0665579   .1322605    -0.50   0.615    -.3257838     .192668
------------------------------------------------------------------------------

 ( 1)  2.ldr_carecat + 2.ldr_carecat#3.agebroad = 0

------------------------------------------------------------------------------
          _t |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
         (1) |   .0460319   .1299146     0.35   0.723     -.208596    .3006599
------------------------------------------------------------------------------

.         
.         * Confounders with physical comorbidities that are indicators for vac
> cination 
.         stcox i.`exp'##i.agebroad age1 age2 age3 male           ///
>                                 i.ethnicity_5                                
>                    ///
>                                 obese40                                      
>                            ///
>                                 respiratory asthma_severe                    
>            ///
>                                 cardiac af dvt_pe i.diabcat                  
>            ///
>                                 liver stroke tia dementia                    
>            ///
>                                 i.kidneyfn                                   
>                            ///
>                                 spleen transplant dialysis                   
>            ///
>                                 immunosuppression cancerHaem                 
>    ///
>                                 autoimmune ibd cancerExhaem1yr,              
>    ///
>                 strata(stpcode) cluster(household_id) 

         failure _d:  covidadmission2
   analysis time _t:  stime_covidadmission2/365.25

Iteration 0:   log pseudolikelihood =  -2445.012
Iteration 1:   log pseudolikelihood = -2427.0056
Iteration 2:   log pseudolikelihood = -2425.3857
Iteration 3:   log pseudolikelihood = -2424.8475
Iteration 4:   log pseudolikelihood = -2424.6491
Iteration 5:   log pseudolikelihood =  -2424.576
Iteration 6:   log pseudolikelihood = -2424.5491
Iteration 7:   log pseudolikelihood = -2424.5392
Iteration 8:   log pseudolikelihood = -2424.5356
Iteration 9:   log pseudolikelihood = -2424.5342
Iteration 10:  log pseudolikelihood = -2424.5338
Iteration 11:  log pseudolikelihood = -2424.5336
Iteration 12:  log pseudolikelihood = -2424.5335
Iteration 13:  log pseudolikelihood = -2424.5335
Iteration 14:  log pseudolikelihood = -2424.5335
Iteration 15:  log pseudolikelihood = -2424.5335
Iteration 16:  log pseudolikelihood = -2424.5335
Iteration 17:  log pseudolikelihood = -2424.5335
Iteration 18:  log pseudolikelihood = -2424.5335
Iteration 19:  log pseudolikelihood = -2424.5335
Iteration 20:  log pseudolikelihood = -2424.5335
Iteration 21:  log pseudolikelihood = -2424.5335
Iteration 22:  log pseudolikelihood = -2424.5335
Iteration 23:  log pseudolikelihood = -2424.5335
Iteration 24:  log pseudolikelihood = -2424.5335
Iteration 25:  log pseudolikelihood = -2424.5335
Iteration 26:  log pseudolikelihood = -2424.5335
Iteration 27:  log pseudolikelihood = -2424.5335
Iteration 28:  log pseudolikelihood = -2424.5335
Iteration 29:  log pseudolikelihood = -2424.5335
Iteration 30:  log pseudolikelihood = -2424.5335
Refining estimates:
Iteration 0:   log pseudolikelihood = -2424.5335
Iteration 1:   log pseudolikelihood = -2424.5335
Iteration 2:   log pseudolikelihood = -2424.5335
Iteration 3:   log pseudolikelihood = -2424.5335

Stratified Cox regr. -- Breslow method for ties

No. of subjects      =        4,879             Number of obs    =       4,879
No. of failures      =          492
Time at risk         =  1962.721424
                                                Wald chi2(39)    =    47155.89
Log pseudolikelihood =   -2424.5335             Prob > chi2      =      0.0000

                         (Std. Err. adjusted for 938 clusters in household_id)
------------------------------------------------------------------------------
             |               Robust
          _t | Haz. Ratio   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
 ldr_carecat |
LDR, not ..  |   1.031175   .4326406     0.07   0.942     .4531075     2.34673
LDR, in r..  |   .9356722   .1010063    -0.62   0.538     .7572444    1.156142
             |
    agebroad |
     65-<75  |   .8246032   .2377058    -0.67   0.503     .4686749    1.450836
        75+  |   .7957621    .373816    -0.49   0.627     .3169014    1.998216
             |
 ldr_carecat#|
    agebroad |
LDR, not .. #|
     65-<75  |   4.40e-15   2.59e-15   -56.16   0.000     1.39e-15    1.39e-14
LDR, not .. #|
        75+  |   7.07e-15   4.91e-15   -46.91   0.000     1.81e-15    2.76e-14
LDR, in r.. #|
     65-<75  |   .9580978   .2931991    -0.14   0.889     .5259245    1.745405
LDR, in r.. #|
        75+  |   1.816469   .5050257     2.15   0.032     1.053348     3.13245
             |
        age1 |   .9550985   .0263757    -1.66   0.096     .9047772    1.008218
        age2 |   1.110754   .0760583     1.53   0.125     .9712531    1.270292
        age3 |   .7846888    .143285    -1.33   0.184     .5486143    1.122349
        male |   .9935543   .0910064    -0.07   0.944     .8302795    1.188937
             |
 ethnicity_5 |
      Mixed  |   1.098864   .1709277     0.61   0.544     .8101022    1.490554
Asian or ..  |   1.198734   .1829801     1.19   0.235     .8887749    1.616792
      Black  |   1.370321   .2021165     2.14   0.033     1.026299    1.829663
      Other  |   1.128568   .1680616     0.81   0.417      .842889    1.511072
             |
     obese40 |   .9783187   .1094982    -0.20   0.845     .7856149    1.218291
 respiratory |   1.064069   .1253693     0.53   0.598     .8446576    1.340476
asthma_sev~e |   .8497057   .1307804    -1.06   0.290     .6284315    1.148892
     cardiac |   .9074827   .1080541    -0.82   0.415     .7185974    1.146017
          af |   1.055738   .1169154     0.49   0.624     .8497513    1.311658
      dvt_pe |   1.149827   .1259013     1.28   0.202      .927747    1.425068
             |
     diabcat |
Controlle..  |   .9367214   .1257738    -0.49   0.626     .7199783    1.218713
Uncontrol..  |   1.450003   .3247964     1.66   0.097      .934765    2.249239
Diabetes,..  |   4.18e-15   2.49e-15   -55.56   0.000     1.30e-15    1.34e-14
             |
       liver |   .9491966   .1140191    -0.43   0.664     .7500814    1.201168
      stroke |   .9470735   .1130657    -0.46   0.649     .7494861    1.196751
         tia |   1.099418   .1255413     0.83   0.407     .8789517    1.375183
    dementia |   .9553812    .109149    -0.40   0.690     .7637124    1.195153
             |
    kidneyfn |
Stage 3a/..  |   4.62e-15   9.94e-16  -153.27   0.000     3.03e-15    7.04e-15
Stage 4/5..  |   .8120722   .1271955    -1.33   0.184     .5974069    1.103873
             |
      spleen |   .9281334   .0878613    -0.79   0.431       .77096    1.117349
  transplant |   .9701244   .1146859    -0.26   0.798     .7694853    1.223079
    dialysis |   1.093387   .1992655     0.49   0.624     .7649726    1.562795
immunosupp~n |   1.011964   .0935062     0.13   0.898     .8443326    1.212877
  cancerHaem |   .9912096   .0391668    -0.22   0.823     .9173415    1.071026
  autoimmune |   1.103762   .1213761     0.90   0.369     .8897592    1.369237
         ibd |   1.058978   .1205411     0.50   0.615     .8472202    1.323662
cancerExha~r |   .9542387   .6907484    -0.06   0.948     .2309375    3.942934
------------------------------------------------------------------------------
                                                         Stratified by stpcode

.         forvalues k = `lo_`exp'' (1) `hi_`exp'' {
  2.                 capture qui di _b[`k'.`exp']
  3.                 if _rc==0 {
  4.                         post `ldrresults' (`i') ("`out'") ("`exp'") ///
>                         ("Confounders+Comorb")                               
>            ///
>                         (`k') (1) (_b[`k'.`exp']) (_se[`k'.`exp'])
  5.                 }
  6.                                 forvalues l = 2 (1) 3 {
  7.                         capture qui di _b[`k'.`exp'#`l'.agebroad]
  8.                         if _rc==0 {
  9.                             lincom `k'.`exp' + `k'.`exp'#`l'.agebroad
 10.                                 post `ldrresults' (`i') ("`out'") ("`exp'"
> )             ///
>                                         ("Confounders+Comorb")               
>                            ///
>                                         (`k') (`l') (r(estimate)) (r(se))
 11.                         }
 12.                 }
 13.         }

 ( 1)  0b.ldr_carecat + 0b.ldr_carecat#2o.agebroad = 0

------------------------------------------------------------------------------
          _t |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
         (1) |          0  (omitted)
------------------------------------------------------------------------------

 ( 1)  0b.ldr_carecat + 0b.ldr_carecat#3o.agebroad = 0

------------------------------------------------------------------------------
          _t |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
         (1) |          0  (omitted)
------------------------------------------------------------------------------

 ( 1)  1.ldr_carecat + 1.ldr_carecat#2.agebroad = 0

------------------------------------------------------------------------------
          _t |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
         (1) |  -33.02637   .4257874   -77.57   0.000     -33.8609   -32.19184
------------------------------------------------------------------------------

 ( 1)  1.ldr_carecat + 1.ldr_carecat#3.agebroad = 0

------------------------------------------------------------------------------
          _t |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
         (1) |  -32.55284   .5741497   -56.70   0.000    -33.67815   -31.42752
------------------------------------------------------------------------------

 ( 1)  2.ldr_carecat + 2.ldr_carecat#2.agebroad = 0

------------------------------------------------------------------------------
          _t |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
         (1) |  -.1092955   .2857246    -0.38   0.702    -.6693054    .4507144
------------------------------------------------------------------------------

 ( 1)  2.ldr_carecat + 2.ldr_carecat#3.agebroad = 0

------------------------------------------------------------------------------
          _t |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
         (1) |   .5304045   .2552555     2.08   0.038      .030113    1.030696
------------------------------------------------------------------------------

.         
.         * All variables
.         stcox i.`exp'##i.agebroad age1 age2 age3 male           ///
>                                 i.ethnicity_5 imd resid_care_ldr             
>    ///
>                                 obese40                                      
>                            ///
>                                 respiratory asthma_severe                    
>            ///
>                                 cardiac af dvt_pe i.diabcat                  
>            ///
>                                 liver stroke tia dementia                    
>            ///
>                                 i.kidneyfn                                   
>                            ///
>                                 spleen transplant dialysis                   
>            ///
>                                 immunosuppression cancerHaem                 
>    ///
>                                 autoimmune ibd cancerExhaem1yr,              
>    ///
>                                 strata(stpcode) cluster(household_id) 

         failure _d:  covidadmission2
   analysis time _t:  stime_covidadmission2/365.25

Iteration 0:   log pseudolikelihood =  -2445.012
Iteration 1:   log pseudolikelihood =  -2426.702
Iteration 2:   log pseudolikelihood = -2425.0824
Iteration 3:   log pseudolikelihood = -2424.5448
Iteration 4:   log pseudolikelihood = -2424.3466
Iteration 5:   log pseudolikelihood = -2424.2737
Iteration 6:   log pseudolikelihood = -2424.2468
Iteration 7:   log pseudolikelihood = -2424.2369
Iteration 8:   log pseudolikelihood = -2424.2333
Iteration 9:   log pseudolikelihood =  -2424.232
Iteration 10:  log pseudolikelihood = -2424.2315
Iteration 11:  log pseudolikelihood = -2424.2313
Iteration 12:  log pseudolikelihood = -2424.2312
Iteration 13:  log pseudolikelihood = -2424.2312
Iteration 14:  log pseudolikelihood = -2424.2312
Iteration 15:  log pseudolikelihood = -2424.2312
Iteration 16:  log pseudolikelihood = -2424.2312
Iteration 17:  log pseudolikelihood = -2424.2312
Iteration 18:  log pseudolikelihood = -2424.2312
Iteration 19:  log pseudolikelihood = -2424.2312
Iteration 20:  log pseudolikelihood = -2424.2312
Iteration 21:  log pseudolikelihood = -2424.2312
Iteration 22:  log pseudolikelihood = -2424.2312
Iteration 23:  log pseudolikelihood = -2424.2312
Iteration 24:  log pseudolikelihood = -2424.2312
Iteration 25:  log pseudolikelihood = -2424.2312
Iteration 26:  log pseudolikelihood = -2424.2312
Iteration 27:  log pseudolikelihood = -2424.2312
Iteration 28:  log pseudolikelihood = -2424.2312
Iteration 29:  log pseudolikelihood = -2424.2312
Iteration 30:  log pseudolikelihood = -2424.2312
Iteration 31:  log pseudolikelihood = -2424.2312
Refining estimates:
Iteration 0:   log pseudolikelihood = -2424.2312
Iteration 1:   log pseudolikelihood = -2424.2312
Iteration 2:   log pseudolikelihood = -2424.2312
Iteration 3:   log pseudolikelihood = -2424.2312
Iteration 4:   log pseudolikelihood = -2424.2312
Iteration 5:   log pseudolikelihood = -2424.2312

Stratified Cox regr. -- Breslow method for ties

No. of subjects      =        4,879             Number of obs    =       4,879
No. of failures      =          492
Time at risk         =  1962.721424
                                                Wald chi2(41)    =    56311.71
Log pseudolikelihood =   -2424.2312             Prob > chi2      =      0.0000

                         (Std. Err. adjusted for 938 clusters in household_id)
------------------------------------------------------------------------------
             |               Robust
          _t | Haz. Ratio   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
 ldr_carecat |
LDR, not ..  |   1.236374   .6448834     0.41   0.684     .4448046    3.436609
LDR, in r..  |   .9284482   .1004184    -0.69   0.492     .7510936    1.147681
             |
    agebroad |
     65-<75  |   .8248276   .2377711    -0.67   0.504     .4688019    1.451233
        75+  |   .7927803   .3723535    -0.49   0.621     .3157621    1.990425
             |
 ldr_carecat#|
    agebroad |
LDR, not .. #|
     65-<75  |   2.20e-16   1.30e-16   -61.26   0.000     6.95e-17    6.98e-16
LDR, not .. #|
        75+  |   3.57e-16   2.49e-16   -50.96   0.000     9.08e-17    1.40e-15
LDR, in r.. #|
     65-<75  |   .9539141   .2921706    -0.15   0.878     .5233571    1.738683
LDR, in r.. #|
        75+  |   1.810111   .5039335     2.13   0.033     1.048893     3.12377
             |
        age1 |    .955267   .0264169    -1.65   0.098      .904869    1.008472
        age2 |   1.109914   .0761322     1.52   0.128     .9702928    1.269625
        age3 |   .7866619    .143957    -1.31   0.190     .5495668    1.126045
        male |   .9916384   .0909057    -0.09   0.927     .8285559     1.18682
             |
 ethnicity_5 |
      Mixed  |   1.097604   .1708778     0.60   0.550     .8089629    1.489234
Asian or ..  |   1.197609   .1827091     1.18   0.237     .8880852    1.615012
      Black  |   1.371023   .2023802     2.14   0.033     1.026589    1.831018
      Other  |   1.127626   .1679167     0.81   0.420     .8421917    1.509798
             |
         imd |   .9845627   .0397959    -0.38   0.700     .9095737    1.065734
resid_care~r |    1.21107   .4067859     0.57   0.569     .6269886    2.339263
     obese40 |   .9800212   .1095465    -0.18   0.857      .787206    1.220064
 respiratory |   1.062799   .1253734     0.52   0.606       .84341    1.339255
asthma_sev~e |   .8502964   .1309131    -1.05   0.292     .6288078    1.149801
     cardiac |   .9087688   .1083688    -0.80   0.422     .7193651    1.148041
          af |   1.055363   .1167306     0.49   0.626     .8496749    1.310843
      dvt_pe |   1.151316    .126224     1.29   0.199     .9286954    1.427301
             |
     diabcat |
Controlle..  |   .9374014   .1258347    -0.48   0.630     .7205468     1.21952
Uncontrol..  |   1.444182   .3234182     1.64   0.101     .9311064    2.239984
Diabetes,..  |   2.10e-16   1.25e-16   -60.79   0.000     6.56e-17    6.73e-16
             |
       liver |   .9490194   .1141389    -0.44   0.664     .7497229    1.201294
      stroke |    .945499    .112727    -0.47   0.638      .748474    1.194388
         tia |   1.099097   .1254835     0.83   0.408      .878728     1.37473
    dementia |   .9553175    .109168    -0.40   0.689     .7636204    1.195138
             |
    kidneyfn |
Stage 3a/..  |   2.29e-16   4.93e-17  -166.98   0.000     1.50e-16    3.49e-16
Stage 4/5..  |   .8144238   .1275834    -1.31   0.190     .5991087    1.107122
             |
      spleen |   .9271241   .0877684    -0.80   0.424     .7701172    1.116141
  transplant |   .9710106   .1148339    -0.25   0.804     .7701209    1.224303
    dialysis |    1.08976   .1987693     0.47   0.637     .7622093    1.558073
immunosupp~n |   1.012153   .0936476     0.13   0.896     .8442879    1.213395
  cancerHaem |   .9916201   .0390214    -0.21   0.831     .9180145    1.071127
  autoimmune |   1.105853   .1217464     0.91   0.361     .8912232    1.372172
         ibd |   1.058687   .1205257     0.50   0.616     .8469604    1.323343
cancerExha~r |    .941523   .6817798    -0.08   0.934     .2277483    3.892304
------------------------------------------------------------------------------
                                                         Stratified by stpcode

.         forvalues k = `lo_`exp'' (1) `hi_`exp'' {
  2.                 capture qui di _b[`k'.`exp']
  3.                 if _rc==0 {
  4.                         post `ldrresults' (`i') ("`out'") ("`exp'")     //
> /
>                         ("All")                                              
>                                    ///
>                         (`k') (1) (_b[`k'.`exp']) (_se[`k'.`exp'])
  5.                 }
  6.                                 forvalues l = 2 (1) 3 {
  7.                         capture qui di _b[`k'.`exp'#`l'.agebroad]
  8.                         if _rc==0 {
  9.                             lincom `k'.`exp' + `k'.`exp'#`l'.agebroad
 10.                                 post `ldrresults' (`i') ("`out'") ("`exp'"
> )     ///
>                                         ("All")                              
>                                    ///
>                                         (`k') (`l') (r(estimate)) (r(se))
 11.                         }
 12.                 }
 13.         }

 ( 1)  0b.ldr_carecat + 0b.ldr_carecat#2o.agebroad = 0

------------------------------------------------------------------------------
          _t |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
         (1) |          0  (omitted)
------------------------------------------------------------------------------

 ( 1)  0b.ldr_carecat + 0b.ldr_carecat#3o.agebroad = 0

------------------------------------------------------------------------------
          _t |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
         (1) |          0  (omitted)
------------------------------------------------------------------------------

 ( 1)  1.ldr_carecat + 1.ldr_carecat#2.agebroad = 0

------------------------------------------------------------------------------
          _t |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
         (1) |  -35.83944   .5231538   -68.51   0.000     -36.8648   -34.81408
------------------------------------------------------------------------------

 ( 1)  1.ldr_carecat + 1.ldr_carecat#3.agebroad = 0

------------------------------------------------------------------------------
          _t |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
         (1) |  -35.35726    .646024   -54.73   0.000    -36.62345   -34.09108
------------------------------------------------------------------------------

 ( 1)  2.ldr_carecat + 2.ldr_carecat#2.agebroad = 0

------------------------------------------------------------------------------
          _t |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
         (1) |  -.1214223   .2867991    -0.42   0.672    -.6835383    .4406936
------------------------------------------------------------------------------

 ( 1)  2.ldr_carecat + 2.ldr_carecat#3.agebroad = 0

------------------------------------------------------------------------------
          _t |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
         (1) |   .5191473   .2566809     2.02   0.043      .016062    1.022233
------------------------------------------------------------------------------

. 
. postclose `ldrresults'

. 
. use `ldrfile', clear

. 
. 
. *************************
. *  Tidy output for HRs  *
. *************************
. 
. * Outcome
. rename outcome out

. gen outcome     = 1 if out=="coviddeath"
(45 missing values generated)

. replace outcome = 2 if out=="covidadmission"
(45 real changes made)

. replace outcome = 3 if out=="composite"
(0 real changes made)

. 
. label define outcome    1 "COVID-19 death"              ///
>                                                 2 "COVID-19 admission"  ///
>                                                 3 "Composite"

. label values outcome outcome

. drop out

. 
. * Exposure
. rename exposure exp

. gen     exposure = 1 if exp=="ldr"
(45 missing values generated)

. replace exposure = 2 if exp=="ldr_cat"
(0 real changes made)

. replace exposure = 3 if exp=="ldr_carecat"
(45 real changes made)

. replace exposure = 4 if exp=="ds"
(0 real changes made)

. replace exposure = 5 if exp=="cp"
(0 real changes made)

. replace exposure = 6 if exp=="ldr_group"
(0 real changes made)

. 
. label define exposure   1 "Learning disability register"        ///
>                                                 2 "LDR Severe vs mild"       
>                    ///
>                                                 3 "LDR by residential care"  
>                    ///
>                                                 4 "Down's syndrome"          
>                            ///
>                                                 5 "Cerebral Palsy"           
>                            ///
>                                                 6 "Combined grouping"        
>                    

. label values exposure exposure                                          

. drop exp

. 
. * Age categories
. label define agebroad   1 "16-<65"              ///
>                                                 2 "65-<75"              ///
>                                                 3 "75+"

. label values agebroad agebroad

. 
. 
. * Categories of exposure
. gen category     = "No"                                         if expcat==0
(30 missing values generated)

. replace category = "Yes"                                        if inlist(exp
> osure, 1, 4, 5) & expcat==1
(0 real changes made)

. 
. replace category = "LDR, mild"                          if inlist(exposure, 2
> ) & expcat==1
(0 real changes made)

. replace category = "LDR, profound"                      if inlist(exposure, 2
> ) & expcat==2
(0 real changes made)

. 
. replace category = "LDR, community"             if inlist(exposure, 3) & expc
> at==1
variable category was str2 now str14
(15 real changes made)

. replace category = "LDR, residential care"      if inlist(exposure, 3) & expc
> at==2
variable category was str14 now str21
(15 real changes made)

. 
. replace category = "DS but not LDR"             if inlist(exposure, 6) & expc
> at==1
(0 real changes made)

. replace category = "DS and LDR"                         if inlist(exposure, 6
> ) & expcat==2
(0 real changes made)

. replace category = "CP but not LDR"             if inlist(exposure, 6) & expc
> at==3
(0 real changes made)

. replace category = "CP and LDR"                         if inlist(exposure, 6
> ) & expcat==4
(0 real changes made)

. replace category = "LDR with no DS or CP"       if inlist(exposure, 6) & expc
> at==5
(0 real changes made)

. 
. * Model adjustment
. gen     adjustment = 1 if model=="Confounders"
(36 missing values generated)

. replace adjustment = 2 if model=="Confounders+IMD"
(9 real changes made)

. replace adjustment = 3 if model=="Confounders+Resid"
(9 real changes made)

. replace adjustment = 4 if model=="Confounders+Comorb"
(9 real changes made)

. replace adjustment = 5 if model=="All"
(9 real changes made)

. label define adj        1 "Confounders"                                      
>    ///     
>                                         2 "Confounders with IMD"             
>            ///
>                                         3 "Confounders with care"            
>            ///
>                                         4 "Confounders with comorbidities"   
>    ///
>                                         5 "All"

. label values adjustment adj

. drop model

. 
. * Hazard ratio with 95% confidence interval
. gen cl = exp(lnhr - invnorm(0.975)*sehr)

. gen cu = exp(lnhr + invnorm(0.975)*sehr)

. gen hr = exp(lnhr)

. 
. gen hr_ci =   string(round(hr, 0.01)) + " (" ///
>                         + string(round(cl, 0.01)) + ", " ///
>                         + string(round(cu, 0.01)) + ")"

. replace hr_ci = "" if expcat==0
(15 real changes made)

. drop cl cu hr lnhr sehr

. 
. * Put in wide format
. reshape wide hr_ci, i(wave outcome exposure expcat agebroad) j(adjust)
(note: j = 1 2 3 4 5)

Data                               long   ->   wide
-----------------------------------------------------------------------------
Number of obs.                       45   ->       9
Number of variables                   8   ->      11
j variable (5 values)        adjustment   ->   (dropped)
xij variables:
                                  hr_ci   ->   hr_ci1 hr_ci2 ... hr_ci5
-----------------------------------------------------------------------------

. rename hr_ci1 hr_conf

. rename hr_ci2 hr_conf_imd

. rename hr_ci3 hr_conf_resid

. rename hr_ci4 hr_conf_comorb

. 
. 
. order wave outcome exposure agebroad category hr*

. sort wave outcome exposure agebroad expcat

. 
. * Save data
. outsheet using "output/ldcox_inter_wave`i'_`out'_`exp'", replace
(note: file output/ldcox_inter_wave2_covidadmission_ldr_carecat.out not found)

. 
. log close
      name:  <unnamed>
       log:  /workspace/logs/AL006_cox_regression_inter_wave2_covidadmission_ld
> r_carecat.log
  log type:  text
 closed on:  25 Feb 2021, 20:11:03
-------------------------------------------------------------------------------
