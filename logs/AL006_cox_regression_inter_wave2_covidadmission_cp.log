-------------------------------------------------------------------------------
      name:  <unnamed>
       log:  /workspace/logs/AL006_cox_regression_inter_wave2_covidadmission_cp
> .log
  log type:  text
 opened on:  25 Feb 2021, 20:13:57

. 
. 
. * Categories of various exposures
. local lo_ldr            = 0

. local hi_ldr            = 1

. local lo_ldr_cat        = 0

. local hi_ldr_cat        = 2

. local hi_ldr            = 1

. local lo_ldr_carecat= 0

. local hi_ldr_carecat= 2

. local lo_ds             = 0

. local hi_ds             = 1

. local lo_cp             = 0

. local hi_cp             = 1

. local lo_ldr_group      = 0

. local hi_ldr_group      = 5

. 
. * Open temporary file to post results
. tempfile ldrfile

. tempname ldrresults

. 
. postfile `ldrresults'   wave str15(outcome) str15(exposure) str20(model)     
>    ///
>                                                 expcat agebroad lnhr sehr usi
> ng `ldrfile'

. 
. 
.         * Open dataset (complete case ethnicity)
.         use "analysis/data_ldanalysis_cohort`i'.dta", clear 
(Analysis dataset, wave 2 (1 Sept 20 - latest), for learning disability work)

.         drop if ethnicity_5>=.
(11,245 observations deleted)

. 
.         * Only keep data for adults
.         keep if child==0
(6,499 observations deleted)

. 
.         
.         /*  Declare data to be survival  */
. 
.         stset stime_`out'`i', fail(`out'`i') scale(365.25)

     failure event:  covidadmission2 != 0 & covidadmission2 < .
obs. time interval:  (0, stime_covidadmission2]
 exit on or before:  failure
    t for analysis:  time/365.25

------------------------------------------------------------------------------
     27,126  total observations
      2,767  observations end on or before enter()
------------------------------------------------------------------------------
     24,359  observations remaining, representing
      2,360  failures in single-record/single-failure data
  9,788.172  total analysis time at risk and under observation
                                                at risk from t =         0
                                     earliest observed entry t =         0
                                          last observed exit t =  .4462697

. 
.         
.                 
.         /*  Fit Cox models  */
.         
.         * Confounder only model
.         stcox i.`exp'##i.agebroad age1 age2 age3 male i.ethnicity_5,    ///
>                 strata(stpcode) cluster(household_id) 

         failure _d:  covidadmission2
   analysis time _t:  stime_covidadmission2/365.25

Iteration 0:   log pseudolikelihood = -15518.831
Iteration 1:   log pseudolikelihood = -15508.648
Iteration 2:   log pseudolikelihood =  -15508.58
Iteration 3:   log pseudolikelihood =  -15508.58
Refining estimates:
Iteration 0:   log pseudolikelihood =  -15508.58

Stratified Cox regr. -- Breslow method for ties

No. of subjects      =       24,359             Number of obs    =      24,359
No. of failures      =        2,360
Time at risk         =  9788.172485
                                                Wald chi2(13)    =       20.25
Log pseudolikelihood =    -15508.58             Prob > chi2      =      0.0892

                       (Std. Err. adjusted for 1,195 clusters in household_id)
------------------------------------------------------------------------------
             |               Robust
          _t | Haz. Ratio   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
        1.cp |   .9608657   .0556279    -0.69   0.490     .8577953    1.076321
             |
    agebroad |
     65-<75  |   .8646633   .1007196    -1.25   0.212     .6881696    1.086422
        75+  |    .941271   .1911347    -0.30   0.766     .6322219    1.401393
             |
 cp#agebroad |
   1#65-<75  |    .792407    .144986    -1.27   0.203      .553611    1.134206
      1#75+  |   1.067081    .173692     0.40   0.690     .7756125    1.468081
             |
        age1 |   1.001105   .0129476     0.09   0.932     .9760466    1.026806
        age2 |   .9973388   .0313533    -0.08   0.932     .9377424    1.060723
        age3 |   1.011883   .0834939     0.14   0.886     .8607855    1.189504
        male |   1.076479   .0423395     1.87   0.061     .9966135    1.162746
             |
 ethnicity_5 |
      Mixed  |   1.041838   .0693321     0.62   0.538     .9144387    1.186987
Asian or ..  |     1.0441   .0716772     0.63   0.530      .912657    1.194475
      Black  |   1.164716   .0770391     2.31   0.021       1.0231    1.325934
      Other  |   .9832254   .0671201    -0.25   0.804     .8600935    1.123985
------------------------------------------------------------------------------
                                                         Stratified by stpcode

.         forvalues k = `lo_`exp'' (1) `hi_`exp'' {
  2.                 capture qui di _b[`k'.`exp']
  3.                 if _rc==0 {
  4.                         post `ldrresults' (`i') ("`out'") ("`exp'")       
>       ///
>                                 ("Confounders")                              
>                            ///
>                                 (`k') (1) (_b[`k'.`exp']) (_se[`k'.`exp'])
  5.                 }
  6.                 forvalues l = 2 (1) 3 {
  7.                         capture qui di _b[`k'.`exp'#`l'.agebroad]
  8.                         if _rc==0 {
  9.                             lincom `k'.`exp' + `k'.`exp'#`l'.agebroad
 10.                                 post `ldrresults' (`i') ("`out'") ("`exp'"
> )             ///
>                                         ("Confounders")                      
>                                    ///
>                                         (`k') (`l') (r(estimate)) (r(se))
 11.                         }
 12.                 }
 13.         }

 ( 1)  0b.cp + 0b.cp#2o.agebroad = 0

------------------------------------------------------------------------------
          _t |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
         (1) |          0  (omitted)
------------------------------------------------------------------------------

 ( 1)  0b.cp + 0b.cp#3o.agebroad = 0

------------------------------------------------------------------------------
          _t |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
         (1) |          0  (omitted)
------------------------------------------------------------------------------

 ( 1)  1.cp + 1.cp#2.agebroad = 0

------------------------------------------------------------------------------
          _t |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
         (1) |  -.2726008   .1741034    -1.57   0.117    -.6138372    .0686356
------------------------------------------------------------------------------

 ( 1)  1.cp + 1.cp#3.agebroad = 0

------------------------------------------------------------------------------
          _t |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
         (1) |   .0250064   .1487093     0.17   0.866    -.2664584    .3164713
------------------------------------------------------------------------------

.         
.         * Confounders with deprivation
.         stcox i.`exp'##i.agebroad age1 age2 age3 male i.ethnicity_5 imd, ///
>                 strata(stpcode) cluster(household_id) 

         failure _d:  covidadmission2
   analysis time _t:  stime_covidadmission2/365.25

Iteration 0:   log pseudolikelihood = -15518.831
Iteration 1:   log pseudolikelihood = -15508.641
Iteration 2:   log pseudolikelihood = -15508.573
Iteration 3:   log pseudolikelihood = -15508.573
Refining estimates:
Iteration 0:   log pseudolikelihood = -15508.573

Stratified Cox regr. -- Breslow method for ties

No. of subjects      =       24,359             Number of obs    =      24,359
No. of failures      =        2,360
Time at risk         =  9788.172485
                                                Wald chi2(14)    =       20.25
Log pseudolikelihood =   -15508.573             Prob > chi2      =      0.1223

                       (Std. Err. adjusted for 1,195 clusters in household_id)
------------------------------------------------------------------------------
             |               Robust
          _t | Haz. Ratio   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
        1.cp |    .960823   .0556301    -0.69   0.490     .8577489    1.076283
             |
    agebroad |
     65-<75  |   .8645753   .1006996    -1.25   0.212     .6881148    1.086288
        75+  |   .9413758   .1911457    -0.30   0.766     .6323058    1.401519
             |
 cp#agebroad |
   1#65-<75  |   .7924671   .1449985    -1.27   0.204     .5536509    1.134296
      1#75+  |   1.067183   .1737154     0.40   0.690     .7756765     1.46824
             |
        age1 |     1.0011    .012947     0.09   0.932     .9760434      1.0268
        age2 |   .9973516   .0313515    -0.08   0.933     .9377584    1.060732
        age3 |   1.011846   .0834851     0.14   0.887     .8607634    1.189447
        male |   1.076462   .0423305     1.87   0.061     .9966128     1.16271
             |
 ethnicity_5 |
      Mixed  |    1.04185   .0693293     0.62   0.538     .9144554    1.186992
Asian or ..  |   1.044104   .0716775     0.63   0.530     .9126597    1.194479
      Black  |   1.164624   .0769806     2.31   0.021     1.023109    1.325713
      Other  |   .9831397   .0670831    -0.25   0.803     .8600718    1.123817
             |
         imd |   .9979539   .0172852    -0.12   0.906     .9646442    1.032414
------------------------------------------------------------------------------
                                                         Stratified by stpcode

.         forvalues k = `lo_`exp'' (1) `hi_`exp'' {
  2.                 capture qui di _b[`k'.`exp']
  3.                 if _rc==0 {
  4.                         post `ldrresults' (`i') ("`out'") ("`exp'")     //
> /
>                                 ("Confounders+IMD")                          
>                    ///
>                                 (`k') (1) (_b[`k'.`exp']) (_se[`k'.`exp'])
  5.                 }       
  6.                 forvalues l = 2 (1) 3 {
  7.                         capture qui di _b[`k'.`exp'#`l'.agebroad]
  8.                         if _rc==0 {
  9.                             lincom `k'.`exp' + `k'.`exp'#`l'.agebroad
 10.                                 post `ldrresults' (`i') ("`out'") ("`exp'"
> )             ///
>                                         ("Confounders+IMD")                  
>                            ///
>                                         (`k') (`l') (r(estimate)) (r(se))
 11.                         }
 12.                 }
 13.         }

 ( 1)  0b.cp + 0b.cp#2o.agebroad = 0

------------------------------------------------------------------------------
          _t |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
         (1) |          0  (omitted)
------------------------------------------------------------------------------

 ( 1)  0b.cp + 0b.cp#3o.agebroad = 0

------------------------------------------------------------------------------
          _t |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
         (1) |          0  (omitted)
------------------------------------------------------------------------------

 ( 1)  1.cp + 1.cp#2.agebroad = 0

------------------------------------------------------------------------------
          _t |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
         (1) |  -.2725693   .1741064    -1.57   0.117    -.6138116    .0686729
------------------------------------------------------------------------------

 ( 1)  1.cp + 1.cp#3.agebroad = 0

------------------------------------------------------------------------------
          _t |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
         (1) |    .025057   .1487084     0.17   0.866    -.2664061    .3165201
------------------------------------------------------------------------------

.         
.         * Confounders with residential care
.         stcox i.`exp'##i.agebroad age1 age2 age3 male   ///
>                                 i.ethnicity_5 resid_care_ldr,           ///
>                 strata(stpcode) cluster(household_id) 

         failure _d:  covidadmission2
   analysis time _t:  stime_covidadmission2/365.25

Iteration 0:   log pseudolikelihood = -15518.831
Iteration 1:   log pseudolikelihood = -15508.152
Iteration 2:   log pseudolikelihood = -15508.083
Iteration 3:   log pseudolikelihood = -15508.083
Refining estimates:
Iteration 0:   log pseudolikelihood = -15508.083

Stratified Cox regr. -- Breslow method for ties

No. of subjects      =       24,359             Number of obs    =      24,359
No. of failures      =        2,360
Time at risk         =  9788.172485
                                                Wald chi2(14)    =       21.15
Log pseudolikelihood =   -15508.083             Prob > chi2      =      0.0978

                       (Std. Err. adjusted for 1,195 clusters in household_id)
------------------------------------------------------------------------------
             |               Robust
          _t | Haz. Ratio   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
        1.cp |   .9614768   .0556693    -0.68   0.497     .8583302    1.077019
             |
    agebroad |
     65-<75  |   .8636995   .1006028    -1.26   0.208     .6874096      1.0852
        75+  |   .9388772   .1906621    -0.31   0.756     .6305963    1.397868
             |
 cp#agebroad |
   1#65-<75  |   .7920026   .1449224    -1.27   0.203     .5533143    1.133656
      1#75+  |   1.066535   .1735689     0.40   0.692     .7752642    1.467237
             |
        age1 |    1.00124   .0129522     0.10   0.924     .9761732     1.02695
        age2 |   .9969721   .0313501    -0.10   0.923     .9373822     1.06035
        age3 |   1.012953   .0836045     0.16   0.876     .8616579    1.190813
        male |   1.076114    .042331     1.86   0.062     .9962648    1.162364
             |
 ethnicity_5 |
      Mixed  |   1.041978   .0693283     0.62   0.537     .9145837    1.187117
Asian or ..  |   1.044171   .0716844     0.63   0.529     .9127149    1.194561
      Black  |   1.164842    .077044     2.31   0.021     1.023217     1.32607
      Other  |   .9836799   .0671367    -0.24   0.809     .8605157    1.124472
             |
resid_care~r |   1.111232   .1213502     0.97   0.334     .8971205    1.376445
------------------------------------------------------------------------------
                                                         Stratified by stpcode

.         forvalues k = `lo_`exp'' (1) `hi_`exp'' {
  2.                 capture qui di _b[`k'.`exp']
  3.                 if _rc==0 {
  4.                         post `ldrresults' (`i') ("`out'") ("`exp'")     //
> /
>                                 ("Confounders+Resid")                        
>                    ///
>                                 (`k') (1) (_b[`k'.`exp']) (_se[`k'.`exp'])
  5.                 }               
  6.                 forvalues l = 2 (1) 3 {
  7.                         capture qui di _b[`k'.`exp'#`l'.agebroad]
  8.                         if _rc==0 {
  9.                             lincom `k'.`exp' + `k'.`exp'#`l'.agebroad
 10.                                 post `ldrresults' (`i') ("`out'") ("`exp'"
> )             ///
>                                         ("Confounders+Resid")                
>                            ///
>                                         (`k') (`l') (r(estimate)) (r(se))
 11.                         }
 12.                 }
 13.         }

 ( 1)  0b.cp + 0b.cp#2o.agebroad = 0

------------------------------------------------------------------------------
          _t |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
         (1) |          0  (omitted)
------------------------------------------------------------------------------

 ( 1)  0b.cp + 0b.cp#3o.agebroad = 0

------------------------------------------------------------------------------
          _t |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
         (1) |          0  (omitted)
------------------------------------------------------------------------------

 ( 1)  1.cp + 1.cp#2.agebroad = 0

------------------------------------------------------------------------------
          _t |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
         (1) |  -.2724754    .174123    -1.56   0.118    -.6137503    .0687994
------------------------------------------------------------------------------

 ( 1)  1.cp + 1.cp#3.agebroad = 0

------------------------------------------------------------------------------
          _t |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
         (1) |   .0251302   .1486753     0.17   0.866     -.266268    .3165284
------------------------------------------------------------------------------

.         
.         * Confounders with physical comorbidities that are indicators for vac
> cination 
.         stcox i.`exp'##i.agebroad age1 age2 age3 male           ///
>                                 i.ethnicity_5                                
>                    ///
>                                 obese40                                      
>                            ///
>                                 respiratory asthma_severe                    
>            ///
>                                 cardiac af dvt_pe i.diabcat                  
>            ///
>                                 liver stroke tia dementia                    
>            ///
>                                 i.kidneyfn                                   
>                            ///
>                                 spleen transplant dialysis                   
>            ///
>                                 immunosuppression cancerHaem                 
>    ///
>                                 autoimmune ibd cancerExhaem1yr,              
>    ///
>                 strata(stpcode) cluster(household_id) 

         failure _d:  covidadmission2
   analysis time _t:  stime_covidadmission2/365.25

Iteration 0:   log pseudolikelihood =  -2445.012
Iteration 1:   log pseudolikelihood = -2429.7656
Iteration 2:   log pseudolikelihood = -2428.6054
Iteration 3:   log pseudolikelihood = -2428.2072
Iteration 4:   log pseudolikelihood =  -2428.061
Iteration 5:   log pseudolikelihood = -2428.0072
Iteration 6:   log pseudolikelihood = -2427.9875
Iteration 7:   log pseudolikelihood = -2427.9802
Iteration 8:   log pseudolikelihood = -2427.9775
Iteration 9:   log pseudolikelihood = -2427.9766
Iteration 10:  log pseudolikelihood = -2427.9762
Iteration 11:  log pseudolikelihood = -2427.9761
Iteration 12:  log pseudolikelihood =  -2427.976
Iteration 13:  log pseudolikelihood =  -2427.976
Iteration 14:  log pseudolikelihood =  -2427.976
Iteration 15:  log pseudolikelihood =  -2427.976
Iteration 16:  log pseudolikelihood =  -2427.976
Iteration 17:  log pseudolikelihood =  -2427.976
Iteration 18:  log pseudolikelihood =  -2427.976
Iteration 19:  log pseudolikelihood =  -2427.976
Iteration 20:  log pseudolikelihood =  -2427.976
Iteration 21:  log pseudolikelihood =  -2427.976
Iteration 22:  log pseudolikelihood =  -2427.976
Iteration 23:  log pseudolikelihood =  -2427.976
Iteration 24:  log pseudolikelihood =  -2427.976
Iteration 25:  log pseudolikelihood =  -2427.976
Iteration 26:  log pseudolikelihood =  -2427.976
Iteration 27:  log pseudolikelihood =  -2427.976
Iteration 28:  log pseudolikelihood =  -2427.976
Iteration 29:  log pseudolikelihood =  -2427.976
Iteration 30:  log pseudolikelihood =  -2427.976
Iteration 31:  log pseudolikelihood =  -2427.976
Refining estimates:
Iteration 0:   log pseudolikelihood =  -2427.976
Iteration 1:   log pseudolikelihood =  -2427.976

Stratified Cox regr. -- Breslow method for ties

No. of subjects      =        4,879             Number of obs    =       4,879
No. of failures      =          492
Time at risk         =  1962.721424
                                                Wald chi2(36)    =    38096.50
Log pseudolikelihood =    -2427.976             Prob > chi2      =      0.0000

                         (Std. Err. adjusted for 938 clusters in household_id)
------------------------------------------------------------------------------
             |               Robust
          _t | Haz. Ratio   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
        1.cp |   .9656913   .1219435    -0.28   0.782     .7539667    1.236871
             |
    agebroad |
     65-<75  |   .7930965   .2137055    -0.86   0.390      .467696    1.344895
        75+  |   .9459797   .4276173    -0.12   0.902     .3900388     2.29433
             |
 cp#agebroad |
   1#65-<75  |   .9258809   .3560403    -0.20   0.841     .4357448    1.967334
      1#75+  |   1.125773   .4109429     0.32   0.746     .5504722    2.302324
             |
        age1 |   .9563433   .0264351    -1.61   0.106       .90591    1.009584
        age2 |   1.105901   .0757272     1.47   0.142     .9670071    1.264744
        age3 |   .7964147    .145373    -1.25   0.212     .5568853    1.138971
        male |   .9915022   .0907183    -0.09   0.926     .8287286    1.186247
             |
 ethnicity_5 |
      Mixed  |   1.098325   .1704397     0.60   0.546     .8102899     1.48875
Asian or ..  |   1.208172   .1843834     1.24   0.215     .8958267    1.629423
      Black  |   1.379528   .2032992     2.18   0.029     1.033451    1.841497
      Other  |   1.127714   .1682438     0.81   0.420     .8417983     1.51074
             |
     obese40 |   .9756587    .109034    -0.22   0.825      .783741    1.214572
 respiratory |    1.06233   .1250237     0.51   0.607     .8434957    1.337937
asthma_sev~e |   .8482366   .1303969    -1.07   0.284     .6275731    1.146488
     cardiac |   .9078016   .1081569    -0.81   0.417     .7187494     1.14658
          af |   1.054716   .1169619     0.48   0.631     .8486764    1.310777
      dvt_pe |   1.146005   .1252375     1.25   0.212     .9250513    1.419735
             |
     diabcat |
Controlle..  |   .9384982   .1259086    -0.47   0.636     .7215003     1.22076
Uncontrol..  |   1.411707   .3165245     1.54   0.124     .9096896    2.190765
Diabetes,..  |   1.19e-14   6.84e-15   -55.56   0.000     3.83e-15    3.68e-14
             |
       liver |   .9502502   .1142534    -0.42   0.671     .7507471    1.202769
      stroke |   .9391625   .1120466    -0.53   0.599     .7433414    1.186569
         tia |   1.098689   .1258697     0.82   0.411     .8777246    1.375281
    dementia |   .9588936   .1090289    -0.37   0.712     .7673375    1.198269
             |
    kidneyfn |
Stage 3a/..  |   1.15e-14   2.44e-15  -151.04   0.000     7.57e-15    1.74e-14
Stage 4/5..  |   .8069469   .1264697    -1.37   0.171     .5935255    1.097111
             |
      spleen |   .9291409   .0877775    -0.78   0.437     .7720887     1.11814
  transplant |    .969369   .1145866    -0.26   0.792     .7689017    1.222102
    dialysis |   1.099038   .2002947     0.52   0.604     .7689269     1.57087
immunosupp~n |   1.016617   .0943703     0.18   0.859      .847505    1.219474
  cancerHaem |   .9920308    .039174    -0.20   0.839     .9181472     1.07186
  autoimmune |   1.109265     .12195     0.94   0.346     .8942447    1.375988
         ibd |   1.059158   .1205383     0.51   0.614     .8474014    1.323831
cancerExha~r |   .9758882   .7073854    -0.03   0.973     .2357195    4.040217
------------------------------------------------------------------------------
                                                         Stratified by stpcode

.         forvalues k = `lo_`exp'' (1) `hi_`exp'' {
  2.                 capture qui di _b[`k'.`exp']
  3.                 if _rc==0 {
  4.                         post `ldrresults' (`i') ("`out'") ("`exp'") ///
>                         ("Confounders+Comorb")                               
>            ///
>                         (`k') (1) (_b[`k'.`exp']) (_se[`k'.`exp'])
  5.                 }
  6.                                 forvalues l = 2 (1) 3 {
  7.                         capture qui di _b[`k'.`exp'#`l'.agebroad]
  8.                         if _rc==0 {
  9.                             lincom `k'.`exp' + `k'.`exp'#`l'.agebroad
 10.                                 post `ldrresults' (`i') ("`out'") ("`exp'"
> )             ///
>                                         ("Confounders+Comorb")               
>                            ///
>                                         (`k') (`l') (r(estimate)) (r(se))
 11.                         }
 12.                 }
 13.         }

 ( 1)  0b.cp + 0b.cp#2o.agebroad = 0

------------------------------------------------------------------------------
          _t |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
         (1) |          0  (omitted)
------------------------------------------------------------------------------

 ( 1)  0b.cp + 0b.cp#3o.agebroad = 0

------------------------------------------------------------------------------
          _t |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
         (1) |          0  (omitted)
------------------------------------------------------------------------------

 ( 1)  1.cp + 1.cp#2.agebroad = 0

------------------------------------------------------------------------------
          _t |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
         (1) |  -.1119207    .357886    -0.31   0.754    -.8133644    .5895231
------------------------------------------------------------------------------

 ( 1)  1.cp + 1.cp#3.agebroad = 0

------------------------------------------------------------------------------
          _t |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
         (1) |   .0835591   .3374839     0.25   0.804    -.5778972    .7450154
------------------------------------------------------------------------------

.         
.         * All variables
.         stcox i.`exp'##i.agebroad age1 age2 age3 male           ///
>                                 i.ethnicity_5 imd resid_care_ldr             
>    ///
>                                 obese40                                      
>                            ///
>                                 respiratory asthma_severe                    
>            ///
>                                 cardiac af dvt_pe i.diabcat                  
>            ///
>                                 liver stroke tia dementia                    
>            ///
>                                 i.kidneyfn                                   
>                            ///
>                                 spleen transplant dialysis                   
>            ///
>                                 immunosuppression cancerHaem                 
>    ///
>                                 autoimmune ibd cancerExhaem1yr,              
>    ///
>                                 strata(stpcode) cluster(household_id) 

         failure _d:  covidadmission2
   analysis time _t:  stime_covidadmission2/365.25

Iteration 0:   log pseudolikelihood =  -2445.012
Iteration 1:   log pseudolikelihood =  -2429.357
Iteration 2:   log pseudolikelihood = -2428.1955
Iteration 3:   log pseudolikelihood = -2427.7975
Iteration 4:   log pseudolikelihood = -2427.6514
Iteration 5:   log pseudolikelihood = -2427.5977
Iteration 6:   log pseudolikelihood = -2427.5779
Iteration 7:   log pseudolikelihood = -2427.5707
Iteration 8:   log pseudolikelihood =  -2427.568
Iteration 9:   log pseudolikelihood =  -2427.567
Iteration 10:  log pseudolikelihood = -2427.5666
Iteration 11:  log pseudolikelihood = -2427.5665
Iteration 12:  log pseudolikelihood = -2427.5665
Iteration 13:  log pseudolikelihood = -2427.5664
Iteration 14:  log pseudolikelihood = -2427.5664
Iteration 15:  log pseudolikelihood = -2427.5664
Iteration 16:  log pseudolikelihood = -2427.5664
Iteration 17:  log pseudolikelihood = -2427.5664
Iteration 18:  log pseudolikelihood = -2427.5664
Iteration 19:  log pseudolikelihood = -2427.5664
Iteration 20:  log pseudolikelihood = -2427.5664
Iteration 21:  log pseudolikelihood = -2427.5664
Iteration 22:  log pseudolikelihood = -2427.5664
Iteration 23:  log pseudolikelihood = -2427.5664
Iteration 24:  log pseudolikelihood = -2427.5664
Iteration 25:  log pseudolikelihood = -2427.5664
Iteration 26:  log pseudolikelihood = -2427.5664
Iteration 27:  log pseudolikelihood = -2427.5664
Iteration 28:  log pseudolikelihood = -2427.5664
Iteration 29:  log pseudolikelihood = -2427.5664
Iteration 30:  log pseudolikelihood = -2427.5664
Refining estimates:
Iteration 0:   log pseudolikelihood = -2427.5664
Iteration 1:   log pseudolikelihood = -2427.5664
Iteration 2:   log pseudolikelihood = -2427.5664
Iteration 3:   log pseudolikelihood = -2427.5664

Stratified Cox regr. -- Breslow method for ties

No. of subjects      =        4,879             Number of obs    =       4,879
No. of failures      =          492
Time at risk         =  1962.721424
                                                Wald chi2(38)    =    40445.83
Log pseudolikelihood =   -2427.5664             Prob > chi2      =      0.0000

                         (Std. Err. adjusted for 938 clusters in household_id)
------------------------------------------------------------------------------
             |               Robust
          _t | Haz. Ratio   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
        1.cp |   .9702004   .1228635    -0.24   0.811     .7569508    1.243527
             |
    agebroad |
     65-<75  |   .7915621   .2133875    -0.87   0.386     .4666809     1.34261
        75+  |    .936815   .4245132    -0.14   0.885     .3854215    2.277045
             |
 cp#agebroad |
   1#65-<75  |   .9214478   .3541266    -0.21   0.831     .4338512    1.957044
      1#75+  |   1.134508   .4136987     0.35   0.729     .5551582    2.318454
             |
        age1 |   .9565037   .0264646    -1.61   0.108     .9060153    1.009806
        age2 |   1.105107   .0757702     1.46   0.145     .9661457    1.264054
        age3 |   .7984489   .1459975    -1.23   0.218     .5579609     1.14259
        male |   .9902767   .0906585    -0.11   0.915     .8276185    1.184903
             |
 ethnicity_5 |
      Mixed  |   1.095994   .1701244     0.59   0.555     .8085028    1.485713
Asian or ..  |   1.205971   .1838865     1.23   0.219     .8944284    1.626028
      Black  |   1.378355   .2028835     2.18   0.029     1.032929    1.839295
      Other  |   1.127256   .1682253     0.80   0.422     .8413832    1.510257
             |
         imd |   .9829772   .0396667    -0.43   0.670     .9082269     1.06388
resid_care~r |   1.203479    .327572     0.68   0.496     .7059143    2.051752
     obese40 |   .9778632    .109182    -0.20   0.841     .7856667    1.217076
 respiratory |   1.063463   .1251914     0.52   0.601     .8443422    1.339449
asthma_sev~e |   .8498787   .1306573    -1.06   0.290     .6287765    1.148729
     cardiac |   .9096325   .1085841    -0.79   0.428     .7198747     1.14941
          af |   1.053799    .116647     0.47   0.636     .8482755    1.309119
      dvt_pe |   1.146853    .125363     1.25   0.210     .9256833    1.420865
             |
     diabcat |
Controlle..  |   .9379417   .1259036    -0.48   0.633     .7209676    1.220214
Uncontrol..  |   1.408934   .3160119     1.53   0.126     .9077653    2.186794
Diabetes,..  |   4.36e-15   2.51e-15   -57.41   0.000     1.41e-15    1.35e-14
             |
       liver |   .9497033   .1143273    -0.43   0.668     .7500989    1.202423
      stroke |   .9374352   .1116336    -0.54   0.587     .7422954    1.183875
         tia |   1.097171   .1256168     0.81   0.418     .8766348    1.373187
    dementia |   .9592102   .1090598    -0.37   0.714     .7675988    1.198652
             |
    kidneyfn |
Stage 3a/..  |   4.22e-15   8.99e-16  -155.54   0.000     2.78e-15    6.41e-15
Stage 4/5..  |   .8093317   .1268675    -1.35   0.177      .595245    1.100417
             |
      spleen |   .9282893   .0877006    -0.79   0.431     .7713751    1.117123
  transplant |   .9707088   .1148382    -0.25   0.802     .7698194    1.224021
    dialysis |   1.095509   .1997391     0.50   0.617     .7663376    1.566071
immunosupp~n |   1.016968   .0944795     0.18   0.856     .8476724    1.220075
  cancerHaem |   .9920571   .0390982    -0.20   0.840     .9183109    1.071725
  autoimmune |   1.111058   .1221951     0.96   0.338     .8956135    1.378328
         ibd |   1.058353   .1204178     0.50   0.618     .8468022    1.322753
cancerExha~r |   .9634971   .6982429    -0.05   0.959     .2328025    3.987614
------------------------------------------------------------------------------
                                                         Stratified by stpcode

.         forvalues k = `lo_`exp'' (1) `hi_`exp'' {
  2.                 capture qui di _b[`k'.`exp']
  3.                 if _rc==0 {
  4.                         post `ldrresults' (`i') ("`out'") ("`exp'")     //
> /
>                         ("All")                                              
>                                    ///
>                         (`k') (1) (_b[`k'.`exp']) (_se[`k'.`exp'])
  5.                 }
  6.                                 forvalues l = 2 (1) 3 {
  7.                         capture qui di _b[`k'.`exp'#`l'.agebroad]
  8.                         if _rc==0 {
  9.                             lincom `k'.`exp' + `k'.`exp'#`l'.agebroad
 10.                                 post `ldrresults' (`i') ("`out'") ("`exp'"
> )     ///
>                                         ("All")                              
>                                    ///
>                                         (`k') (`l') (r(estimate)) (r(se))
 11.                         }
 12.                 }
 13.         }

 ( 1)  0b.cp + 0b.cp#2o.agebroad = 0

------------------------------------------------------------------------------
          _t |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
         (1) |          0  (omitted)
------------------------------------------------------------------------------

 ( 1)  0b.cp + 0b.cp#3o.agebroad = 0

------------------------------------------------------------------------------
          _t |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
         (1) |          0  (omitted)
------------------------------------------------------------------------------

 ( 1)  1.cp + 1.cp#2.agebroad = 0

------------------------------------------------------------------------------
          _t |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
         (1) |  -.1120617   .3577012    -0.31   0.754    -.8131432    .5890198
------------------------------------------------------------------------------

 ( 1)  1.cp + 1.cp#3.agebroad = 0

------------------------------------------------------------------------------
          _t |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
         (1) |   .0959466   .3373054     0.28   0.776    -.5651599     .757053
------------------------------------------------------------------------------

. 
. postclose `ldrresults'

. 
. use `ldrfile', clear

. 
. 
. *************************
. *  Tidy output for HRs  *
. *************************
. 
. * Outcome
. rename outcome out

. gen outcome     = 1 if out=="coviddeath"
(30 missing values generated)

. replace outcome = 2 if out=="covidadmission"
(30 real changes made)

. replace outcome = 3 if out=="composite"
(0 real changes made)

. 
. label define outcome    1 "COVID-19 death"              ///
>                                                 2 "COVID-19 admission"  ///
>                                                 3 "Composite"

. label values outcome outcome

. drop out

. 
. * Exposure
. rename exposure exp

. gen     exposure = 1 if exp=="ldr"
(30 missing values generated)

. replace exposure = 2 if exp=="ldr_cat"
(0 real changes made)

. replace exposure = 3 if exp=="ldr_carecat"
(0 real changes made)

. replace exposure = 4 if exp=="ds"
(0 real changes made)

. replace exposure = 5 if exp=="cp"
(30 real changes made)

. replace exposure = 6 if exp=="ldr_group"
(0 real changes made)

. 
. label define exposure   1 "Learning disability register"        ///
>                                                 2 "LDR Severe vs mild"       
>                    ///
>                                                 3 "LDR by residential care"  
>                    ///
>                                                 4 "Down's syndrome"          
>                            ///
>                                                 5 "Cerebral Palsy"           
>                            ///
>                                                 6 "Combined grouping"        
>                    

. label values exposure exposure                                          

. drop exp

. 
. * Age categories
. label define agebroad   1 "16-<65"              ///
>                                                 2 "65-<75"              ///
>                                                 3 "75+"

. label values agebroad agebroad

. 
. 
. * Categories of exposure
. gen category     = "No"                                         if expcat==0
(15 missing values generated)

. replace category = "Yes"                                        if inlist(exp
> osure, 1, 4, 5) & expcat==1
variable category was str2 now str3
(15 real changes made)

. 
. replace category = "LDR, mild"                          if inlist(exposure, 2
> ) & expcat==1
(0 real changes made)

. replace category = "LDR, profound"                      if inlist(exposure, 2
> ) & expcat==2
(0 real changes made)

. 
. replace category = "LDR, community"             if inlist(exposure, 3) & expc
> at==1
(0 real changes made)

. replace category = "LDR, residential care"      if inlist(exposure, 3) & expc
> at==2
(0 real changes made)

. 
. replace category = "DS but not LDR"             if inlist(exposure, 6) & expc
> at==1
(0 real changes made)

. replace category = "DS and LDR"                         if inlist(exposure, 6
> ) & expcat==2
(0 real changes made)

. replace category = "CP but not LDR"             if inlist(exposure, 6) & expc
> at==3
(0 real changes made)

. replace category = "CP and LDR"                         if inlist(exposure, 6
> ) & expcat==4
(0 real changes made)

. replace category = "LDR with no DS or CP"       if inlist(exposure, 6) & expc
> at==5
(0 real changes made)

. 
. * Model adjustment
. gen     adjustment = 1 if model=="Confounders"
(24 missing values generated)

. replace adjustment = 2 if model=="Confounders+IMD"
(6 real changes made)

. replace adjustment = 3 if model=="Confounders+Resid"
(6 real changes made)

. replace adjustment = 4 if model=="Confounders+Comorb"
(6 real changes made)

. replace adjustment = 5 if model=="All"
(6 real changes made)

. label define adj        1 "Confounders"                                      
>    ///     
>                                         2 "Confounders with IMD"             
>            ///
>                                         3 "Confounders with care"            
>            ///
>                                         4 "Confounders with comorbidities"   
>    ///
>                                         5 "All"

. label values adjustment adj

. drop model

. 
. * Hazard ratio with 95% confidence interval
. gen cl = exp(lnhr - invnorm(0.975)*sehr)

. gen cu = exp(lnhr + invnorm(0.975)*sehr)

. gen hr = exp(lnhr)

. 
. gen hr_ci =   string(round(hr, 0.01)) + " (" ///
>                         + string(round(cl, 0.01)) + ", " ///
>                         + string(round(cu, 0.01)) + ")"

. replace hr_ci = "" if expcat==0
(15 real changes made)

. drop cl cu hr lnhr sehr

. 
. * Put in wide format
. reshape wide hr_ci, i(wave outcome exposure expcat agebroad) j(adjust)
(note: j = 1 2 3 4 5)

Data                               long   ->   wide
-----------------------------------------------------------------------------
Number of obs.                       30   ->       6
Number of variables                   8   ->      11
j variable (5 values)        adjustment   ->   (dropped)
xij variables:
                                  hr_ci   ->   hr_ci1 hr_ci2 ... hr_ci5
-----------------------------------------------------------------------------

. rename hr_ci1 hr_conf

. rename hr_ci2 hr_conf_imd

. rename hr_ci3 hr_conf_resid

. rename hr_ci4 hr_conf_comorb

. 
. 
. order wave outcome exposure agebroad category hr*

. sort wave outcome exposure agebroad expcat

. 
. * Save data
. outsheet using "output/ldcox_inter_wave`i'_`out'_`exp'", replace
(note: file output/ldcox_inter_wave2_covidadmission_cp.out not found)

. 
. log close
      name:  <unnamed>
       log:  /workspace/logs/AL006_cox_regression_inter_wave2_covidadmission_cp
> .log
  log type:  text
 closed on:  25 Feb 2021, 20:14:05
-------------------------------------------------------------------------------
